/* Ephox PowerPaste plugin
 *
 * Copyright 2010-2015 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.1.0.9
 */
(function(){if(this.ephox)var I=this.ephox.bolt;var A={},C=function(a){if(void 0===A[a])throw"required module ["+a+"] is not defined";if(void 0===A[a].instance){for(var h=A[a].dependencies,l=A[a].definition,p=[],d=0;d<h.length;++d)p.push(C(h[d]));A[a].instance=l.apply(null,p);if(void 0===A[a].instance)throw"required module ["+a+"] could not be defined (definition function returned undefined)";}return A[a].instance},a=this.ephox||{};a.bolt={module:{api:{define:function(a,h,l){if("string"!==typeof a)throw"invalid module definition, module id must be defined and be a string";
if(void 0===h)throw"invalid module definition, dependencies must be specified";if(void 0===l)throw"invalid module definition, definition function must be specified";A[a]={dependencies:h,definition:l,instance:void 0}},require:function(a,h){for(var l=[],p=0;p<a.length;++p)l.push(C(a[p]));h.apply(null,h)},demand:C}}};a.bolt.module.api.define("global!document",[],function(){return document});(function(a,h,l){a("ephox.powerpaste.util.NodeUtil",["global!document"],function(p){return{nodeToString:function(d){var c=
p.createElement("div");c.appendChild(d.cloneNode(!0));return c.innerHTML}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!tinymce",[],function(){return tinymce});(function(a,h,l){a("ephox.powerpaste.i18n.I18n",["global!tinymce"],function(p){var d=function(){return"Your browser security settings may be preventing images from being imported."},c={"cement.dialog.paste.title":"Paste Formatting Options","cement.dialog.paste.instructions":"Choose to keep or remove formatting in the pasted content.",
"cement.dialog.paste.merge":"Keep Formatting","cement.dialog.paste.clean":"Remove Formatting","cement.dialog.flash.title":"Local Image Import","cement.dialog.flash.trigger-paste":"Trigger paste again from the keyboard to paste content with images.","cement.dialog.flash.missing":'Adobe Flash is required to import images from Microsoft Office. Install the <a href="http://get.adobe.com/flashplayer/" target="_blank">Adobe Flash Player</a>.',"cement.dialog.flash.press-escape":'Press <span class="ephox-polish-help-kbd">ESC</span> to ignore local images and continue editing.',
"loading.wait":"Please wait...","flash.clipboard.no.rtf":p.Env.mac&&p.Env.webkit?d()+' <a href="https://support.ephox.com/entries/59328357-Safari-6-1-and-7-Flash-Sandboxing" style="text-decoration: underline">More information on paste for Safari</a>':d(),"safari.imagepaste":'Safari does not support direct paste of images. <a href="https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work" style="text-decoration: underline">More information on image pasting for Safari</a>',
"error.code.images.not.found":"The images service was not found: (","error.imageupload":"Image failed to upload: (","error.full.stop":").","errors.local.images.disallowed":"Local image paste has been disabled. Local images have been removed from pasted content.","flash.crashed":"Images have not been imported as Adobe Flash appears to have crashed. This may be caused by pasting large documents.","errors.imageimport.failed":"Some images failed to import.","errors.imageimport.unsupported":"Unsupported image type.",
"errors.imageimport.invalid":"Image is invalid."};return{translate:function(b){return p.translate(c[b])}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.alien.Once",[],function(){return function(p){var d=!1;return function(){d||(d=!0,p.apply(null,arguments))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!Array",[],function(){return Array});a.bolt.module.api.define("global!String",
[],function(){return String});(function(a,h,l){a("ephox.compass.Arr",["global!Array","global!String"],function(p,d){var c=function(b){return function(e){return b===e}},b=c(!0),e=function(b,e){return t(b,c(e))},f=function(b,e){for(var c=[],d=0;d<b.length;d++)c.push(e(b[d],d,b));return c},a=function(b,e){for(var c=0;c<b.length;c++)e(b[c],c,b)},k=function(b,e){for(var c=[],d=0;d<b.length;d++){var p=b[d];e(p,d,b)&&c.push(p)}return c},m=function(b,e,c){a(b,function(b){c=e(c,b)});return c},n=function(b,
e){if(2!==arguments.length)throw"Expected 2 arguments to find";for(var c=0;c<b.length;c++){var d=b[c];if(e(d,c,b))return d}},q=function(c,e){for(var d=e||b,p=0;p<c.length;++p)if(!0===d(c[p]))return p;return-1},r=function(b){for(var c=[],e=0;e<b.length;++e)c=c.concat(b[e]);return c},s=function(c,e){for(var d=e||b,p=0;p<c.length;++p)if(!0!==d(c[p],p))return!1;return!0},t=function(c,e){for(var d=e||b,p=0;p<c.length;++p)if(!0===d(c[p]))return!0;return!1},u=function(b){b=p.prototype.slice.call(b,0);b.reverse();
return b};return{map:f,each:a,partition:function(b,c){for(var e=[],d=[],p=0;p<b.length;p++){var f=b[p];(c(f,p,b)?e:d).push(f)}return{pass:e,fail:d}},filter:k,groupBy:function(b,c){if(0===b.length)return[];var e=c(b[0]),d=[],p=[];a(b,function(b){var f=c(b);f!==e&&(d.push(p),p=[]);e=f;p.push(b)});0!==p.length&&d.push(p);return d},indexOf:function(b,e){if(2!==arguments.length)throw"Expected 2 arguments to indexOf";return q(b,c(e))},foldr:function(b,c,e){return m(u(b),c,e)},foldl:m,find:n,findIndex:q,
findOr:function(b,c,e){b=n(b,c);return void 0!==b?b:e},findOrDie:function(b,c,e){c=n(b,c);if(void 0===c)throw e||"Could not find element in array: "+d(b);return c},flatten:r,bind:function(b,c){var e=f(b,c);return r(e)},forall:s,exists:t,contains:e,equal:function(b,c){return b.length===c.length&&s(b,function(b,e){return b===c[e]})},reverse:u,chunk:function(b,c){for(var e=[],d=0;d<b.length;d+=c){var p=b.slice(d,d+c);e.push(p)}return e},difference:function(b,c){return k(b,function(b){return!e(c,b)})},
mapToObject:function(b,c){var e={};a(b,function(b,p){e[d(b)]=c(b,p)});return e}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.peanut.Fun",["global!Array"],function(p){return{noop:function(){},compose:function(d,c){return function(){return d(c.apply(null,arguments))}},constant:function(d){return function(){return d}},identity:function(d){return d},tripleEquals:function(d,c){return d===c},curry:function(d){var c=p.prototype.slice,b=c.call(arguments,
1);return function(){var e=b.concat(c.call(arguments,0));return d.apply(null,e)}},not:function(d){return function(){return!d.apply(null,arguments)}},die:function(d){return function(){throw d;}},apply:function(d){return d()},call:function(d){d()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.perhaps.Option",["ephox.peanut.Fun"],function(p){var d=function(c){return b(function(b,d){return d(c)})},c=function(){return b(function(b,c){return b()})},
b=function(b){var f=function(){return b(p.constant(!1),p.constant(!0))},a=p.not(f),k=function(b){return m(function(c){return d(b(c))})},m=function(d){return b(c,d)};return{is:function(c){return b(p.constant(!1),function(b){return b===c})},isSome:f,isNone:a,getOr:function(c){return b(p.constant(c),p.identity)},getOrThunk:function(c){return b(c,p.identity)},getOrDie:function(c){return b(p.die(c||"error: getOrDie called on none."),p.identity)},or:function(c){return b(p.constant(c),d)},orThunk:function(c){return b(c,
d)},fold:b,map:k,each:k,bind:m,ap:function(p){return b(c,function(b){return p.fold(c,function(c){return d(c(b))})})},flatten:function(){return b(c,p.identity)},exists:function(c){return b(p.constant(!1),c)},forall:function(c){return b(p.constant(!0),c)},equals:function(c){return b(c.isNone,c.is)},equals_:function(c,d){return b(c.isNone,function(b){return c.fold(p.constant(!1),p.curry(d,b))})},filter:function(p){return b(c,function(b){return p(b)?d(b):c()})},toArray:function(){return b(p.constant([]),
function(b){return[b]})},toString:function(){return b(p.constant("none()"),function(b){return"some("+b+")"})}}};return{some:d,none:c,from:function(b){return null===b||void 0===b?c():d(b)},equals:function(b,c){return b.equals(c)},equals_:function(b,c,d){return b.equals_(c,d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.imageupload.TinyUploader",["ephox.compass.Arr","ephox.peanut.Fun"],function(p,d){return function(c){return{uploadImages:function(){c.uploadImages()},
prepareImages:function(b){p.each(b,function(b){b.fold(function(b,e,d,a){p.each(c.dom.select('img[src="'+d+'"]'),function(b){c.dom.setAttrib(b,"src",a.result)})},d.noop)})},getLocalURL:function(b,c,d,p){return p.result}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.ErrorDialog",[],function(){return{showDialog:function(p,d){win=p.windowManager.open({title:"Error",spacing:10,padding:10,items:[{type:"container",html:d}],
buttons:[{text:"Ok",onclick:function(){win.close()}}]})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.imageupload.UploadError",["ephox.powerpaste.alien.Once","ephox.powerpaste.i18n.I18n","ephox.powerpaste.tinymce.ErrorDialog"],function(p,d,c){return function(b,e){var a=function(){return d.translate("error.code.images.not.found")+e+d.translate("error.full.stop")},g=function(){return d.translate("error.imageupload")+e+d.translate("error.full.stop")},
k=function(e){e=e.status();c.showDialog(b,(0===e||400<=e||500>e?a:g)())};return{instance:function(){return p(k)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.flour.style.Resolver",["ephox.compass.Arr"],function(p){var d=function(c){return c.replace(/\./g,"-")};return{create:function(c){var b=d(c);return{resolve:function(c){c=c.split(" ");return p.map(c,function(c){return b+"-"+c}).join(" ")}}},cssNamespace:d,cssClass:function(c,b){return c+
"-"+b}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.style.Styles",["ephox.flour.style.Resolver"],function(p){return{resolve:p.create("ephox-salmon").resolve}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.classify.Type",["global!Array","global!String"],function(p,d){var c=function(b){return function(c){if(null===c)c="null";else{var a=typeof c;c="object"===a&&p.prototype.isPrototypeOf(c)?
"array":"object"===a&&d.prototype.isPrototypeOf(c)?"string":a}return c===b}};return{isString:c("string"),isObject:c("object"),isArray:c("array"),isNull:c("null"),isBoolean:c("boolean"),isUndefined:c("undefined"),isFunction:c("function"),isNumber:c("number")}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.compass.Obj",[],function(){var p=function(b,c){for(var d in b)b.hasOwnProperty(d)&&c(b[d],d,b)},d=function(b,c){var d={};p(b,function(p,
a){var n=c(p,a,b);d[n.k]=n.v});return d},c=function(b,c){var d=[];p(b,function(b,e){d.push(c(b,e))});return d},b=function(b){return c(b,function(b,c){return b})};return{bifilter:function(b,c){var d={},a={};p(b,function(b,e){(c(b,e)?d:a)[e]=b});return{t:d,f:a}},each:p,map:function(b,c){return d(b,function(b,d,e){return{k:d,v:c(b,d,e)}})},mapToArray:c,tupleMap:d,find:function(b,c){for(var d in b)if(b.hasOwnProperty(d)){var p=b[d];if(c(p,d,b))return p}},keys:function(b){return c(b,function(b,c){return c})},
values:b,size:function(c){return b(c).length}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bud.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Node",["ephox.bud.NodeTypes"],
function(p){var d=function(b){return b.dom().nodeName.toLowerCase()},c=function(b){return b.dom().nodeType},b=function(b){return function(d){return c(d)===b}},e=b(p.ELEMENT),a=b(p.TEXT),b=b(p.DOCUMENT);return{name:d,type:c,value:function(b){return b.dom().nodeValue},isElement:e,isText:a,isDocument:b,isComment:function(b){return c(b)===p.COMMENT||"#comment"===d(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!Error",[],function(){return Error});
a.bolt.module.api.define("global!console",[],function(){"undefined"===typeof console&&(console={log:function(){}});return console});(function(a,h,l){a("ephox.sugar.api.Attr","ephox.classify.Type ephox.compass.Arr ephox.compass.Obj ephox.sugar.api.Node global!Error global!console".split(" "),function(p,d,c,b,e,a){var g=function(b,c,d){if(p.isString(d)||p.isBoolean(d)||p.isNumber(d))b.setAttribute(c,d+"");else throw a.error("Invalid call to Attr.set. Key ",c,":: Value ",d,":: Element ",b),new e("Attribute value was not simple");
},k=function(b,c,d){g(b.dom(),c,d)},m=function(b,c){var d=b.dom().getAttribute(c);return null===d?void 0:d},n=function(b,c){var d=b.dom();return d&&d.hasAttribute?d.hasAttribute(c):!1};return{clone:function(b){return d.foldl(b.dom().attributes,function(b,c){b[c.name]=c.value;return b},{})},set:k,setAll:function(b,d){var p=b.dom();c.each(d,function(b,c){g(p,c,b)})},get:m,has:n,remove:function(b,c){b.dom().removeAttribute(c)},hasNone:function(b){b=b.dom().attributes;return void 0===b||null===b||0===
b.length},transfer:function(c,p,e){b.isElement(c)&&b.isElement(p)&&d.each(e,function(b){n(c,b)&&!n(p,b)&&k(p,b,m(c,b))})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.Immutable2",["ephox.compass.Arr","ephox.compass.Obj","ephox.peanut.Fun"],function(p,d,c){return{product:function(b,e){return{nu:function(){var d=Array.prototype.slice.call(arguments);if(b.length!==d.length)throw'Wrong number of arguments to struct. Expected "['+
b.length+']", got '+d.length+" arguments";var e={};p.each(b,function(b,p){e[b]=c.constant(d[p])});return e},eq:function(d,p){for(var a=0;a<b.length;a++){var m=b[a];if(!(e&&e[a]||c.tripleEquals)(d[m](),p[m]()))return!1}return!0},evaluate:function(b){return d.map(b,function(b){return b()})}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.Immutable",["ephox.scullion.Immutable2"],function(p){return function(){return p.product(arguments).nu}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.BagUtils",["ephox.classify.Type","ephox.compass.Arr"],function(p,d){var c=function(b){return b.slice(0).sort()};return{sort:c,reqMessage:function(b,d){throw"All required keys ("+c(b).join(", ")+") were not specified. Specified keys were: "+c(d).join(", ")+".";},unsuppMessage:function(b){throw"Unsupported keys for object: "+c(b).join(", ");},validateStrArr:function(b,c){if(!p.isArray(c))throw"The "+b+" fields must be an array. Was: "+
c+".";d.each(c,function(c){if(!p.isString(c))throw"The value "+c+" in the "+b+" fields was not a string.";})},invalidTypeMessage:function(b,d){throw"All values need to be of type: "+d+". Keys ("+c(b).join(", ")+") were not.";},checkDupes:function(b){var p=c(b);b=d.find(p,function(b,c){return c<p.length-1&&b===p[c+1]});if(void 0!==b&&null!==b)throw"The field: "+b+" occurs more than once in the combined fields: ["+p.join(", ")+"].";}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
a.bolt.module.api.define("global!Object",[],function(){return Object});(function(a,h,l){a("ephox.scullion.MixedBag","ephox.compass.Arr ephox.compass.Obj ephox.peanut.Fun ephox.perhaps.Option ephox.scullion.BagUtils global!Object".split(" "),function(p,d,c,b,a,f){return function(g,k){var m=g.concat(k);if(0===m.length)throw"You must specify at least one required or optional field.";a.validateStrArr("required",g);a.validateStrArr("optional",k);a.checkDupes(m);return function(n){var q=d.keys(n);p.forall(g,
function(b){return p.contains(q,b)})||a.reqMessage(g,q);var r=p.filter(q,function(b){return!p.contains(m,b)});0<r.length&&a.unsuppMessage(r);var s={};p.each(g,function(b){s[b]=c.constant(n[b])});p.each(k,function(d){s[d]=c.constant(f.prototype.hasOwnProperty.call(n,d)?b.some(n[d]):b.none())});return s}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.Struct",["ephox.scullion.Immutable","ephox.scullion.Immutable2","ephox.scullion.MixedBag"],
function(p,d,c){return{immutable:p,immutable2:d,immutableBag:c}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.alien.Recurse",[],function(){return{toArray:function(p,d){var c=[],b=function(b){c.push(b);return d(b)},a=d(p);do a=a.bind(b);while(a.isSome());return c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Element",["ephox.peanut.Fun","global!Error","global!console",
"global!document"],function(p,d,c,b){var a=function(b){if(null===b||void 0===b)throw new d("Node cannot be not null or undefined");return{dom:p.constant(b)}};return{fromHtml:function(d,p){var k=(p||b).createElement("div");k.innerHTML=d;if(!k.hasChildNodes()||1<k.childNodes.length)throw c.error("HTML does not have a single root node",d),"HTML must have a single root node";return a(k.childNodes[0])},fromTag:function(c,d){var p=(d||b).createElement(c);return a(p)},fromText:function(c,d){var p=(d||b).createTextNode(c);
return a(p)},fromDom:a}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Selectors","ephox.bud.NodeTypes ephox.compass.Arr ephox.perhaps.Option ephox.sugar.api.Element global!Error global!document".split(" "),function(p,d,c,b,a,f){var g=function(){var b=f.createElement("span");return void 0!==b.matches?0:void 0!==b.msMatchesSelector?1:void 0!==b.webkitMatchesSelector?2:void 0!==b.mozMatchesSelector?3:-1}(),k=p.ELEMENT,m=p.DOCUMENT;
return{all:function(c,p){var a=void 0===p?f:p.dom();return a.nodeType!==k&&a.nodeType!==m||0===a.childElementCount?[]:d.map(a.querySelectorAll(c),b.fromDom)},is:function(b,c){var d=b.dom();if(d.nodeType!==k)return!1;if(0===g)return d.matches(c);if(1===g)return d.msMatchesSelector(c);if(2===g)return d.webkitMatchesSelector(c);if(3===g)return d.mozMatchesSelector(c);throw new a("Browser lacks native selectors");},one:function(d,p){var a=void 0===p?f:p.dom();return a.nodeType!==k&&a.nodeType!==m||0===
a.childElementCount?c.none():c.from(a.querySelector(d)).map(b.fromDom)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Compare",["ephox.compass.Arr","ephox.peanut.Fun","ephox.sugar.api.Selectors"],function(a,d,c){var b=function(b,c){return b.dom()===c.dom()};return{eq:b,member:function(c,f){return a.exists(f,d.curry(b,c))},is:c.is}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Traverse",
"ephox.classify.Type ephox.compass.Arr ephox.peanut.Fun ephox.perhaps.Option ephox.scullion.Struct ephox.sugar.alien.Recurse ephox.sugar.api.Compare ephox.sugar.api.Element".split(" "),function(a,d,c,b,e,f,g,k){var m=function(b){return k.fromDom(b.dom().ownerDocument)},n=function(c){c=c.dom();return b.from(c.parentNode).map(k.fromDom)},q=function(b,c){return n(b).fold(function(){return[]},function(b){var d=[b];return c(b)?d:d.concat(q(b,c))})},r=function(c){c=c.dom();return b.from(c.previousSibling).map(k.fromDom)},
s=function(c){c=c.dom();return b.from(c.nextSibling).map(k.fromDom)},t=function(b){b=b.dom();return d.map(b.childNodes,k.fromDom)},u=function(c,d){var a=c.dom().childNodes;return b.from(a[d]).map(k.fromDom)},v=e.immutable("element","offset");return{owner:m,defaultView:function(b){b=b.dom().ownerDocument.defaultView;return k.fromDom(b)},documentElement:function(b){b=m(b);return k.fromDom(b.dom().documentElement)},parent:n,findIndex:function(c){return n(c).bind(function(a){a=t(a);a=d.findIndex(a,function(b){return g.eq(c,
b)});return-1<a?b.some(a):b.none()})},parents:function(b,d){var e=a.isFunction(d)?d:c.constant(!1);return q(b,e)},siblings:function(b){return n(b).map(t).map(function(c){return d.filter(c,function(c){return!g.eq(b,c)})}).getOr([])},prevSibling:r,offsetParent:function(c){c=c.dom();return b.from(c.offsetParent).map(k.fromDom)},prevSiblings:function(b){return d.reverse(f.toArray(b,r))},nextSibling:s,nextSiblings:function(b){return f.toArray(b,s)},children:t,child:u,firstChild:function(b){return u(b,
0)},lastChild:function(b){return u(b,b.dom().childNodes.length-1)},leaf:function(b,c){var d=t(b);return 0<d.length&&c<d.length?v(d[c],0):v(b,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Insert",["ephox.sugar.api.Traverse"],function(a){var d=function(b,c){a.parent(b).each(function(d){d.dom().insertBefore(c.dom(),b.dom())})},c=function(b,c){b.dom().appendChild(c.dom())};return{before:d,after:function(b,e){a.nextSibling(b).fold(function(){a.parent(b).each(function(b){c(b,
e)})},function(b){d(b,e)})},prepend:function(b,d){a.firstChild(b).fold(function(){c(b,d)},function(c){b.dom().insertBefore(d.dom(),c.dom())})},append:c,appendAt:function(b,e,f){a.child(b,f).fold(function(){c(b,e)},function(b){d(b,e)})},wrap:function(b,a){d(b,a);c(a,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.InsertAll",["ephox.compass.Arr","ephox.sugar.api.Insert"],function(a,d){return{before:function(c,b){a.each(b,function(b){d.before(c,
b)})},after:function(c,b){a.each(b,function(a,p){d.after(0===p?c:b[p-1],a)})},prepend:function(c,b){a.each(b.slice().reverse(),function(b){d.prepend(c,b)})},append:function(c,b){a.each(b,function(b){d.append(c,b)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Remove",["ephox.sugar.api.InsertAll","ephox.sugar.api.Traverse"],function(a,d){var c=function(b){b=b.dom();null!==b.parentNode&&b.parentNode.removeChild(b)};return{empty:function(b){b.dom().textContent=
""},remove:c,unwrap:function(b){var e=d.children(b);0<e.length&&a.before(b,e);c(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.peanut.Thunk",[],function(){return{cached:function(a){var d=!1,c;return function(){d||(d=!0,c=a.apply(null,arguments));return c}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Body",["ephox.peanut.Thunk","ephox.sugar.api.Element","ephox.sugar.api.Node",
"global!document"],function(a,d,c,b){return{body:a.cached(function(){var c=b.body;if(null===c||void 0===c)throw"Body is not available yet";return d.fromDom(c)}),inBody:function(b){b=c.isText(b)?b.dom().parentNode:b.dom();return void 0!==b&&null!==b&&b.ownerDocument.body.contains(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.PredicateFilter",["ephox.compass.Arr","ephox.sugar.api.Body","ephox.sugar.api.Traverse"],function(a,
d,c){var b=function(d,f){var g=[];a.each(c.children(d),function(c){f(c)&&(g=g.concat([c]));g=g.concat(b(c,f))});return g};return{all:function(c){return b(d.body(),c)},ancestors:function(b,d,g){return a.filter(c.parents(b,g),d)},siblings:function(b,d){return a.filter(c.siblings(b),d)},children:function(b,d){return a.filter(c.children(b),d)},descendants:b}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.SelectorFilter",["ephox.sugar.api.PredicateFilter",
"ephox.sugar.api.Selectors"],function(a,d){return{all:function(c){return d.all(c)},ancestors:function(c,b,e){return a.ancestors(c,function(c){return d.is(c,b)},e)},siblings:function(c,b){return a.siblings(c,function(c){return d.is(c,b)})},children:function(c,b){return a.children(c,function(c){return d.is(c,b)})},descendants:function(c,b){return d.all(b,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.impl.ClosestOrAncestor",["ephox.classify.Type",
"ephox.perhaps.Option"],function(a,d){return function(c,b,e,f,g){return c(e,f)?d.some(e):a.isFunction(g)&&g(e)?d.none():b(e,f,g)}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.SelectorFind",["ephox.perhaps.Option","ephox.sugar.api.SelectorFilter","ephox.sugar.api.Selectors","ephox.sugar.impl.ClosestOrAncestor"],function(a,d,c,b){var e=function(b,c,e){return a.from(d.ancestors(b,c,e)[0])};return{first:function(b){return a.from(d.all(b)[0])},
ancestor:e,sibling:function(b,c){return a.from(d.siblings(b,c)[0])},child:function(b,c){return a.from(d.children(b,c)[0])},descendant:function(b,c){return a.from(d.descendants(b,c)[0])},closest:function(d,a,p){return b(c.is,e,d,a,p)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.api.Ephemera",["ephox.peanut.Fun","ephox.salmon.style.Styles","ephox.sugar.api.Attr","ephox.sugar.api.Remove","ephox.sugar.api.SelectorFind"],function(a,
d,c,b,e){var f=d.resolve("upload-image-container");d="data-"+d.resolve("image-blob");var g=function(b){c.remove(b,"class")};return{uploadContainer:a.constant(f),blobId:a.constant(d),cleanup:function(c){e.child(c,"img").each(g);b.unwrap(c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Elements",["ephox.compass.Arr","ephox.sugar.api.Element","ephox.sugar.api.Traverse","global!document"],function(a,d,c,b){return{fromHtml:function(a,
p){var g=(p||b).createElement("div");g.innerHTML=a;return c.children(d.fromDom(g))},fromTags:function(b,c){return a.map(b,function(b){return d.fromTag(b,c)})},fromText:function(b,c){return a.map(b,function(b){return d.fromText(b,c)})},fromDom:function(b){return a.map(b,d.fromDom)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.UndoRewriter","ephox.compass.Arr ephox.salmon.api.Ephemera ephox.sugar.api.Element ephox.sugar.api.Elements ephox.sugar.api.InsertAll ephox.sugar.api.SelectorFilter".split(" "),
function(a,d,c,b,e,f){return{unwrapHistory:function(g){for(var k=0;k<g.undoManager.data.length;k++){var m=g.undoManager.data[k].content,n=c.fromTag("div");e.append(n,b.fromHtml(m));m=f.descendants(n,"."+d.uploadContainer());a.each(m,d.cleanup);g.undoManager.data[k].content=n.dom().innerHTML}},resrcHistory:function(b,c,a){for(var d=0;d<b.undoManager.data.length;d++)b.undoManager.data[d].content=b.undoManager.data[d].content.split(c.objurl()).join(a.location)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.epithet.Global",[],function(){return Function("return this;")()})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.epithet.Resolve",["ephox.epithet.Global"],function(a){var d=function(c,b){for(var d=b||a,f=0;f<c.length&&void 0!==d&&null!==d;++f)d=d[c[f]];return d};return{path:d,resolve:function(c,b){var a=c.split(".");return d(a,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.numerosity.core.Global",["ephox.epithet.Resolve"],function(a){return{getOrDie:function(d,c){var b=a.resolve(d,c);if(void 0===b)throw d+" not available on this browser";return b}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.URL",["ephox.numerosity.core.Global"],function(a){return{createObjectURL:function(d){return a.getOrDie("URL").createObjectURL(d)},revokeObjectURL:function(d){a.getOrDie("URL").revokeObjectURL(d)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.api.BlobCache",["ephox.compass.Obj","ephox.numerosity.api.URL","ephox.perhaps.Option","ephox.scullion.Struct"],function(a,d,c,b){var e=b.immutable("id","blob","objurl","data");return function(){var b={},g=function(b){d.revokeObjectURL(b.objurl())};return{add:function(c,a,d,p){a=e(c,a,d,p);return b[c]=a},get:function(a){return c.from(b[a])},remove:function(c){var a=b[c];delete b[c];void 0!==a&&g(a)},lookupByData:function(d){return c.from(a.find(b,
function(b){return b.data().result===d}))},destroy:function(){a.each(b,g);b={}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.porkbun.Event",["ephox.compass.Arr","ephox.scullion.Struct"],function(a,d){return function(c){var b=d.immutable.apply(null,c),e=[];return{bind:function(b){if(void 0===b)throw"Event bind error: undefined handler";e.push(b)},unbind:function(b){b=a.indexOf(e,b);-1!==b&&e.splice(b,1)},trigger:function(){var c=b.apply(null,
arguments);a.each(e,function(b){b(c)})}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.porkbun.Events",["ephox.compass.Obj"],function(a){return{create:function(d){var c=a.map(d,function(b){return{bind:b.bind,unbind:b.unbind}});d=a.map(d,function(b){return b.trigger});return{registry:c,trigger:d}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.api.ImageTracker","ephox.compass.Arr ephox.salmon.style.Styles ephox.salmon.api.Ephemera ephox.porkbun.Event ephox.porkbun.Events ephox.sugar.api.Attr ephox.sugar.api.SelectorFilter".split(" "),
function(a,d,c,b,e,f,g){var k="data-"+d.resolve("image-upload"),m=function(b,c){return g.descendants(b,"img["+k+'="'+c+'"]')},n=function(b){return g.descendants(b,"img:not(["+k+"])["+c.blobId()+"]")};return function(){var c=[],d=[],g=e.create({complete:b(["response"])}),s=function(b){c=a.filter(c,function(c,a){return c!==b});!1===u()&&(g.trigger.complete(d),d=[])},u=function(){return 0<c.length};return{findById:m,findAll:n,register:function(b,a){f.set(b,k,a);c.push(a)},report:function(b,c,e){a.each(c,
function(b){f.remove(b,k);d.push({success:e,element:b.dom()})});s(b)},inProgress:u,isActive:function(b){return a.contains(c,b)},events:g.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.highway.Merger",["ephox.classify.Type"],function(a){var d=function(b){return function(){var c=Array.prototype.slice.call(arguments,0);if(0===c.length)throw"Can't merge zero objects";for(var a={},d=0;d<c.length;d++){var p=c[d],m;for(m in p)Object.prototype.hasOwnProperty.call(p,
m)&&(a[m]=b(a[m],p[m]))}return a}},c=d(function(b,d){return a.isObject(b)&&a.isObject(d)?c(b,d):d}),d=d(function(b,c){return c});return{deepMerge:c,merge:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.ADT",["ephox.classify.Type","ephox.compass.Arr","ephox.compass.Obj","ephox.peanut.Fun","global!Array"],function(a,d,c,b,e){return{generate:function(b){if(!a.isArray(b))throw"cases must be an array";if(0===b.length)throw"there must be at least one case";
var g={};d.each(b,function(d,m){var n=c.keys(d);if(1!==n.length)throw"one and only one name per case";var q=n[0],r=d[q];if(void 0!==g[q])throw"duplicate key detected:"+q;if("cata"===q)throw"cannot have a case named cata (sorry)";if(!a.isArray(r))throw"case arguments must be an array";g[q]=function(){var c=e.prototype.slice.call(arguments);if(c.length!==r.length)throw"Wrong number of arguments to case "+q+". Expected "+r.length+" ("+r+"), got "+c.length;return{fold:function(){if(arguments.length!==
b.length)throw"Wrong number of arguments to fold. Expected "+b.length+", got "+arguments.length;return arguments[m].apply(null,c)}}}});return g}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.hermes.api.ImageAsset",["ephox.highway.Merger","ephox.scullion.ADT"],function(a,d){var c=d.generate([{blob:["id","blob","objurl","data"]},{url:["id","url","raw"]}]);return a.merge(c,{cata:function(b,c,a){return b.fold(c,a)}})})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.perhaps.Result",["ephox.peanut.Fun","ephox.perhaps.Option"],function(a,d){var c=function(b){return e(function(c,a){return a(b)})},b=function(b){return e(function(c,a){return c(b)})},e=function(e){var g=function(){return e(a.constant(!1),a.constant(!0))},k=a.not(g),m=function(b){return n(function(a){return c(b(a))})},n=function(c){return e(b,c)};return{is:function(b){return e(a.constant(!1),function(c){return c===b})},isValue:g,
isError:k,getOr:function(b){return e(a.constant(b),a.identity)},getOrThunk:function(b){return e(b,a.identity)},getOrDie:function(){return e(function(b){a.die(b)()},a.identity)},or:function(b){return e(a.constant(b),c)},orThunk:function(b){return e(b,c)},fold:e,map:m,each:m,bind:n,exists:function(b){return e(a.constant(!1),b)},forall:function(b){return e(a.constant(!0),b)},toOption:function(){return e(d.none,d.some)}}};return{value:c,error:b}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.alien.Toggler",[],function(){return function(a,d,c){var b=c||!1,e=function(){d();b=!0},f=function(){a();b=!1};return{on:e,off:f,toggle:function(){(b?f:e)()},isOn:function(){return b}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Class",["ephox.sugar.alien.Toggler","ephox.sugar.api.Attr"],function(a,d){var c=function(b,c){var a=b.dom().classList;return void 0!==a&&a.contains(c)};
return{add:function(b,c){b.dom().classList.add(c)},remove:function(b,c){var a=b.dom().classList;a.remove(c);0===a.length&&d.remove(b,"class")},toggle:function(b,c){return b.dom().classList.toggle(c)},toggler:function(b,d){var f=b.dom().classList;return a(function(){f.remove(d)},function(){f.add(d)},c(b,d))},has:c}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.ui.UploadUi","ephox.salmon.api.Ephemera ephox.sugar.api.Class ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Remove ephox.sugar.api.SelectorFind ephox.sugar.api.Traverse".split(" "),
function(a,d,c,b,e,f,g,k){return{removeUi:function(b){g.ancestor(b,"."+a.uploadContainer()).each(function(b){var c=k.children(b);e.before(b,c);f.remove(b)})},addUi:function(e){var f=c.fromTag("div");d.add(f,a.uploadContainer());b.before(e,f);b.append(f,e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.api.UploadUtils","ephox.compass.Arr ephox.hermes.api.ImageAsset ephox.peanut.Fun ephox.perhaps.Option ephox.perhaps.Result ephox.salmon.api.Ephemera ephox.salmon.ui.UploadUi ephox.scullion.ADT ephox.scullion.Struct ephox.sugar.api.Attr ephox.sugar.api.SelectorFind global!console".split(" "),
function(a,d,c,b,e,f,g,k,m,n,q,r){var s=m.immutable("image","blobInfo"),t=k.generate([{failure:["error"]},{success:["result","images","blob"]}]),u=function(b,c,d,e){a.each(c,function(b){n.set(b,"src",e.location);n.remove(b,f.blobId())});return l(b,d,c)},v=function(b,c,a,d,p,k){var g=b.lookupByData(p.result).getOrThunk(function(){return b.add(c,a,d,p)});n.set(k,f.blobId(),g.id());return e.value(s(k,g))},h=function(b,c){var a=n.get(c,f.blobId());return b.get(a).fold(function(){return e.error(a)},function(b){return e.value(s(c,
b))})},l=function(b,c,a){return b.get(c).fold(function(){return e.error("Internal error with blob cache")},function(a){b.remove(c);return e.value(a)})};return{prepareForUpload:function(c,a,d){var p=c.isActive(a);c.register(d,a);g.addUi(d);return p?b.none():b.some(a)},handleUpload:function(b,d,e,f,k,m,n){var q=function(){r.error("Internal error with blob cache",k);n(t.failure({status:c.constant(666)}))};b.upload(m,k,function(b){var c=d.findById(f,k);a.each(c,g.removeUi);b.fold(function(b){n(t.failure(b))},
function(b){u(e,c,k,b).fold(q,function(a){n(t.success(b,c,a))})});d.report(k,c,b.isValue())})},registerAssets:function(b,f,k){return a.bind(k,function(a){return d.cata(a,function(c,a,d,p){return q.descendant(f,'img[src="'+d+'"]').fold(function(){return[e.error("Image that was just inserted could not be found: "+d)]},function(e){return[v(b,c,a,d,p,e)]})},c.constant([]))})},findBlobs:function(b,c,d){d=b.findAll(d);return b.inProgress()?[]:a.map(d,function(b){return h(c,b)})}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.FormData",["ephox.numerosity.core.Global"],function(a){return function(){return new (a.getOrDie("FormData"))}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!Math",[],function(){return Math});a.bolt.module.api.define("global!isFinite",[],function(){return isFinite});a.bolt.module.api.define("global!isNaN",[],function(){return isNaN});a.bolt.module.api.define("global!parseFloat",
[],function(){return parseFloat});(function(a,h,l){a("ephox.violin.util.Validate",["global!Math","global!isFinite","global!isNaN","global!parseFloat"],function(a,d,c,b){var e=function(b){return function(c,a){var d=typeof a;if(d!==b)throw c+" was not a "+b+". Was: "+a+" ("+d+")";}},f=e("string"),g=e("number"),k=function(b,c){g(b,c);if(c!==a.abs(c))throw b+" was not an integer. Was: "+c;};return{vString:f,vChar:function(b,c){f(b,c);if(1!==c.length)throw b+" was not a single char. Was: "+c;},vInt:k,
vNat:function(b,c){k(b,c);if(0>c)throw b+" was not a natural number. Was: "+c;},pNum:function(a){return!c(b(a))&&d(a)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.violin.Strings",["ephox.violin.util.Validate"],function(a){var d=function(b,c,a){return""===c?!0:b.length<c.length?!1:b.substr(a,a+c.length)===c},c=function(b){var c=function(b,c){for(var a=[],d=0;d<b.length;d++)a.push(c(b[d]));return a};return function(){var a=c(arguments,
function(b){return"string"===typeof b?b.toLowerCase():b});return b.apply(this,a)}},b=function(b,c){return d(b,c,0)},e=c(b),f=function(b,c){return d(b,c,b.length-c.length)},g=c(f),k=function(b,c){return b.substr(0,c)},m=function(b,c){return b.substr(b.length-c,b.length)},n=function(b,c){return function(a,d){return b(a,d)?c(a,a.length-d.length):a}},q=n(b,m),n=n(f,k),r=function(b,c){return function(a,d){return b(a,d)?a:c(a,d)}},s=r(b,function(b,c){return c+b}),r=r(f,function(b,c){return b+c}),t=function(b,
c){return-1!=b.indexOf(c)},u=c(t),v=function(b,c){return b===c},c=c(v),h=function(b){if(""===b)throw"head on empty string";return b.substr(0,1)},l=function(b){if(""===b)throw"tail on empty string";return b.substr(1,b.length-1)},x=function(b,c){a.vString("str",b);a.vNat("num",c);for(var d="",e=0;e<c;e++)d+=b;return d},z=function(b){return function(c,d,e){a.vString("str",c);a.vChar("c",d);a.vNat("width",e);var f=c.length;return f>=e?c:b(c,x(d,e-f))}},B=z(function(b,c){return c+b}),z=z(function(b,c){return b+
c});return{supplant:function(b,c){return b.replace(/\${([^{}]*)}/g,function(b,a){var d=c[a],p=typeof d;return"string"===p||"number"===p?d:b})},startsWith:b,startsWithIgnoringCase:e,endsWith:f,endsWithIgnoringCase:g,first:k,last:m,removeLeading:q,removeTrailing:n,ensureLeading:s,ensureTrailing:r,trim:function(b){return b.replace(/^\s+|\s+$/g,"")},lTrim:function(b){return b.replace(/^\s+/g,"")},rTrim:function(b){return b.replace(/\s+$/g,"")},contains:t,containsIgnoringCase:u,htmlEncodeDoubleQuotes:function(b){return b.replace(/\"/gm,
"&quot;")},equals:v,equalsIgnoringCase:c,head:h,repead:x,padLeft:B,padRight:z,toe:function(b){if(""===b)throw"toe on empty string";return b.substr(b.length-1,b.length)},tail:l,torso:function(b){if(""===b)throw"torso on empty string";return b.substr(0,b.length-1)},capitalize:function(b){return""===b?b:h(b).toUpperCase()+l(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.services.UploadCommon",["ephox.classify.Type","ephox.compass.Arr",
"ephox.numerosity.api.FormData","ephox.scullion.Struct","ephox.violin.Strings"],function(a,d,c,b,e){var f=["jpg","png","gif","jpeg"];return{failureObject:b.immutable("message","status","contents"),getFilename:function(b,c){var m;a.isString(b.name)&&!e.endsWith(b.name,".tmp")?m=b.name:a.isString(b.type)&&e.startsWith(b.type,"image/")?(m=b.type.substr(6),m=d.contains(f,m)?c+"."+m:c):m=c;return m},buildExtra:function(b,a,d){var p=c();p.append(b,a,d);return{data:p,contentType:!1,processData:!1}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.XMLHttpRequest",["ephox.numerosity.core.Global"],function(a){return function(){return new (a.getOrDie("XMLHttpRequest"))}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.jax.base.Ajax","ephox.classify.Type ephox.compass.Obj ephox.highway.Merger ephox.numerosity.api.XMLHttpRequest ephox.perhaps.Result ephox.violin.Strings global!console".split(" "),
function(a,d,c,b,e,f,g){var k={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};return{ajax:function(m,n,q,r){var s=c.merge({url:m,contentType:"application/json",processData:!1,type:"GET"},r),t=b();t.open(s.type.toUpperCase(),s.url,!0);a.isString(s.contentType)&&t.setRequestHeader("Content-Type",s.contentType);r=s.dataType;r=a.isString(r)&&"*"!==r?k[r]+", "+k["*"]+"; q=0.01":k["*"];t.setRequestHeader("Accept",r);void 0!==s.xhrFields&&
!0===s.xhrFields.withCredentials&&(t.withCredentials=!0);a.isObject(s.headers)&&d.each(s.headers,function(b,c){a.isString(c)||a.isString(b)?t.setRequestHeader(c,b):g.error("Request header data was not a string: ",c," -> ",b)});var u=function(b){q('Could not load url "'+m+'": '+b.status+" "+b.statusText,b.status,b.responseText)},v=function(b){try{return e.value(JSON.parse(b.response))}catch(c){return e.error({status:b.status,statusText:"Response was not JSON",responseText:b.responseText})}},h=function(b){("json"===
s.dataType?v(b):e.value(b.response)).fold(u,function(b){n(b)})};t.onerror=u;t.onload=function(){0===t.status?f.startsWith(s.url,"file:")?h(t):q("Unknown HTTP error (possible cross-domain request)",t.status,t.responseText):100>t.status||400<=t.status?u(t):h(t)};void 0===s.data?t.send():t.send(s.data)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.JSON",["ephox.numerosity.core.Global"],function(a){return{parse:function(d){return a.getOrDie("JSON").parse(d)},
stringify:function(d){return a.getOrDie("JSON").stringify(d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.jax.plain.Ajax",["ephox.highway.Merger","ephox.jax.base.Ajax","ephox.numerosity.api.JSON"],function(a,d,c){return{get:function(b,c,f,g){d.ajax(b,c,f,a.merge({dataType:"text",type:"GET"},g))},post:function(b,e,f,g,k){d.ajax(b,f,g,a.merge({dataType:"text",data:c.stringify(e),type:"POST"},k))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.yuri.resolve.Recompose",[],function(){return{recompose:function(a){var d="";""!==a.protocol&&(d+=a.protocol,d+=":");""!==a.authority&&(d=d+"//"+a.authority);d+=a.path;""!==a.query&&(d+="?",d+=a.query);""!==a.anchor&&(d+="#",d+=a.anchor);return d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.yuri.api.Parser",["ephox.highway.Merger"],function(a){var d={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},c=function(b,c){for(var a=c.parser[c.strictMode?"strict":"loose"].exec(b),d={},p=14;p--;)d[c.key[p]]=
a[p]||"";d[c.q.name]={};d[c.key[12]].replace(c.q.parser,function(b,a,p){a&&(d[c.q.name][a]=p)});return d};return{parse:function(b,e){var f=a.merge(d,e);return c(b,f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.yuri.normalize.Dots",["ephox.violin.Strings"],function(a){return{remove:function(d){for(var c="";""!==d;)if(a.startsWith(d,"../"))d=a.removeLeading(d,"../");else if(a.startsWith(d,"./"))d=a.removeLeading(d,"./");else if(a.startsWith(d,
"/./"))d="/"+a.removeLeading(d,"/./");else if("/."===d)d="/";else if(a.startsWith(d,"/../"))d="/"+a.removeLeading(d,"/../"),c=a.removeTrailing(c,c.substring(c.lastIndexOf("/")));else if("/.."===d)d="/",c=a.removeTrailing(c,c.substring(c.lastIndexOf("/")));else if("."===d||".."===d)d="";else{var b=d.match(/(^\/?.*?)(\/|$)/)[1];d=a.removeLeading(d,b);c+=b}return c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.yuri.resolve.Merge",["ephox.violin.Strings"],
function(a){return{merge:function(d,c,b){if(""!==b&&""===d)return"/"+c;b=d.substring(d.lastIndexOf("/")+1);return a.removeTrailing(d,b)+c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.yuri.resolve.Transform",["ephox.violin.Strings","ephox.yuri.api.Parser","ephox.yuri.normalize.Dots","ephox.yuri.resolve.Merge"],function(a,d,c,b){return{transform:function(e,f){var g={strictMode:!0},k=d.parse(e,g),g=d.parse(f,g),m={};""!==g.protocol?(m.protocol=
g.protocol,m.authority=g.authority,m.path=c.remove(g.path),m.query=g.query):(""!==g.authority?(m.authority=g.authority,m.path=c.remove(g.path),m.query=g.query):(""===g.path?(m.path=k.path,m.query=""!==g.query?g.query:k.query):(a.startsWith(g.path,"/")?m.path=c.remove(g.path):(m.path=b.merge(k.path,g.path,e.authority),m.path=c.remove(m.path)),m.query=g.query),m.authority=k.authority),m.protocol=k.protocol);m.anchor=g.anchor;return m}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.yuri.api.Resolver",["ephox.yuri.resolve.Recompose","ephox.yuri.resolve.Transform"],function(a,d){return{resolve:function(c,b){var e=d.transform(c,b);return a.recompose(e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.services.UploadDirect","ephox.classify.Type ephox.highway.Merger ephox.jax.plain.Ajax ephox.numerosity.api.JSON ephox.perhaps.Result ephox.salmon.services.UploadCommon ephox.violin.Strings ephox.yuri.api.Resolver".split(" "),
function(a,d,c,b,e,f,g,k){return function(m){var n=function(){var b=m.url,c=b.lastIndexOf("/"),b=0<c?b.substr(0,c):b,b=void 0===m.basePath?b:m.basePath;return g.endsWith(b,"/")?b:b+"/"}();return{upload:function(g,r,s){g=g.blob();var t=function(b,c,a){s(e.error(f.failureObject(b,c,a)))},u=f.getFilename(g,r);r=d.merge(!0!==m.credentials?{}:{xhrFields:{withCredentials:!0}},f.buildExtra("image",g,u));c.post(m.url,{},function(c){var d;try{var f=b.parse(c);if(a.isString(f.location))d=f.location;else{t("JSON response did not contain a string location",
500,c);return}}catch(g){d=c}c=d.split(/\s+/);c=k.resolve(n,1===c.length&&""!==c[0]?c[0]:u);s(e.value({location:c}))},t,r)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!setTimeout",[],function(){return setTimeout});(function(a,h,l){a("ephox.salmon.services.UploadFunction","ephox.classify.Type ephox.perhaps.Result ephox.salmon.services.UploadCommon ephox.scullion.Struct global!console global!setTimeout".split(" "),function(a,d,c,
b,e,f){var g=b.immutable("id","filename","blob","base64");return function(b){return{upload:function(m,n,q){var r=function(b){q(d.error(b))},s=function(b){a.isString(b)?q(d.value({location:b})):(e.error("Image upload result was not a string"),r(""))},t=c.getFilename(m.blob(),n),u=g(n,t,m.blob(),m.data().result);f(function(){b(u,s,r)},0)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.salmon.api.Uploaders",["ephox.salmon.services.UploadCommon",
"ephox.salmon.services.UploadDirect","ephox.salmon.services.UploadFunction"],function(a,d,c){return{direct:function(b){return d(b)},custom:function(b){return c(b)},failureObject:function(b,c,d){return a.failureObject(b,c,d)},getFilename:function(b,c){return a.getFilename(b,c)},buildExtra:function(b,c,d){return a.buildExtra(b,c,d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.imageupload.EphoxUploader","ephox.compass.Arr ephox.peanut.Fun ephox.perhaps.Option ephox.powerpaste.imageupload.TinyUploader ephox.powerpaste.imageupload.UploadError ephox.powerpaste.tinymce.UndoRewriter ephox.salmon.api.BlobCache ephox.salmon.api.ImageTracker ephox.salmon.api.UploadUtils ephox.salmon.api.Uploaders ephox.sugar.api.Attr ephox.sugar.api.Element".split(" "),
function(a,d,c,b,e,f,g,k,m,n,q,r){var s=function(b,s){var G=g(),h=k();e();var l=e(b,s.url),x=n.direct(s),z=function(c,d,e){a.each(d,function(b){q.set(b,"data-mce-src",c.location)});f.resrcHistory(b,e,c)};h.events.complete.bind(function(c){f.unwrapHistory(b)});var B=function(c,a,d){m.handleUpload(x,h,G,r.fromDom(b.getBody()),c,a,function(b){b.fold(function(b){d(b)},z)})},E=function(b,c){m.prepareForUpload(h,b.blobInfo().id(),b.image()).each(function(a){B(a,b.blobInfo(),c)})},H=function(c){var d=l.instance();
c=m.registerAssets(G,r.fromDom(b.getBody()),c);a.each(c,function(b){b.fold(function(b){console.error(b)},function(b){E(b,d)})})},D=function(){var d=l.instance(),e=m.findBlobs(h,G,r.fromDom(b.getBody()));a.each(e,function(b){b.fold(function(b){h.report(b,c.none(),!1)},function(b){E(b,d)})})};return{uploadImages:function(b){D();H(b)},prepareImages:d.noop,getLocalURL:function(b,c,a,d){return a}}};return function(c,a){var e;a?e=s(c,a):(e=b(c),e={uploadImages:d.noop,prepareImages:e.prepareImages,getLocalURL:e.getLocalURL});
return e}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.imageupload.UploaderFactory",["ephox.powerpaste.imageupload.EphoxUploader","ephox.powerpaste.imageupload.TinyUploader"],function(a,d){return function(c){var b=!c.uploadImages&&c.settings.images_upload_url?{url:c.settings.images_upload_url,basePath:c.settings.images_upload_base_path,credentials:c.settings.images_upload_credentials}:null;return c.uploadImages?d(c):a(c,b)}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.tinymce.Util",[],function(){return{each:tinymce.each,trim:tinymce.trim,bind:function(a,d){return function(){return a.apply(d,arguments)}},extend:function(a){tinymce.each(Array.prototype.slice.call(arguments,1),function(d){for(var c in d)a[c]=d[c]});return a},ephoxGetComputedStyle:function(a){return a.ownerDocument.defaultView?a.ownerDocument.defaultView.getComputedStyle(a,null):a.currentStyle||{}},log:function(a){"undefined"!==
typeof console&&console.log&&console.log(a)},compose:function(a){var d=Array.prototype.slice.call(a).reverse();return function(c){for(var b=0;b<d.length;b++)c=(0,d[b])(c);return c}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.tinymce.Clipboard",["ephox.powerpaste.legacy.tinymce.Util"],function(a){var d=function(c,b,d){var f,g,k,m=c.selection,n=c.dom;k=c.getBody();if(d.clipboardData&&d.clipboardData.getData("text/html"))return d.preventDefault(),
d=d.clipboardData.getData("text/html"),f=d.match(/<html[\s\S]+<\/html>/i),b(null===f?d:f[0]);if(!n.get("_mcePaste"))if(f=n.add(k,"div",{id:"_mcePaste","class":"mcePaste"},'\ufeff<br _mce_bogus="1">'),k=k!=c.getDoc().body?n.getPos(c.selection.getStart(),k).y:k.scrollTop,n.setStyles(f,{position:"absolute",left:-1E4,top:k,width:1,height:1,overflow:"hidden"}),tinymce.isIE)if(k=n.doc.body.createTextRange(),k.moveToElementText(f),k.execCommand("Paste"),n.remove(f),"\ufeff"===f.innerHTML)c.execCommand("mcePasteWord"),
d.preventDefault();else return b(f.innerHTML),tinymce.dom.Event.cancel(d);else{var q=function(b){b.preventDefault()};n.bind(c.getDoc(),"mousedown",q);n.bind(c.getDoc(),"keydown",q);tinymce.isGecko&&(k=c.selection.getRng(!0),k.startContainer==k.endContainer&&3==k.startContainer.nodeType&&(nodes=n.select("p,h1,h2,h3,h4,h5,h6,pre",f),1==nodes.length&&n.remove(nodes.reverse(),!0)));g=c.selection.getRng();f=f.firstChild;k=c.getDoc().createRange();k.setStart(f,0);k.setEnd(f,1);m.setRng(k);window.setTimeout(function(){var d=
"",e=n.select("div.mcePaste");a.each(e,function(b){var c=b.firstChild;c&&"DIV"==c.nodeName&&c.style.marginTop&&c.style.backgroundColor&&n.remove(c,1);a.each(n.select("div.mcePaste",b),function(b){n.remove(b,1)});a.each(n.select("span.Apple-style-span",b),function(b){n.remove(b,1)});a.each(n.select("br[_mce_bogus]",b),function(b){n.remove(b)});d+=b.innerHTML});a.each(e,function(b){n.remove(b)});g&&m.setRng(g);b(d);n.unbind(c.getDoc(),"mousedown",q);n.unbind(c.getDoc(),"keydown",q)},0)}};return{getOnPasteFunction:function(c,
b){return function(a){d(c,b,a)}},getOnKeyDownFunction:function(c,b){return function(a){(tinymce.isOpera||0<navigator.userAgent.indexOf("Firefox/2"))&&((tinymce.isMac?a.metaKey:a.ctrlKey)&&86==a.keyCode||a.shiftKey&&45==a.keyCode)&&d(c,b,a)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.Insert",[],function(){return{insert:function(a,d){var c=d.getDoc(),b,e=d.dom;d.selection.setContent('<span id="ephoxInsertMarker">&nbsp;</span>');
b=e.get("ephoxInsertMarker");for(var f=c.createDocumentFragment();a.firstChild&&!e.isBlock(a.firstChild);)f.appendChild(a.firstChild);for(c=c.createDocumentFragment();a.lastChild&&!e.isBlock(a.lastChild);)c.appendChild(a.lastChild);b.parentNode.insertBefore(f,b);e.insertAfter(c,b);if(a.firstChild){if(e.isBlock(a.firstChild)){for(;!e.isBlock(b.parentNode)&&b.parentNode!==e.getRoot();)b=e.split(b.parentNode,b);e.is(b.parentNode,"td,th")||b.parentNode===e.getRoot()||(b=e.split(b.parentNode,b))}e.replace(a,
b)}else e.remove(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.tinymce.Settings",["ephox.powerpaste.legacy.tinymce.Util"],function(a){var d={strip_class_attributes:"all",retain_style_properties:"none"},c={strip_class_attributes:"none",retain_style_properties:"valid"},b=function(b,a){if(b&&"string"!=typeof b)return b;switch(b){case "clean":return d;case "merge":return c;default:return a}},e=function(c,d,e){c=b(c,d);
return c=a.extend(c,{base_64_images:e})};return{create:function(b,a,p){var m=e(b,d,p),n=e(a,c,p),q=n;return{setWordContent:function(b){q=b?m:n},get:function(b){return q[b]}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Attributes",["ephox.powerpaste.legacy.tinymce.Util"],function(a){var d=function(a,b){return a&&b?function(d,p){return b(d,a(d,p))}:a||b};return{manager:function(c){var b=0,e,f=function(){return e},
g;g=function(){e={};b=0;a.each(c.attributes,function(a){var c=a.nodeName,d=a.value;(!1!==a.specified||"name"===a.nodeName&&""!==a.value)&&null!==d&&void 0!==d&&(e[c]=d,b++)});void 0===e.style&&c.style.cssText&&(e.style=c.style.cssText,b++);g=f;return e};var k,m,n=function(b){a.each(g(),function(a,c){b(c,a)})};return{get:function(b){return g()[b]},each:n,filter:function(a){k||(m=g);k=d(k,a);g=function(){g=m;n(function(a,d){var p=k(a,d);null===p?(c.removeAttribute(a),delete e[a],b--):p!==d&&("class"===
a?c.className=p:c.setAttribute(a,p),e[a]=p)});g=f;return e}},getAttributes:function(){return g()},getAttributeCount:function(){g();return b}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Token",["ephox.powerpaste.legacy.data.tokens.Attributes","ephox.powerpaste.legacy.tinymce.Util"],function(a,d,c){var b=a.manager,e=function(b){return b.replace(/-(.)/g,function(b,a){return a.toUpperCase()})},f=function(b){return b.replace(/([A-Z])/g,
function(b,a){return"-"+a.toLowerCase()})},g=!1,k=function(b,a,c){var e,p;a=a||b.getAttribute("style");void 0!==a&&null!==a&&a.split||(a=b.style.cssText);d.each(a.split(";"),function(b){var a=b.indexOf(":");0<a&&(e=d.trim(b.substring(0,a)),e.toUpperCase()===e&&(e=e.toLowerCase()),e=f(e),p=d.trim(b.substring(a+1)),g||(g=0===e.indexOf("mso-")),c(e,p))});g||(p=b.style["mso-list"])&&c("mso-list",p)},m=function(a,c,p){var f,g,m,s,h;switch(a.nodeType){case 1:c?f="endElement":(f="startElement",s=b(a),h=
{},k(a,p,function(b,a){h[b]=a}));g="HTML"!==a.scopeName&&a.scopeName&&a.tagName&&0>=a.tagName.indexOf(":")?(a.scopeName+":"+a.tagName).toUpperCase():a.tagName;break;case 3:f="text";m=a.nodeValue;break;case 8:f="comment";m=a.nodeValue;break;default:d.log("WARNING: Unsupported node type encountered: "+a.nodeType)}var l=function(b){"startElement"===f&&s.filter(b)};return{getNode:function(){s&&s.getAttributes();return a},tag:function(){return g},type:function(){return f},text:function(){return m},toString:function(){return"Type: "+
f+", Tag: "+g+" Text: "+m},getAttribute:function(b){return s.get(b.toLowerCase())},filterAttributes:l,filterStyles:function(b){if("startElement"===f){var c="";d.each(h,function(d,p){var f=b(p,d);null===f?(a.style.removeProperty?a.style.removeProperty(e(p)):a.style.removeAttribute(e(p)),delete h[p]):(c+=p+": "+f+"; ",h[p]=f)});c=c?c:null;l(function(b,a){return"style"===b?c:a});a.style.cssText=c}},getAttributeCount:function(){return s.getAttributeCount()},attributes:function(b){s.each(b)},getStyle:function(b){return h[b]},
styles:function(b){d.each(h,function(a,c){b(c,a)})},getComputedStyle:function(){return d.ephoxGetComputedStyle(a)},isWhitespace:function(){return"text"===f&&/^[\s\u00A0]*$/.test(m)}}};a=function(b,a){return m(a.createElement(b),!0)};return{START_ELEMENT_TYPE:"startElement",END_ELEMENT_TYPE:"endElement",TEXT_TYPE:"text",COMMENT_TYPE:"comment",FINISHED:a("HTML",window.document),token:m,createStartElement:function(b,a,c,p){var f=p.createElement(b),k="";d.each(a,function(b,a){f.setAttribute(a,b)});d.each(c,
function(b,a){k+=a+":"+b+";";f.style[e(a)]=b});return m(f,!1,""!==k?k:null)},createEndElement:a,createComment:function(b,a){return m(a.createComment(b),!1)},createText:function(b,a){return m(a.createTextNode(b))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Serializer",["ephox.powerpaste.legacy.data.tokens.Token"],function(a){return{create:function(d){var c=d.createDocumentFragment();return{dom:c,receive:function(b){var e=
function(b){b=b.getNode().cloneNode(!1);c.appendChild(b);c=b},f=function(b,a){var e=d.createTextNode(b.text());c.appendChild(e)};switch(b.type()){case a.START_ELEMENT_TYPE:e(b);break;case a.TEXT_TYPE:f(b);break;case a.END_ELEMENT_TYPE:c=c.parentNode;break;case a.COMMENT_TYPE:break;default:throw{message:"Unsupported token type: "+b.type()};}}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Tokenizer",["ephox.powerpaste.legacy.data.tokens.Token"],
function(a){return{tokenize:function(d,c){var b;c=c||window.document;b=c.createElement("div");c.body.appendChild(b);b.style.position="absolute";b.style.left="-10000px";b.innerHTML=d;nextNode=b.firstChild||a.FINISHED;var e=[];endNode=!1;return{hasNext:function(){return void 0!==nextNode},next:function(){var d=nextNode,g=endNode;!endNode&&nextNode.firstChild?(e.push(nextNode),nextNode=nextNode.firstChild):endNode||1!==nextNode.nodeType?nextNode.nextSibling?(nextNode=nextNode.nextSibling,endNode=!1):
(nextNode=e.pop(),endNode=!0):endNode=!0;d===a.FINISHED||nextNode||(c.body.removeChild(b),nextNode=a.FINISHED);d=d===a.FINISHED?d:d?a.token(d,g):void 0;return d}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Filter",["ephox.powerpaste.legacy.data.tokens.Token","ephox.powerpaste.legacy.tinymce.Util"],function(a,d){var c=function(b,c){return function(f,g,k){var m,n,q,r=!1,s=function(){c&&c(x);r=!1;n=[];q=[]},
t=function(b){d.each(b,function(b){f.receive(b)})},u=function(b){r?q.push(b):f.receive(b)},h=function(){l();t(q);s()},l=function(){d.each(m,function(b){u(b)});w()},w=function(){m=[]},x={document:k||window.document,settings:g||{},emit:u,receive:function(d){c&&n.push(d);b(x,d);d===a.FINISHED&&h()},startTransaction:function(){r=!0},rollback:function(){t(n);s()},commit:h,defer:function(b){m=m||[];m.push(b)},hasDeferred:function(){return m&&0<m.length},emitDeferred:l,dropDeferred:w};s();return x}};return{createFilter:c,
createAttributeFilter:function(b){return c(function(a,c){c.filterAttributes(d.bind(b,a));a.emit(c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.Text",["ephox.powerpaste.legacy.data.tokens.Filter","ephox.powerpaste.legacy.data.tokens.Token"],function(a,d){var c=/^(P|H[1-6]|T[DH]|LI|DIV|BLOCKQUOTE|PRE|ADDRESS|FIELDSET|DD|DT|CENTER)$/,b=function(){return null},e=!1;return a.createFilter(function(a,p){var k=function(){e||
(a.emit(d.createStartElement("P",{},{},a.document)),e=!0)};switch(p.type()){case d.TEXT_TYPE:k();a.emit(p);break;case d.END_ELEMENT_TYPE:e&&(c.test(p.tag())||p===d.FINISHED)?(a.emit(d.createEndElement("P",a.document)),e=!1):"BR"===p.tag()&&a.emit(p);break;case d.START_ELEMENT_TYPE:"BR"===p.tag()?(p.filterAttributes(b),p.filterStyles(b),a.emit(p)):"IMG"===p.tag()&&p.getAttribute("alt")&&(k(),a.emit(d.createText(p.getAttribute("alt"),a.document)))}p===d.FINISHED&&a.emit(p)})})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.data.tokens.Helper",["ephox.powerpaste.legacy.data.tokens.Token"],function(a){return{hasNoAttributes:function(d,c){return d.type()===a.START_ELEMENT_TYPE?0===d.getAttributeCount()||c&&1===d.getAttributeCount()&&null!==d.getAttribute("style")&&void 0!==d.getAttribute("style"):d.type()===a.END_ELEMENT_TYPE},supportsCustomStyles:function(){if(0<navigator.userAgent.indexOf("Gecko")&&0>navigator.userAgent.indexOf("WebKit"))return!1;
var d=document.createElement("div");try{d.innerHTML='<p style="mso-list: Ignore;">&nbsp;</p>'}catch(c){return!1}return"Ignore"===a.token(d.firstChild).getStyle("mso-list")}(),spanOrA:function(a){return"A"===a.tag()||"SPAN"===a.tag()},hasMsoListStyle:function(a){return(a=a.getStyle("mso-list"))&&"skip"!==a}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.list.ListTypes",["ephox.powerpaste.legacy.data.tokens.Token",
"ephox.powerpaste.legacy.tinymce.Util"],function(a,d){var c=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"OL",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"OL",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:"OL",type:"lower-roman"}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:"OL"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"OL",variant:"outline"}},
{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"OL",type:"upper-alpha"}}],b={"\u2022":{tag:"UL",type:"disc"},"\u00b7":{tag:"UL",type:"disc"},"\u00a7":{tag:"UL",type:"square"}},e={o:{tag:"UL",type:"circle"},"-":{tag:"UL",type:"disc"},"\u25cf":{tag:"UL",type:"disc"}},f=function(b,a){var c={tag:b.tag,type:b.type,variant:a};b.start&&(c.start=b.start);b.type||delete c.type;return c},g=function(b,a,c){return b===a||b&&a&&b.tag===a.tag&&b.type===a.type&&
(c||b.variant===a.variant)};return{guessListType:function(a,p,n){var q=null,r,s;a&&(r=a.text,s=a.symbolFont);r=d.trim(r);(q=e[r])?q=f(q,r):s?q=(q=b[r])?f(q,r):{tag:"UL",variant:r}:(d.each(c,function(b){if(b.regex.test(r)){if(p&&g(b.type,p,!0))return q=b.type,q.start=parseInt(r),!1;q||(q=b.type);q.start=parseInt(r)}}),q&&!q.variant&&(a="("===r.charAt(0)?"()":")"===r.charAt(r.length-1)?")":".",q=f(q,a)));q&&"OL"===q.tag&&n&&("P"!==n.tag()||/^MsoHeading/.test(n.getAttribute("class")))&&(q=null);return q},
eqListType:g,checkFont:function(b,c){b.type()==a.START_ELEMENT_TYPE&&((font=b.getStyle("font-family"))?c="Wingdings"===font||"Symbol"===font:/^(P|H[1-6]|DIV)$/.test(b.tag())&&(c=!1));return c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.list.CommentHeuristics",["ephox.powerpaste.legacy.data.tokens.Token","ephox.powerpaste.legacy.filters.list.ListTypes","ephox.powerpaste.legacy.tinymce.Util"],function(a,d,c){var b=
function(b){var a=b.indexOf(".");if(0<=a&&c.trim(b.substring(a+1))===className)return match=results[2],!1},e=function(b){var a={};return function(c,d){var e,p=c+","+d;if(a.hasOwnProperty(p))return a[p];e=b.call(null,c,d);return a[p]=e}}(function(a,d){var e,p=/([^{]+){([^}]+)}/g;for(p.lastIndex=0;null!==(e=p.exec(a));)c.each(e[1].split(","),b(selector));return!1});return{isListWithoutCommentsOrStyles:function(b,e){var k,m=!1,n;n=function(b){(b=b.style.fontFamily)&&(m="Wingdings"===b||"Symbol"===b)};
if(b.type()===a.START_ELEMENT_TYPE&&e.openedTag&&"SPAN"===b.tag()){k=e.openedTag.getNode();n(k);for(1<k.childNodes.length&&"A"===k.firstChild.tagName&&""===k.firstChild.textContent&&(k=k.childNodes[1]);k.firstChild&&("SPAN"===k.firstChild.tagName||"A"===k.firstChild.tagName);)k=k.firstChild,n(k);if((k=k.firstChild)&&3===k.nodeType){n=k.value;c.trim(n)||(n=(k=k.parentNode.nextSibling)?k.value:"");if(!k||c.trim(k.parentNode.textContent)!=n)return!1;if(n=d.guessListType({text:n,symbolFont:m},null,e.originalToken))return k.nextSibling&&
"SPAN"===k.nextSibling.tagName&&/^[\u00A0\s]/.test(k.nextSibling.firstChild.value)&&("P"===e.openedTag.tag()||"UL"===n.tag)}else return k&&"IMG"===k.tagName}return!1},indentGuesser:function(){var b,a;return{guessIndentLevel:function(c,d,p,q){var r=1;if(q&&/^([0-9]+\.)+[0-9]+\.?$/.test(q.text))return q.text.replace(/([0-9]+|\.$)/g,"").length+1;p=a||parseInt(e(p,d.getAttribute("class")));c=c.getNode();d=d.getNode();q=0;for(c=c.parentNode;null!==c&&void 0!==c&&c!==d.parentNode;)q+=c.offsetLeft,c=c.offsetParent;
d=q;p?b?d+=b:0===d&&(b=p,d+=p):p=48;a=p=Math.min(d,p);return r=Math.max(1,Math.floor(d/p))||1}}},styles:function(){var b=!1,c="";return{check:function(d){return b&&d.type()===a.TEXT_TYPE?(c+=d.text(),!0):d.type()===a.START_ELEMENT_TYPE&&"STYLE"===d.tag()?b=!0:d.type()===a.END_ELEMENT_TYPE&&"STYLE"===d.tag()?(b=!1,!0):!1}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.list.Emitter",["ephox.powerpaste.legacy.data.tokens.Token",
"ephox.powerpaste.legacy.filters.list.ListTypes"],function(a,d){var c=["disc","circle","square"];return function(b,e){var f=[],g=[],k=0,m,n=function(c,d){var g={},n={};k++;d&&c.type&&(g={"list-style-type":c.type});c.start&&1<c.start&&(n={start:c.start});f.push(c);b.emit(a.createStartElement(c.tag,n,g,e));m=c},q=function(){b.emit(a.createEndElement(f.pop().tag,e));k--;m=f[f.length-1]},r=function(){var c=g?g.pop():"P";"P"!=c&&b.emit(a.createEndElement(c,e));b.emit(a.createEndElement("LI",e))},s=function(c,
f,k){var r={};if(c){var s=c.getStyle("margin-left");void 0!==s&&(r["margin-left"]=s)}else r["list-style-type"]="none";m&&!d.eqListType(m,f)&&(q(),k&&(b.emit(a.createStartElement("P",{},{},e)),b.emit(a.createText("\u00a0",e)),b.emit(a.createEndElement("P",e))),n(f,!0));b.emit(a.createStartElement("LI",{},r,e));c&&"P"!=c.tag()?(g.push(c.tag()),c.filterStyles(function(){return null}),b.emit(c)):g.push("P")};return{openList:n,closelist:q,closeAllLists:function(){for(;0<k;)r(),q();b.commit()},closeItem:r,
openLI:s,openItem:function(d,f,m,h){if(m){for(k||(k=0);k>d;)r(),q();"UL"===m.tag&&c[d-1]===m.type&&(m={tag:"UL"});if(k==d)r(),s(f,m,h);else for(1<d&&0<g.length&&"P"!==g[g.length-1]&&(b.emit(a.createEndElement(g[g.length-1],e)),g[g.length-1]="P");k<d;)n(m,k==d-1),s(k==d?f:void 0,m)}},getCurrentListType:function(){return m},getCurrentLevel:function(){return k}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.list.ListStates",
["ephox.powerpaste.legacy.data.tokens.Helper","ephox.powerpaste.legacy.data.tokens.Token","ephox.powerpaste.legacy.filters.list.CommentHeuristics","ephox.powerpaste.legacy.filters.list.ListTypes","ephox.powerpaste.legacy.tinymce.Util"],function(a,d,c,b,e){var f=function(b,a){e.log("Unexpected token in list conversion: "+a.toString());b.rollback()},g=function(b,a,c){return a==c?b:null},k=function(b,c,f){f.type()===d.TEXT_TYPE&&""===e.trim(f.text())?b.defer(f):c.skippedPara||f.type()!==d.START_ELEMENT_TYPE||
"P"!==f.tag()||a.hasMsoListStyle(f)?n(b,c,f):(c.openedTag=f,b.defer(f),c.nextFilter=m)},m=function(b,e,f){f.type()!==d.START_ELEMENT_TYPE||"SPAN"!==f.tag()||0!==e.spanCount.length||!a.supportsCustomStyles&&c.isListWithoutCommentsOrStyles(f,e)||a.hasMsoListStyle(f)?f.type()===d.END_ELEMENT_TYPE?"SPAN"===f.tag()?(b.defer(f),e.spanCount.pop()):"P"===f.tag()?(b.defer(f),e.skippedPara=!0,e.openedTag=null,e.nextFilter=k):(e.nextFilter=n,e.nextFilter(b,e,f)):f.isWhitespace()?b.defer(f):(e.nextFilter=n,e.nextFilter(b,
e,f)):(b.defer(f),e.spanCount.push(f))},n=function(b,e,f){var k=function(){e.emitter.closeAllLists();b.emitDeferred();e.openedTag=null;b.emit(f);e.nextFilter=n};if(f.type()===d.START_ELEMENT_TYPE&&a.hasMsoListStyle(f)&&"LI"!==f.tag()){f.getStyle("mso-list");var g=/ level([0-9]+)/.exec(f.getStyle("mso-list"));g&&g[1]?(e.itemLevel=parseInt(g[1],10)+e.styleLevelAdjust,e.nextFilter===n?b.emitDeferred():b.dropDeferred(),e.nextFilter=r,b.startTransaction(),e.originalToken=f,e.commentMode=!1):k()}else!a.supportsCustomStyles&&
(f.type()===d.COMMENT_TYPE&&"[if !supportLists]"===f.text()||c.isListWithoutCommentsOrStyles(f,b))?(f.type()===d.START_ELEMENT_TYPE&&"SPAN"===f.tag()&&e.spanCount.push(f),e.nextFilter=r,b.startTransaction(),e.originalToken=e.openedTag,e.commentMode=!0,e.openedTag=null,b.dropDeferred()):f.type()===d.END_ELEMENT_TYPE&&a.spanOrA(f)?(b.defer(f),e.spanCount.pop()):f.type()===d.START_ELEMENT_TYPE?a.spanOrA(f)?(b.defer(f),e.spanCount.push(f)):(e.openedTag&&(e.emitter.closeAllLists(),b.emitDeferred()),e.openedTag=
f,b.defer(f)):k()},q=function(b,a,c){c.type()===d.END_ELEMENT_TYPE&&a.originalToken.tag()===c.tag()&&(a.nextFilter=k,a.styleLevelAdjust=-1);b.emit(c)},r=function(b,a,c){c.type()==d.START_ELEMENT_TYPE&&"Ignore"===c.getStyle("mso-list")&&(a.nextFilter=s);if(c.type()===d.START_ELEMENT_TYPE&&"SPAN"===c.tag()){if(a.spanCount.push(c),a.commentMode&&""===c.getAttribute("style")||null===c.getAttribute("style"))a.nextFilter=s}else if("A"===c.tag())c.type()===d.START_ELEMENT_TYPE?a.spanCount.push(c):a.spanCount.pop();
else if(c.type()===d.TEXT_TYPE)if(a.commentMode)a.nextFilter=s,a.nextFilter(b,a,c);else{var p=a.originalToken,k=a.spanCount;a.emitter.closeAllLists();b.emit(p);e.each(k,e.bind(b.emit,b));b.emit(c);b.commit();a.originalToken=p;a.nextFilter=q}else(a.commentMode||c.type()!==d.COMMENT_TYPE)&&f(b,c)},s=function(b,c,e){e.type()===d.TEXT_TYPE?e.isWhitespace()||(c.nextFilter=t,c.bulletInfo={text:e.text(),symbolFont:c.symbolFont}):a.spanOrA(e)?e.type()===d.START_ELEMENT_TYPE?c.spanCount.push(e):c.spanCount.pop():
e.type()===d.START_ELEMENT_TYPE&&"IMG"===e.tag()?(c.nextFilter=t,c.bulletInfo={text:"\u2202",symbolFont:!0}):f(b,e)},t=function(b,c,e){e.type()===d.START_ELEMENT_TYPE&&a.spanOrA(e)?(c.spanCount.push(e),c.nextFilter=u):e.type()===d.END_ELEMENT_TYPE&&a.spanOrA(e)?(c.spanCount.pop(),c.nextFilter=h):e.type()===d.END_ELEMENT_TYPE&&"IMG"===e.tag()||f(b,e)},u=function(b,c,e){e.type()===d.END_ELEMENT_TYPE&&(a.spanOrA(e)&&c.spanCount.pop(),c.nextFilter=h)},h=function(c,k,m){var n=function(a){k.nextFilter=
l;k.commentMode&&(k.itemLevel=k.indentGuesser.guessIndentLevel(m,k.originalToken,k.styles.styles,k.bulletInfo));k.listType=b.guessListType(k.bulletInfo,g(k.emitter.getCurrentListType(),k.emitter.getCurrentLevel(),k.itemLevel),k.originalToken);if(k.listType){k.emitter.openItem(k.itemLevel,k.originalToken,k.listType,k.skippedPara);for(c.emitDeferred();0<k.spanCount.length;)c.emit(k.spanCount.shift());a&&c.emit(m)}else e.log("Unknown list type: "+k.bulletInfo.text+" Symbol font? "+k.bulletInfo.symbolFont),
c.rollback()};m.type()===d.TEXT_TYPE||m.type()===d.START_ELEMENT_TYPE?n(!0):m.type()===d.COMMENT_TYPE?n("[endif]"!==m.text()):m.type()===d.END_ELEMENT_TYPE?a.spanOrA(m)&&k.spanCount.pop():f(c,m)},l=function(b,a,c){c.type()===d.END_ELEMENT_TYPE&&c.tag()===a.originalToken.tag()?(a.nextFilter=k,a.skippedPara=!1):b.emit(c)};return{initial:n}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.list.Lists","ephox.powerpaste.legacy.data.tokens.Filter ephox.powerpaste.legacy.data.tokens.Helper ephox.powerpaste.legacy.data.tokens.Token ephox.powerpaste.legacy.filters.list.CommentHeuristics ephox.powerpaste.legacy.filters.list.Emitter ephox.powerpaste.legacy.filters.list.ListStates ephox.powerpaste.legacy.filters.list.ListTypes ephox.powerpaste.legacy.tinymce.Util".split(" "),
function(a,d,c,b,e,f,g,k){var m={},n=function(a){m.nextFilter=f.initial;m.itemLevel=0;m.originalToken=null;m.commentMode=!1;m.openedTag=null;m.symbolFont=!1;m.listType=null;m.indentGuesser=b.indentGuesser();m.emitter=e(a,a.document);m.styles=b.styles();m.spanCount=[];m.skippedPara=!1;m.styleLevelAdjust=0;m.bulletInfo=void 0};n({});return a.createFilter(function(b,a){m.styles.check(a)||(m.symbolFont=g.checkFont(a,m.symbolFont),m.nextFilter(b,m,a))},function(b){n(b)})})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.tinymce.BrowserFilters",["ephox.powerpaste.legacy.tinymce.Util"],function(a){var d=function(b){return 65279===b.charCodeAt(b.length-1)?b.substring(0,b.length-1):b},c=function(b){return/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(b)?b.replace(/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,
"$1"):b},b=function(b){return b.replace(/<br><br>/g,"<BR><BR>")},e=function(b){return b.replace(/<br>/g," ")},f=function(b){return b.replace(/<BR><BR>/g,"<br>")},g=[d],c=tinymce.isIE&&9<=document.documentMode?[f,e,b,c].concat(g):g;return{all:a.compose(c),textOnly:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.FilterInlineStyles",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){var d=/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/,
c=function(b){return function(a,c){var p=!1;switch(b){case "all":case "*":p=!0;break;case "valid":p=!d.test(a);break;case void 0:case "none":p="list-style-type"===a;break;default:p=0<=(","+b+",").indexOf(","+a+",")}return p?c:null}};return a.createFilter(function(b,a){var d=b.settings.get("retain_style_properties");a.filterStyles(c(d));b.emit(a)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.InferListTags",["ephox.powerpaste.legacy.data.tokens.Filter",
"ephox.powerpaste.legacy.data.tokens.Token"],function(a,d){return a.createFilter(function(a,b){a.seenList||(a.inferring?"LI"===b.tag()&&(b.type()===d.START_ELEMENT_TYPE?a.inferring++:(a.inferring--,a.inferring||(a.needsClosing=!0))):("OL"===b.tag()||"UL"===b.tag()?a.seenList=!0:"LI"===b.tag()&&(a.inferring=1,a.needsClosing||a.emit(d.createStartElement("UL",{},{},a.document))),!a.needsClosing||a.inferring||b.isWhitespace()||(a.needsClosing=!1,a.emit(d.createEndElement("UL",a.document)))));a.emit(b)})})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripBookmarks",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,c){return"name"===a||"id"===a?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripClassAttributes",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,
c){var b;if("class"===a)switch(b=this.settings.get("strip_class_attributes"),b){case "mso":return 0===c.indexOf("Mso")?null:c;case "none":break;default:return null}return c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripEmptyInlineElements",["ephox.powerpaste.legacy.data.tokens.Filter","ephox.powerpaste.legacy.data.tokens.Helper","ephox.powerpaste.legacy.data.tokens.Token"],function(a,d,c){var b=[],e=[],f=
!1,g=function(a,p){b.push(p);e=e||[];if(p.type()===c.START_ELEMENT_TYPE)e.push(p);else if(p.type()===c.END_ELEMENT_TYPE&&(e.pop(),0===e.length)){if(f){var g,q=b.length,r;for(r=0;r<q;r++)if(g=b[r])if(g.type()===c.START_ELEMENT_TYPE&&"SPAN"===g.tag()&&d.hasNoAttributes(g)){g=q;for(var s=void 0,t=void 0,u=1,s=r+1;s<g;s++)if((t=b[s])&&"SPAN"===t.tag())if(t.type()===c.START_ELEMENT_TYPE)u++;else if(t.type()===c.END_ELEMENT_TYPE&&(u--,0===u)){b[s]=null;break}}else a.emit(g)}b=[];e=[];f=!1}};return a.createFilter(function(a,
e){b=b||[];var p=function(b){return!(0<=",FONT,EM,STRONG,SAMP,ACRONYM,CITE,CODE,DFN,KBD,TT,B,I,U,S,SUB,SUP,INS,DEL,VAR,SPAN,".indexOf(","+b.tag()+",")&&d.hasNoAttributes(b,!0))};0===b.length?e.type()===c.START_ELEMENT_TYPE?p(e)?a.emit(e):g(a,e):a.emit(e):(f||(f=p(e)),g(a,e))})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripEmptyStyleAttributes",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,
c){return"style"===a&&""===c?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripLangAttribute",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,c){return"lang"===a?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripImages",["ephox.powerpaste.legacy.data.tokens.Filter",
"ephox.powerpaste.legacy.data.tokens.Token"],function(a,d){return a.createFilter(function(a,b){if("IMG"===b.tag()){if(b.type()===d.END_ELEMENT_TYPE&&a.skipEnd){a.skipEnd=!1;return}if(b.type()===d.START_ELEMENT_TYPE){if(/^file:/.test(b.getAttribute("src"))){a.skipEnd=!0;return}if(a.settings.get("base_64_images")&&/^data:image\/.*;base64/.test(b.getAttribute("src"))){a.skipEnd=!0;return}}}a.emit(b)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripMetaAndLinkElements",
["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createFilter(function(a,c){"META"!==c.tag()&&"LINK"!==c.tag()&&a.emit(c)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripNoAttributeA",["ephox.powerpaste.legacy.data.tokens.Filter","ephox.powerpaste.legacy.data.tokens.Helper","ephox.powerpaste.legacy.data.tokens.Token"],function(a,d,c){var b=function(b){return!d.hasNoAttributes(b)&&!/^OLE_LINK/.test(b.getAttribute("name"))},
e=[];return a.createFilter(function(a,d){var p;d.type()===c.START_ELEMENT_TYPE&&"A"===d.tag()?(e.push(d),b(d)&&a.defer(d)):d.type()===c.END_ELEMENT_TYPE&&"A"===d.tag()?(p=e.pop(),b(p)&&a.defer(d),0===e.length&&a.emitDeferred()):a.hasDeferred()?a.defer(d):a.emit(d)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripScripts",["ephox.powerpaste.legacy.data.tokens.Filter","ephox.powerpaste.legacy.data.tokens.Token"],
function(a,d){var c=!1;return a.createFilter(function(b,a){"SCRIPT"===a.tag()?c=a.type()===d.START_ELEMENT_TYPE:c||(a.filterAttributes(function(b,a){return/^on/.test(b)||"language"===b?null:a}),b.emit(a))})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.wordimport.CommonFilters","ephox.powerpaste.legacy.filters.FilterInlineStyles ephox.powerpaste.legacy.filters.InferListTags ephox.powerpaste.legacy.filters.StripBookmarks ephox.powerpaste.legacy.filters.StripClassAttributes ephox.powerpaste.legacy.filters.StripEmptyInlineElements ephox.powerpaste.legacy.filters.StripEmptyStyleAttributes ephox.powerpaste.legacy.filters.StripLangAttribute ephox.powerpaste.legacy.filters.StripImages ephox.powerpaste.legacy.filters.StripMetaAndLinkElements ephox.powerpaste.legacy.filters.StripNoAttributeA ephox.powerpaste.legacy.filters.StripScripts".split(" "),
function(a,d,c,b,e,f,g,k,m,n,q){return[q,c,k,a,g,f,b,n,e,m,d]})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripFormattingAttributes",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createFilter(function(a,c){c.filterAttributes(function(a,d){return"align"===a||("UL"===c.tag()||"OL"===c.tag())&&"type"===a?null:d});a.emit(c)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripNamespaceDeclarations",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,c){return/^xmlns(:|$)/.test(a)?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripOPTags",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createFilter(function(a,c){c.tag&&/^([OVWXP]|U[0-9]+|ST[0-9]+):/.test(c.tag())||
a.emit(c)})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripTocLinks",["ephox.powerpaste.legacy.data.tokens.Filter"],function(a){return a.createAttributeFilter(function(a,c){return"href"===a&&(0<=c.indexOf("#_Toc")||0<=c.indexOf("#_mso"))?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.filters.StripVMLAttributes",["ephox.powerpaste.legacy.data.tokens.Filter"],
function(a){return a.createAttributeFilter(function(a,c){return/^v:/.test(a)?null:c})})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.wordimport.WordOnlyFilters","ephox.powerpaste.legacy.filters.StripFormattingAttributes ephox.powerpaste.legacy.filters.StripNamespaceDeclarations ephox.powerpaste.legacy.filters.StripOPTags ephox.powerpaste.legacy.filters.StripTocLinks ephox.powerpaste.legacy.filters.StripVMLAttributes ephox.powerpaste.legacy.filters.list.Lists".split(" "),
function(a,d,c,b,e,f){return[c,f,b,e,d,a]})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.legacy.wordimport.WordImport","ephox.powerpaste.legacy.data.tokens.Serializer ephox.powerpaste.legacy.data.tokens.Tokenizer ephox.powerpaste.legacy.filters.Text ephox.powerpaste.legacy.filters.list.Lists ephox.powerpaste.legacy.tinymce.BrowserFilters ephox.powerpaste.legacy.wordimport.CommonFilters ephox.powerpaste.legacy.wordimport.WordOnlyFilters".split(" "),
function(a,d,c,b,e,f,g){var k=function(b,c,e,f){var k=a.create(e);b=d.tokenize(b,e);var g,m=k;for(g=f.length-1;0<=g;g--)m=f[g](m,c,e);for(pipeline=m;b.hasNext();)pipeline.receive(b.next());return k.dom},m=function(a){return 0<=a.indexOf("<o:p>")||0<=a.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=a.indexOf("MsoListParagraphCxSpFirst")||0<=a.indexOf("<w:WordDocument>")};return{filter:function(a,b,c){a=e.all(a);var d=m(a);b.setWordContent(d);var p=f;d&&(p=g.concat(f));return k(a,b,c,p)},filterPlainText:function(a,
b,d){a=e.textOnly(a);return k(a,b,d,[c])},isWordContent:m}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.LegacyTinyDialog",["ephox.powerpaste.legacy.data.Insert","ephox.powerpaste.legacy.tinymce.Settings","ephox.powerpaste.legacy.wordimport.WordImport","global!setTimeout"],function(a,d,c,b){return function(e,f){return{showDialog:function(g){var k=function(b){var f={content:g};e.fire("PastePreProcess",f);b=d.create(b||
e.settings.powerpaste_word_import,b||e.settings.powerpaste_html_import,!0);var k=c.filter(f.content,b,e.getDoc());e.fire("PastePostProcess",k);e.undoManager.transact(function(){a.insert(k,e)})},m=function(a){return"clean"===a||"merge"===a},n=function(){var a,c=[{text:f("cement.dialog.paste.clean"),onclick:function(){a.close();k("clean")}},{text:f("cement.dialog.paste.merge"),onclick:function(){a.close();k("merge")}}],c={title:f("cement.dialog.paste.title"),spacing:10,padding:10,items:[{type:"container",
html:f("cement.dialog.paste.instructions")}],buttons:c};a=e.windowManager.open(c);b(function(){a&&a.getEl().focus()},1)};c.isWordContent(g)&&!m(e.settings.powerpaste_word_import)?n():m(e.settings.powerpaste_html_import)?k():n()}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.LegacyPowerPaste",["ephox.powerpaste.i18n.I18n","ephox.powerpaste.legacy.tinymce.Clipboard","ephox.powerpaste.tinymce.LegacyTinyDialog"],function(a,
d,c){return function(b,e){var f=this,g,k=c(b,a.translate),m=function(a){return function(b){a(b)}};g=d.getOnPasteFunction(b,k.showDialog);b.on("paste",m(g));g=d.getOnKeyDownFunction(b,k.showDialog);b.on("keydown",m(g));b.addCommand("mceInsertClipboardContent",function(a,b){k.showDialog(b.content||b)});if(b.settings.paste_preprocess)b.on("PastePreProcess",function(a){b.settings.paste_preprocess.call(f,f,a)})}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,
h,l){a("ephox.epithet.Id",[],function(){var a=0;return{generate:function(d){var c=(new Date).getTime(),b=Math.floor(1E9*Math.random());a++;return d+"_"+b+a+String(c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.DeviceType",["ephox.peanut.Fun"],function(a){return function(d,c,b){c=d.isiOS()&&-1!==b.search(/iPad/i);var e=d.isiOS()&&!c,f=d.isAndroid()&&3===d.version.major,g=d.isAndroid()&&4===d.version.major;b=c||f||g&&-1===b.search(/mobile/i);
g=(f=d.isiOS()||d.isAndroid())&&!b;return{isiPad:a.constant(c),isiPhone:a.constant(e),isTablet:a.constant(b),isPhone:a.constant(g),isTouch:a.constant(f),isAndroid:d.isAndroid,isiOS:d.isiOS}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.Platform",[],function(){return{create:function(a,d,c){return{browser:{current:a,version:d},os:{current:c}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,
h,l){a("ephox.fred.core.GetterHelper",[],function(){var a=function(a){return function(){return a}};return{getter:a,attachGetters:function(d,c,b){for(var e=0;e<b.length;e++)d["is"+b[e].name]=a(b[e].name===c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.Result",["ephox.fred.core.GetterHelper"],function(a){return{create:function(d,c,b){var e=a.attachGetters,f={};f.current=c;f.version=b;e(f,f.current,d);return f}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.SearchInfo",["ephox.violin.Strings"],function(a){var d=a.contains,c=function(a){return function(b){return d(b,a)}},b=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;return{create:function(a){var p=[{name:"Spartan",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return d(a,"edge/")&&d(a,"chrome")&&d(a,"safari")&&d(a,"applewebkit")}},{name:"ChromeFrame",versionRegexes:[/.*?chromeframe\/([0-9]+)\.([0-9]+).*/,
b],search:function(b){return d(b,"chromeframe")?a():!1}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,b],search:function(a){return d(a,"chrome")&&!d(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(b){var c=d(b,"msie")||d(b,"trident");return d(b,"chromeframe")?c&&!a():c}},{name:"Opera",versionRegexes:[b,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:c("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],
search:c("firefox")},{name:"Safari",versionRegexes:[b],search:c("safari")},{name:"Envjs",versionRegexes:[/.*?envjs\/\ ?([0-9]+)\.([0-9]+).*/],search:c("envjs")}],g=[{name:"Windows",search:c("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return d(a,"iphone")||d(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/]},{name:"Android",search:c("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:c("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},
{name:"Linux",search:c("linux")},{name:"Solaris",search:c("sunos")},{name:"FreeBSD",search:c("freebsd")}];return{browsers:p,oses:g}},chromeFrameChecker:function(){try{return!!new ActiveXObject("ChromeTab.ChromeFrame")}catch(a){return!1}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.SpecTester",[],function(){return{meetsSpec:function(a,d){var c=typeof a;if("boolean"===c)return!!a;if("object"===c)return c=a.minimum,d.major>c.major||
d.major===c.major&&d.minor>=c.minor;throw"invalid spec";}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.Fn",[],function(){return{findOneInArrayOr:function(a,d,c){for(var b=0;b<a.length;b++){var e=a[b];if(c(e,b,a))return e}return d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.UaStringDetector",["ephox.fred.core.Fn"],function(a){return{detect:function(d,c){var b=
a.findOneInArrayOr,e=String(c).toLowerCase();return b(d,{name:void 0},function(a){return a.search(e)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.core.VersionDetector",[],function(){return{detectVersion:function(a,d){var c=String(d).toLowerCase(),b=a.versionRegexes;if(b){a:{for(var e=0;e<b.length;e++){var f=b[e];if(f.test(c)){b=f;break a}}b=void 0}c=b?{major:Number(c.replace(b,"$1")),minor:Number(c.replace(b,"$2"))}:{major:0,minor:0}}else c=
{major:0,minor:0};return c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fred.PlatformDetection","ephox.fred.core.DeviceType ephox.fred.core.Platform ephox.fred.core.Result ephox.fred.core.SearchInfo ephox.fred.core.SpecTester ephox.fred.core.UaStringDetector ephox.fred.core.VersionDetector".split(" "),function(a,d,c,b,e,f,g){var k=g.detectVersion,m=c.create,n=e.meetsSpec,q=f.detect,r=function(a,b,c,d){return a[b]?a[b][c]?n(a[b][c],d):
!!a[b].All:!1},s=function(c,d){var e=b.create(d),f=e.browsers,e=e.oses,g=q(e,c),n=g.name,g=k(g,c),s=q(f,c),G=s.name,h=k(s,c),e=m(e,n,g),f=m(f,G,h),g=a(e,f,c);return{browser:f,os:e,deviceType:g,isSupported:function(a){return r(a,n,G,h)}}};return{Platform:d,detect:function(){return s(navigator.userAgent,b.chromeFrameChecker)},doDetect:s,isSupported:r,isSupportedPlatform:function(a,b){var c=b.browser;return r(a,b.os.current,c.current,c.version)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.FileReader",["ephox.numerosity.core.Global"],function(a){return function(){return new (a.getOrDie("FileReader"))}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.hermes.utils.ImageExtract","ephox.compass.Arr ephox.epithet.Id ephox.fred.PlatformDetection ephox.hermes.api.ImageAsset ephox.numerosity.api.FileReader ephox.numerosity.api.URL ephox.scullion.Struct".split(" "),function(a,
d,c,b,e,f,g){var k=g.immutable("id","obj","objurl"),m=function(a){return k(d.generate("image"),a,f.createObjectURL(a))};c=c.detect();var n=function(c,d){if(0===c.length)d([]);else{var f=[],k=function(a,b){var c=e();c.onload=function(c){b(a,c.target)};c.readAsDataURL(a)};a.each(c,function(a){var e=a.id(),p=a.obj(),g=a.objurl();k(p,function(a,p){var k=b.blob(e,a,g,p);f.push(k);f.length===c.length&&d(f)})})}};g=function(b){return 1===b.length&&a.contains(b,"Files")};var q=function(b){return!a.contains(b,
"text/_moz_htmlcontext")},r=function(b){return a.contains(b,"Files")},s=function(a){return!0};c=c.browser.isChrome()||c.browser.isSafari()||c.browser.isOpera()?r:c.browser.isFirefox()?q:c.browser.isIE()?g:s;return{blob:m,toAssets:function(b,c){var d=a.map(b,function(a){return m(a)});n(d,c)},toFiles:function(a){return a.raw().target.files||a.raw().dataTransfer.files},isFiles:c,fromImages:function(c){return a.map(c,function(a){var c=d.generate("image");return b.url(c,a.src,a)})},fromBlobs:n}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.hermes.api.ImageExtract",["ephox.hermes.utils.ImageExtract"],function(a){return{toAssets:function(d,c){return a.toAssets(d,c)},fromBlobs:function(d,c){return a.fromBlobs(d,c)},blob:a.blob}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.ModernPowerDrop","ephox.compass.Arr ephox.hermes.api.ImageAsset ephox.hermes.api.ImageExtract ephox.sugar.api.Attr ephox.sugar.api.Element global!tinymce".split(" "),
function(a,d,c,b,e,f){return function(g,k,m,n){var q,r=/^image\/(jpe?g|png|gif|bmp)$/i;g.on("dragstart dragend",function(a){q="dragstart"===a.type});g.on("dragover dragend dragleave",function(a){a.preventDefault()});var s=function(b){return a.filter(b.target.files||b.dataTransfer.files,function(a){return r.test(a.type)})},t=function(c){return a.map(c,function(a){var c=e.fromTag("img");a=d.cata(a,n.getLocalURL,function(a,b,c){return b});b.set(c,"src",a);return c.dom().outerHTML}).join("")},h=function(a){c.toAssets(a,
function(a){var b=t(a);g.insertContent(b,{merge:!1!==g.settings.paste_merge_formats});n.uploadImages(a)})};g.on("drop",function(a){if(!q){if(f.dom.RangeUtils&&f.dom.RangeUtils.getCaretRangeFromPoint){var b=f.dom.RangeUtils.getCaretRangeFromPoint(a.clientX,a.clientY,g.getDoc());b&&g.selection.setRng(b)}b=s(a);0<b.length&&h(b);a.preventDefault()}})}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.Bundle",["ephox.compass.Arr","ephox.scullion.Struct",
"global!console"],function(a,d,c){var b="officeStyles htmlStyles isWord proxyBin backgroundAssets isInternal".split(" "),e=d.immutableBag([],b);return{nu:e,merge:function(c,d){var k={};a.each(b,function(a){d[a]().or(c[a]()).each(function(b){k[a]=b})});return e(k)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.smartpaste.PasteResponse",["ephox.perhaps.Option","ephox.scullion.ADT"],function(a,d){var c=d.generate([{error:["message"]},
{paste:["elements","assets"]},{cancel:[]},{incomplete:["elements","assets","message"]}]),b=function(a,b,c,d,p){return a.fold(b,c,d,p)};return{error:c.error,paste:c.paste,cancel:c.cancel,incomplete:c.incomplete,cata:b,carry:function(d,f){return b(d,a.none,a.none,a.none,function(d,e,m){return b(f,a.none,function(b,d){return a.some(c.incomplete(b,d,m))},a.none,a.none)}).getOr(f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.knoch.core.FutureOps",
[],function(){return function(a,d){return{get:d,map:function(c){return a(function(a){d(function(d){a(c(d))})})},bind:function(c){return a(function(a){d(function(d){c(d).get(a)})})},anonBind:function(c){return a(function(a){d(function(d){c.get(a)})})}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.alien.FutureStep",["ephox.cement.api.Bundle","ephox.cement.smartpaste.PasteResponse","ephox.knoch.core.FutureOps","ephox.scullion.Struct"],
function(a,d,c,b){var e=b.immutableBag(["response","bundle"],[]),f=function(a){return g(function(b){var c=e(a);b(c)})},g=function(a){return c(g,function(b){a(b)})};return{call:function(a,b){a(e(b))},sync:g,pure:f,pass:function(a){return f({response:a.response(),bundle:a.bundle()})},done:e,error:function(b){return f({response:d.error(b),bundle:a.nu({})})},initial:function(){return f({response:d.paste([],[]),bundle:a.nu({})})},cancel:function(){return f({response:d.cancel(),bundle:a.nu({})})}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.perhaps.Options",["ephox.perhaps.Option"],function(a){return{cat:function(a){for(var c=[],b=function(a){c.push(a)},e=0;e<a.length;e++)a[e].each(b);return c},findMap:function(d,c){for(var b=0;b<d.length;b++){var e=c(d[b],b);if(e.isSome())return e}return a.none()},liftN:function(d,c){for(var b=[],e=0;e<d.length;e++){var f=d[e];if(f.isSome())b.push(f.getOrDie());else return a.none()}return a.some(c.apply(null,b))}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!RegExp",[],function(){return RegExp});(function(a,h,l){a("ephox.cement.smartpaste.Inspection",["ephox.perhaps.Option","ephox.perhaps.Options","global!RegExp"],function(a,d,c){var b=function(b,f){var g=new c(f,"i");return d.findMap(b,function(b){return null!==b.match(g)?a.some({type:b,flavor:f}):a.none()})};return{isValidData:function(a){return void 0!==a&&void 0!==a.types&&null!==a.types},getPreferredFlavor:function(a,
c){return d.findMap(a,function(a){return b(c,a)})},getFlavor:b}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.Adjudicator","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.smartpaste.Inspection ephox.cement.smartpaste.PasteResponse ephox.compass.Arr ephox.peanut.Fun ephox.perhaps.Option ephox.perhaps.Options ephox.scullion.Struct".split(" "),function(a,d,c,b,e,f,g,k,m){var n=m.immutable("steps","input","label",
"capture"),q=function(a,b){return k.findMap(a,function(a){return a.getAvailable(b).map(function(b){return n(a.steps(),b,a.label(),a.capture())})})},r=function(c,e){var k=f.curry(a.pass,c),g=function(){return e().map(function(e){var f=d.merge(c.bundle(),e.bundle());e=b.carry(c.response(),e.response());return a.done({response:e,bundle:f})})};return b.cata(c.response(),k,g,k,g)};return{choose:function(a,b,c){return q(a,c).getOrThunk(function(){return n(b.steps(),c,b.label(),b.capture())})},run:function(b,
c){return e.foldl(b,function(a,b){return a.bind(function(a){return r(a,function(){return b(c,a)})})},a.initial()).map(function(a){return a.response()})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.plumber.tap.control.BlockControl",[],function(){return{create:function(){var a=!1;return{isBlocked:function(){return a},block:function(){a=!0},unblock:function(){a=!1}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.plumber.tap.wrap.Tapped",[],function(){return{create:function(a,d){return{control:a,instance:d}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.plumber.tap.function.BlockTap",["ephox.plumber.tap.control.BlockControl","ephox.plumber.tap.wrap.Tapped"],function(a,d){return{tap:function(c){var b=a.create();return d.create(b,function(){b.isBlocked()||c.apply(null,arguments)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.api.Paste",["ephox.fred.PlatformDetection","ephox.peanut.Fun","global!setTimeout"],function(a,d,c){var b=a.detect();a=function(a,b,c){b.control.block();a.dom().execCommand("paste");c();b.control.unblock()};var e=function(a,b,d){c(d,1)},f=(b=b.browser.isIE()&&10>=b.browser.version.major)?a:e;return{willBlock:d.constant(b),run:function(a,b,c){return f(a,b,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,
h,l){a("ephox.cement.api.PasteBroker","ephox.cement.api.Adjudicator ephox.cement.smartpaste.PasteResponse ephox.compass.Arr ephox.peanut.Fun ephox.plumber.tap.function.BlockTap ephox.porkbun.Event ephox.porkbun.Events ephox.sloth.api.Paste".split(" "),function(a,d,c,b,e,f,g,k){return function(m,n){var q=g.create({cancel:f([]),error:f(["message"]),insert:f(["elements","assets"])}),r=e.tap(function(b){k.willBlock()&&(r.control.block(),b.preventDefault());var e=a.choose(m,n,b);e.capture()&&b.preventDefault();
b=c.map(e.steps(),function(a){return a(r.control)});a.run(b,e.input()).get(function(a){d.cata(a,function(a){q.trigger.error(a)},function(a,b){q.trigger.insert(a,b)},function(){q.trigger.cancel()},function(a,b,c){q.trigger.insert(a,b);q.trigger.error(c)})})});return{paste:r.instance,isBlocked:r.control.isBlocked,destroy:b.noop,events:q.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.PasteProcesses",["ephox.peanut.Fun"],
function(a){return{blocking:function(a){return function(c){return function(b,e,f){c.block();return a(b,e,f).map(function(a){c.unblock();return a})}}},normal:function(d){return a.constant(d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.knoch.core.Bounce",["global!Array"],function(a){return{bounce:function(d){return function(){var c=a.prototype.slice.call(arguments),b=this;setTimeout(function(){d.apply(b,c)},0)}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.knoch.core.FutureStaticOps",["ephox.compass.Arr"],function(a){return function(d){var c=function(b){return d(function(c){var d=[],g=0,k=function(a){return function(p){d[a]=p;g++;g>=b.length&&c(d)}};0===b.length?c([]):a.each(b,function(a,b){a.get(k(b))})})};return{nu:d,pure:function(a){return d(function(c){c(a)})},par:c,mapM:function(b,d){return c(a.map(b,d))},lift2:function(a,c,f){return d(function(d){var p=!1,m=!1,n=void 0,
q=void 0,r=function(){if(p&&m){var a=f(n,q);d(a)}};a.get(function(a){n=a;p=!0;r()});c.get(function(a){q=a;m=!0;r()})})}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.knoch.future.Future",["ephox.knoch.core.Bounce","ephox.knoch.core.FutureOps","ephox.knoch.core.FutureStaticOps"],function(a,d,c){var b=function(c){return d(b,function(b){c(a.bounce(b))})};return c(b)})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.knoch.future.CachedFuture","ephox.compass.Arr ephox.highway.Merger ephox.knoch.core.Bounce ephox.knoch.core.FutureOps ephox.knoch.core.FutureStaticOps ephox.knoch.future.Future ephox.perhaps.Option".split(" "),function(a,d,c,b,e,f,g){var k=function(e){var n=g.none(),q=[],r=function(){return n.isSome()},s=function(a){n.each(function(b){c.bounce(a)(b)})};f.nu(e).get(function(b){n=g.some(b);a.each(q,s);q=[]});e=b(k,function(a){r()?s(a):q.push(a)});return d.merge(e,{isSet:r})};
return e(k)})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.pastiche.IeBlob","ephox.compass.Arr ephox.epithet.Resolve ephox.hermes.api.ImageExtract ephox.knoch.future.CachedFuture ephox.peanut.Fun ephox.perhaps.Option".split(" "),function(a,d,c,b,e,f){return{convert:function(g){var k=d.resolve("window.clipboardData.files"),m=void 0!==g.convertURL?g.convertURL:void 0!==g.msConvertURL?g.msConvertURL:void 0;if(void 0!==k&&void 0!==m&&
0<k.length){var n=a.map(k,function(a){var b=c.blob(a);m.apply(g,[a,"specified",b.objurl()]);return b}),k=b.nu(function(a){c.fromBlobs(n,a)});k.get(e.noop);return f.some(k)}return f.none()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.pastiche.BackgroundAssets",["ephox.cement.pastiche.IeBlob","ephox.knoch.future.Future","ephox.peanut.Fun","ephox.perhaps.Option"],function(a,d,c,b){return{background:function(){var c=b.none();return{convert:function(b){c=
a.convert(b)},listen:function(a){return c.fold(function(){return d.nu(function(a){a([])})},function(a){return a}).get(a)},clear:function(){c=b.none()}}},ignore:function(){return{convert:b.none,listen:function(a){a([])},clear:c.noop}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.Blob",["ephox.numerosity.core.Global"],function(a){return function(d,c){return new (a.getOrDie("Blob"))(d,c)}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.numerosity.api.Uint8Array",["ephox.numerosity.core.Global"],function(a){return function(d){return new (a.getOrDie("Uint8Array"))(d)}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!parseInt",[],function(){return parseInt});(function(a,h,l){a("ephox.bowerbird.codes.HexToBlob","ephox.numerosity.api.Blob ephox.numerosity.api.Uint8Array global!Array global!Math global!String global!parseInt".split(" "),
function(a,d,c,b,e,f){return{convert:function(e,k){if(0===e.length)throw"Zero length content passed to Hex conversion";for(var m=new c(e.length/2),n=0;n<e.length;n+=2){var q=e.substr(n,2),r=b.floor(n/2);m[r]=f(q,16)}m=d(m);return a([m],{type:k})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bowerbird.core.RtfSupport",["ephox.scullion.ADT"],function(a){a=a.generate([{unsupported:["id","message"]},{supported:["id","contentType","blob"]}]);
return{unsupported:a.unsupported,supported:a.supported,cata:function(a,c,b){return a.fold(c,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bowerbird.core.Species",["ephox.peanut.Fun","ephox.perhaps.Option"],function(a,d){var c=function(b,c,e,f,g){return-1===b||-1===c?d.none():d.some({start:a.constant(b),end:a.constant(c),bower:e,regex:a.constant(f),idRef:a.constant(g)})},b=function(a,b,c){return function(){return a.substring(b,c)}},
e=function(a,b){if(-1===b)return b;var c=0,d=a.length,e,f;do if(e=a.indexOf("{",b),f=a.indexOf("}",b),f>e&&-1!==e?(b=e+1,++c):(e>f||0>e)&&-1!==f&&(b=f+1,--c),b>d||-1===f)return-1;while(0<c);return b},f=function(a,d,e,f){a=b(a,e,f);return c(e,f,a,/[^a-fA-F0-9]([a-fA-F0-9]+)\}$/,"i")},g=function(a,d,e,f){a=b(a,e,f);return c(e,f,a,/([a-fA-F0-9]{64,})(?:\}.*)/,"s")};return{identify:function(b,c){var n=b.indexOf("{\\pict{",c),q=e(b,n),r=b.indexOf("{\\shp{",c),s=e(b,r),t=a.curry(g,b,c,r,s),h=a.curry(f,
b,c,n,q);return-1===n&&-1===r?d.none():-1===n?t():-1===r?h():r<n&&s>q?h():n<r&&q>s?t():n<r?h():r<n?t():d.none()},endBracket:e}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bowerbird.core.Rtf",["ephox.bowerbird.codes.HexToBlob","ephox.bowerbird.core.RtfSupport","ephox.bowerbird.core.Species","ephox.perhaps.Option","ephox.perhaps.Result"],function(a,d,c,b,e){var f=function(a,b){return c.identify(a,b)},g=function(a){return 0<=a.indexOf("\\pngblip")?
e.value("image/png"):0<=a.indexOf("\\jpegblip")?e.value("image/jpeg"):e.error("errors.imageimport.unsupported")},k=function(a,b){var c=a.match(b);return c&&c[1]&&0===c[1].length%2?e.value(c[1]):e.error("errors.imageimport.invalid")},m=function(a){a=a.match(/\\shplid(\d+)/);return null!==a?b.some(a[1]):b.none()},n=function(b){var c=b.bower(),e=b.regex();return m(c).map(function(f){var m=b.idRef()+f;return g(c).fold(function(a){return d.unsupported(m,a)},function(b){return k(c,e).fold(function(a){return d.unsupported(m,
a)},function(c){return d.supported(m,b,a.convert(c,b))})})})},q=function(a){for(var b=[],c=function(){return a.length},d=function(a){var c=n(a);b=b.concat(c.toArray());return a.end()+1},e=0;e<a.length;)e=f(a,e).fold(c,d);return b};return{nextBower:f,extractId:m,extractContentType:g,extractHex:k,images:function(a){a=a.replace(/\r/g,"").replace(/\n/g,"");return q(a)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bowerbird.api.Rtf",["ephox.bowerbird.core.Rtf",
"ephox.bowerbird.core.RtfSupport","ephox.perhaps.Result"],function(a,d,c){return{images:function(b){return a.images(b)},toId:function(a){return d.cata(a,function(a,b){return a},function(a,b,c){return a})},toBlob:function(a){return d.cata(a,function(a,b){return c.error(b)},function(a,b,d){return c.value(d)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.flash.Correlation","ephox.bowerbird.api.Rtf ephox.compass.Arr ephox.hermes.api.ImageExtract ephox.perhaps.Option ephox.scullion.Struct ephox.sugar.api.Attr ephox.sugar.api.Class global!console".split(" "),
function(a,d,c,b,e,f,g,k){var m=e.immutable("image","url"),n={local:function(a,c,d){return b.from(c[d])},code:function(c,e,f){e=d.find(e,function(b){return a.toId(b)===c});return b.from(e)}},q=function(b){var c=[],e=function(b){return!d.exists(c,function(c){return a.toId(c)===b})};return d.bind(b,function(b){var d=a.toId(b);return e(d)?(c.push(b),[b]):[]})};return{convert:function(e,s,t,h){var l=q(s),y=[],w=!1;e=d.bind(e,function(d,e){var q=f.get(d,"data-image-type"),r=f.get(d,"data-image-id");g.remove(d,
"rtf-data-image");f.remove(d,"data-image-type");f.remove(d,"data-image-id");return(void 0!==n[q]?n[q]:b.none)(r,l,e).fold(function(){k.log("WARNING: unable to find data for image ",d.dom());return[]},function(b){return a.toBlob(b).fold(function(a){f.set(d,"alt",h(a));w=!0;return[]},function(a){a=c.blob(a);y.push(m(d,a.objurl()));return[a]})})});c.fromBlobs(e,function(a){d.each(y,function(a){f.set(a.image(),"src",a.url())});t(a,w)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
a.bolt.module.api.define("global!window",[],function(){return window});(function(a,h,l){a("ephox.sugar.api.Css","ephox.classify.Type ephox.compass.Arr ephox.compass.Obj ephox.perhaps.Option ephox.sugar.api.Attr ephox.sugar.api.Body ephox.sugar.api.Element ephox.sugar.api.Node ephox.violin.Strings global!Error global!console global!window".split(" "),function(a,d,c,b,e,f,g,k,m,n,q,r){var s=function(b,c,d){if(!a.isString(d))throw q.error("Invalid call to CSS.set. Property ",c,":: Value ",d,":: Element ",
b),new n("CSS value must be a string: "+d);b.style.setProperty(c,d)},t=function(a,b,c){a=a.dom();s(a,b,c)},h=function(a,c){var d=a.dom().style.getPropertyValue(c);return b.from(d).filter(function(a){return 0<a.length})},l=function(a,b,c){h(a,c).each(function(a){h(b,c).isNone()&&t(b,c,a)})};return{copy:function(a,b){b.dom().style.cssText=a.dom().style.cssText},set:t,preserve:function(a,b){var c=e.get(a,"style"),d=b(a);(void 0===c?e.remove:e.set)(a,"style",c);return d},setAll:function(a,b){var d=a.dom();
c.each(b,function(a,b){s(d,b,a)})},remove:function(a,b){a.dom().style.removeProperty(b);e.has(a,"style")&&""===m.trim(e.get(a,"style"))&&e.remove(a,"style")},get:function(a,b){var c=a.dom(),d=r.getComputedStyle(c).getPropertyValue(b),c=""!==d||f.inBody(a)?d:c.style.getPropertyValue(b);return null===c?void 0:c},getRaw:h,isValidValue:function(a,b,c){a=g.fromTag(a);t(a,b,c);return h(a,b).isSome()},reflow:function(a){return a.dom().offsetWidth},transfer:function(a,b,c){k.isElement(a)&&k.isElement(b)&&
d.each(c,function(c){l(a,b,c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.PredicateFind","ephox.classify.Type ephox.compass.Arr ephox.peanut.Fun ephox.perhaps.Option ephox.sugar.api.Body ephox.sugar.api.Compare ephox.sugar.api.Element ephox.sugar.impl.ClosestOrAncestor".split(" "),function(a,d,c,b,e,f,g,k){var m=function(d,e,f){d=d.dom();for(f=a.isFunction(f)?f:c.constant(!1);d.parentNode;){d=d.parentNode;var k=g.fromDom(d);
if(e(k))return b.some(k);if(f(k))break}return b.none()},n=function(a,e){var f=d.find(a.dom().childNodes,c.compose(e,g.fromDom));return b.from(f).map(g.fromDom)},q=function(a,c){var d=function(a){for(var e=0;e<a.childNodes.length;e++){if(c(g.fromDom(a.childNodes[e])))return b.some(g.fromDom(a.childNodes[e]));var f=d(a.childNodes[e]);if(f.isSome())return f}return b.none()};return d(a.dom())};return{first:function(a){return q(e.body(),a)},ancestor:m,closest:function(a,b,c){return k(function(a){return b(a)},
m,a,b,c)},sibling:function(a,c){var d=a.dom();return d.parentNode?n(g.fromDom(d.parentNode),function(b){return!f.eq(a,b)&&c(b)}):b.none()},child:n,descendant:q}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Replication","ephox.sugar.api.Attr ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f){var g=function(a){return d.fromDom(a.dom().cloneNode(!0))},
k=function(b,c){var e=d.fromTag(c),f=a.clone(b);a.setAll(e,f);return e};return{shallow:function(a){return d.fromDom(a.dom().cloneNode(!1))},shallowAs:k,deep:g,copy:function(a,c){var d=k(a,c),e=f.children(g(a));b.append(d,e);return d},mutate:function(a,d){var p=k(a,d);c.before(a,p);var g=f.children(a);b.append(p,g);e.remove(a);return p}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.api.RtfImage","ephox.perhaps.Option ephox.sugar.api.Attr ephox.sugar.api.Class ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Node ephox.sugar.api.PredicateFind ephox.sugar.api.Replication ephox.sugar.api.SelectorFilter ephox.violin.Strings".split(" "),
function(a,d,c,b,e,f,g,k,m,n){var q=function(a,b){var c=f.value(a),d=e.fromTag("div"),p=c.indexOf("]>");d.dom().innerHTML=c.substr(p+2);return g.descendant(d,function(a){return f.name(a)===b})},r=function(b){return f.isComment(b)?q(b,"v:shape"):a.none()},s=function(a){return m.descendants(a,".rtf-data-image")};return{local:function(b){if("img"===f.name(b)){var e=d.get(b,"src");if(void 0!==e&&null!==e&&n.startsWith(e,"file://"))return b=k.shallow(b),e=e.split(/[\/\\]/),d.set(b,"data-image-id",e[e.length-
1]),d.remove(b,"src"),d.set(b,"data-image-type","local"),c.add(b,"rtf-data-image"),a.some(b)}return a.none()},vshape:function(a){return r(a).map(function(a){var f=d.get(a,"o:spid"),f=void 0===f?d.get(a,"id"):f,p=e.fromTag("img");c.add(p,"rtf-data-image");d.set(p,"data-image-id",f.substr(7));d.set(p,"data-image-type","code");b.setAll(p,{width:b.get(a,"width"),height:b.get(a,"height")});return p})},find:s,exists:function(a){return 0<s(a).length},scour:r}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.flash.Flash","ephox.bowerbird.api.Rtf ephox.cement.flash.Correlation ephox.compass.Arr ephox.limbo.api.RtfImage ephox.porkbun.Event ephox.porkbun.Events ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g,k){return function(m,n){var q=n.translations,r=f.create({error:e(["message"]),insert:e(["elements","assets"]),incomplete:e(["elements","assets","message"])});return{events:r.registry,gordon:function(e,f){var s=
function(c){var g=c.hide();c=a.images(c.rtf());var m=b.find(e);d.convert(m,c,function(a,b){b?r.trigger.incomplete(k.children(e),a.concat(f),"errors.imageimport.failed"):r.trigger.insert(k.children(e),a.concat(f));g()},q)},h=function(a){var d=b.find(e);c.each(d,g.remove);r.trigger.incomplete(k.children(e),f,a)},l=function(){var a=b.find(e);c.each(a,g.remove);r.trigger.insert(k.children(e),f)},w=function(a){h(a.message())};if(n.allowLocalImages){var x=m(n);x.events.response.bind(s);x.events.cancel.bind(l);
x.events.failed.bind(w);x.events.error.bind(w);x.open()}else h("errors.local.images.disallowed")}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.scullion.Cell",[],function(){var a=function(d){var c=d;return{get:function(){return c},set:function(a){c=a},clone:function(){return a(c)}}};return a})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.step.FlashStep","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.flash.Flash ephox.cement.smartpaste.PasteResponse ephox.limbo.api.RtfImage ephox.perhaps.Option ephox.scullion.Cell ephox.sugar.api.Element ephox.sugar.api.InsertAll".split(" "),
function(a,d,c,b,e,f,g,k,m){return function(n,q){var r=c(n,q),s=g(f.none()),h=function(b){s.get().each(function(c){a.call(c,{response:b,bundle:d.nu({})})})};r.events.insert.bind(function(a){h(b.paste(a.elements(),a.assets()))});r.events.incomplete.bind(function(a){h(b.incomplete(a.elements(),a.assets(),a.message()))});r.events.error.bind(function(a){a=a.message();a=b.error(a);h(a)});return function(c,d){return a.sync(function(c){var g=function(){a.call(c,{response:d.response(),bundle:d.bundle()})},
n=function(a,b){s.set(f.some(c));var d=k.fromTag("div");m.append(d,a);e.exists(d)?r.gordon(d,b):g()};b.cata(d.response(),g,n,g,n)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.Bundles",["ephox.cement.alien.FutureStep","ephox.cement.smartpaste.PasteResponse","ephox.knoch.future.Future","global!console"],function(a,d,c,b){var e=function(a){return a.officeStyles().getOr(!0)},f=function(a){return a.htmlStyles().getOr(!1)},g=function(a){return a.isWord().getOr(!1)};
return{proxyBin:function(c){return{handle:function(e,f){return c.proxyBin().fold(function(){b.error(e);return a.pure({response:d.cancel(),bundle:{}})},f)}}},merging:function(a){var b=g(a);return b&&e(a)||!b&&f(a)},mergeOffice:e,mergeNormal:f,backgroundAssets:function(a){return c.nu(function(b){a.backgroundAssets().fold(function(){b([])},function(a){a.listen(b)})})},isWord:g,isInternal:function(a){return a.isInternal().getOr(!1)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.cement.style.Styles",["ephox.flour.style.Resolver"],function(a){return{resolve:a.create("ephox-cement").resolve}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.smartpaste.MergeSettings","ephox.cement.style.Styles ephox.highway.Merger ephox.peanut.Fun ephox.perhaps.Option ephox.sugar.api.Class ephox.sugar.api.Element ephox.sugar.api.Insert".split(" "),function(a,d,c,b,e,f,g){return function(k,m){var n=m.translations,
q=function(a,c,e){e(b.some(d.merge(c,{officeStyles:a,htmlStyles:a})))},r=function(c,d){var m=f.fromTag("div");e.add(m,a.resolve("styles-dialog-content"));var r=f.fromTag("p"),s=f.fromText(n("cement.dialog.paste.instructions"));g.append(r,s);g.append(m,r);var r={text:n("cement.dialog.paste.clean"),tabindex:0,className:a.resolve("clean-styles"),click:function(){h.destroy();q(!1,c,d)}},s={text:n("cement.dialog.paste.merge"),tabindex:1,className:a.resolve("merge-styles"),click:function(){h.destroy();
q(!0,c,d)}},h=k(!0);h.setTitle(n("cement.dialog.paste.title"));h.setContent(m);h.setButtons([r,s]);h.show();h.events.close.bind(function(){d(b.none());h.destroy()})};return{get:function(a,b){var c=m[a?"officeStyles":"htmlStyles"];"clean"===c?q(!1,m,b):"merge"===c?q(!0,m,b):r(m,b)},destroy:c.noop}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.step.MergeStep",["ephox.cement.alien.FutureStep","ephox.cement.api.Bundle","ephox.cement.api.Bundles",
"ephox.cement.smartpaste.MergeSettings","ephox.cement.smartpaste.PasteResponse"],function(a,d,c,b,e){var f=function(f,k){var m=b(f,k);return function(b,f){var g=f.bundle(),k=f.response();return a.sync(function(b){m.get(c.isWord(g),function(c){c=c.fold(function(){return{response:e.cancel(),bundle:f.bundle()}},function(a){return{response:k,bundle:d.nu({officeStyles:a.officeStyles,htmlStyles:a.htmlStyles})}});a.call(b,c)})})}};return{fixed:function(b,c){return function(e,f){return a.pure({response:f.response(),
bundle:d.nu({officeStyles:b,htmlStyles:c})})}},fromConfig:f,fromConfigIfExternal:function(b,e){return function(m,n){return c.isInternal(n.bundle())?a.pure({response:n.response(),bundle:d.nu({officeStyles:!0,htmlStyles:!0})}):f(b,e)(m,n)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Comments",["ephox.fred.PlatformDetection","ephox.peanut.Fun","ephox.sugar.api.Element","global!document"],function(a,d,c,b){var e=function(a){for(var b=
[];null!==a.nextNode();)b.push(c.fromDom(a.currentNode));return b},f=function(a){try{return e(a)}catch(b){return[]}};a=a.detect().browser;var g=a.isIE()||a.isSpartan()?f:e,k=d.constant(d.constant(!0));return{find:function(a,c){var d=c.fold(k,function(a){return function(b){return a(b.nodeValue)}});d.acceptNode=d;d=b.createTreeWalker(a.dom(),NodeFilter.SHOW_COMMENT,d,!1);return g(d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.alien.Comments",
["ephox.perhaps.Option","ephox.sugar.api.Comments","ephox.violin.Strings","global!document"],function(a,d,c,b){return{find:function(b){return d.find(b,a.some(function(a){return c.startsWith(a,"[if gte vml 1]")}))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.html.ImageReference","ephox.cement.alien.Comments ephox.compass.Arr ephox.limbo.api.RtfImage ephox.perhaps.Option ephox.perhaps.Options ephox.scullion.Struct ephox.sugar.api.Attr ephox.sugar.api.Elements ephox.sugar.api.SelectorFilter global!console".split(" "),
function(a,d,c,b,e,f,g,k,m,n){var q=f.immutable("img","vshape"),r=function(a,c){var e=g.get(a,"v:shapes"),f=b.from(d.find(c,function(a){return g.get(a,"id")===e}));f.isNone()&&n.log("WARNING: unable to find data for image",a.dom());return f.map(function(b){var c=g.clone(a);c._rawElement=a.dom();var d=g.clone(b);d._rawElement=b.dom();return q(c,d)})};return{extract:function(b){var f=k.fromHtml(b);b=d.bind(f,function(a){return m.descendants(a,"img")});var f=d.bind(f,a.find),g=e.cat(d.map(f,c.scour));
b=d.map(b,function(a){return r(a,g)});return e.cat(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.html.VshapeCorrelation","ephox.classify.Type ephox.compass.Arr ephox.peanut.Fun ephox.perhaps.Option ephox.sugar.api.Attr ephox.sugar.api.Class".split(" "),function(a,d,c,b,e,f){var g=function(b,c){var d=c.style;e.has(b,"width")&&e.has(b,"height")&&a.isString(d)&&(d=d.match(/rotation:([^;]*)/),null===d||"90"!==d[1]&&"-90"!==d[1]||
e.setAll(b,{width:e.get(b,"height"),height:e.get(b,"width")}))},k=function(a,b,c){return c.img()[a]===b},m=function(a,f,p){var g=e.get(f,p),g=c.curry(k,p,g);a=d.find(a,g);return b.from(a).map(function(a){e.remove(f,p);return a})};return{rotateImage:g,insertRtfCorrelation:function(a,b,c){d.each(b,function(b){m(a,b,c).each(function(a){a=a.vshape();var c=a["o:spid"],c=void 0===c?a.id:c;g(b,a);f.add(b,"rtf-data-image");e.set(b,"data-image-id",c.substr(7));e.set(b,"data-image-type","code")})})}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.impl.NodeValue",["ephox.perhaps.Option","global!Error"],function(a,d){return function(c,b){var e=function(b){try{return c(b)?a.some(b.dom().nodeValue):a.none()}catch(d){return a.none()}};return{get:function(a){if(!c(a))throw new d("Can only get "+b+" value of a "+b+" node");return e(a).getOr("")},getOption:e,set:function(a,e){if(!c(a))throw new d("Can only set raw "+b+" value of a "+b+" node");a.dom().nodeValue=e}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Comment",["ephox.sugar.api.Node","ephox.sugar.impl.NodeValue"],function(a,d){var c=d(a.isComment,"comment");return{get:function(a){return c.get(a)},getOption:function(a){return c.getOption(a)},set:function(a,d){c.set(a,d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.css.Set",["ephox.sugar.api.Insert"],function(a){return{setCss:function(d,c,b){d.dom().styleSheet?
d.dom().styleSheet.cssText=c:a.append(d,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.util.Regex",[],function(){return{escape:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.css.Url",["ephox.compass.Obj","ephox.vogue.util.Regex","global!RegExp"],function(a,d,c){var b=function(a,b,p){b=new c("url\\(\\s*['\"]?"+
d.escape(b)+"(.*?)['\"]?\\s*\\)","g");return a.replace(b,'url("'+p+'$1")')};return{replace:b,replaceMany:function(c,d){var g=c;a.each(d,function(a,c){g=b(g,c,a)});return g}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.api.DocStyle","ephox.sugar.api.Attr ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.SelectorFind ephox.vogue.css.Set ephox.vogue.css.Url global!Array".split(" "),function(a,d,c,b,e,f,g){return{stylesheets:function(a){a=
a.dom().styleSheets;return g.prototype.slice.call(a)},inject:function(g,m,n){var q=d.fromTag("style",n.dom());a.set(q,"type","text/css");g=void 0===m?g:f.replaceMany(g,m);e.setCss(q,g,d.fromText(g,n.dom()));n=b.descendant(n,"head").getOrDie();c.append(n,q)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.css.Rules",["ephox.compass.Arr","ephox.scullion.Struct"],function(a,d){var c=d.immutable("selector","style","raw"),b=function(b){return a.map(b.cssRules,
function(a){var b=a.selectorText,d=a.style.cssText;if(void 0===d)throw"WARNING: Browser does not support cssText property";return c(b,d,a.style)})};return{extract:b,extractAll:function(c){return a.bind(c,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.vogue.api.Rules",["ephox.vogue.css.Rules"],function(a){return{extract:function(d){return a.extract(d)},extractAll:function(d){return a.extractAll(d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.html.TordPostprocess","ephox.cement.html.VshapeCorrelation ephox.compass.Arr ephox.peanut.Fun ephox.sugar.api.Attr ephox.sugar.api.Comment ephox.sugar.api.Css ephox.sugar.api.Remove ephox.sugar.api.SelectorFilter ephox.sugar.api.Traverse ephox.vogue.api.DocStyle ephox.vogue.api.Rules".split(" "),function(a,d,c,b,e,f,g,k,m,n,q){var r=c.noop,s=function(a){var b={};d.each(a,function(c){void 0!==a[c]&&(b[c]=a[c])});return b},h=function(a,c){var e=
d.bind(c,function(b){var c=k.descendants(a,b.selector());d.each(c,function(a){var c=s(b.raw());f.setAll(a,c)});return c});d.each(e,function(a){b.remove(a,"class")})},l=function(a,b){var c=n.stylesheets(a),c=q.extractAll(c);h(b,c)},v=function(a){a=m.children(a);d.each(a,function(a){e.getOption(a).each(function(b){"StartFragment"!==b&&"EndFragment"!==b||g.remove(a)})})};return{doMergeInlineStyles:h,process:function(b,c,d,e,f){var g=k.descendants(c,"img");v(c);a.insertRtfCorrelation(d,g,e);(f.mergeInline()?
l:r)(b,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.photon.Reader",["ephox.perhaps.Option","ephox.sugar.api.Element"],function(a,d){var c=function(b){b=b.dom();try{var c=b.contentWindow?b.contentWindow.document:b.contentDocument;return void 0!==c&&null!==c?a.some(d.fromDom(c)):a.none()}catch(f){return console.log("Error reading iframe: ",b),console.log("Error was: "+f),a.none()}};return{doc:function(a){return c(a).fold(function(){return a},
function(a){return a})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.photon.Writer",["ephox.photon.Reader","ephox.sugar.api.Body"],function(a,d){return{write:function(c,b){if(!d.inBody(c))throw"Internal error: attempted to write to an iframe that is not in the DOM";var e=a.doc(c).dom();e.open();e.writeln(b);e.close()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.impl.FilteredEvent",
["ephox.peanut.Fun","ephox.sugar.api.Element"],function(a,d){var c=function(b,c,d,e,f,r,s){return{target:a.constant(b),x:a.constant(c),y:a.constant(d),stop:e,prevent:f,kill:r,raw:a.constant(s)}},b=function(b,e){return function(f){if(b(f)){var n=d.fromDom(f.target),q=function(){f.stopPropagation()},r=function(){f.preventDefault()},s=a.compose(r,q),n=c(n,f.clientX,f.clientY,q,r,s,f);e(n)}}},e=function(c,d,e,n,q){e=b(e,n);c.dom().addEventListener(d,e,q);return{unbind:a.curry(f,c,d,e,q)}},f=function(a,
b,c,d){a.dom().removeEventListener(b,c,d)};return{bind:function(a,b,c,d){return e(a,b,c,d,!1)},capture:function(a,b,c,d){return e(a,b,c,d,!0)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.DomEvent",["ephox.peanut.Fun","ephox.sugar.impl.FilteredEvent"],function(a,d){var c=a.constant(!0);return{bind:function(a,e,f){return d.bind(a,e,c,f)},capture:function(a,e,f){return d.capture(a,e,c,f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.photon.Sandbox","ephox.peanut.Fun ephox.photon.Writer ephox.sugar.api.Css ephox.sugar.api.DomEvent ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.Remove global!setTimeout".split(" "),function(a,d,c,b,e,f,g,k){return function(m){return{play:function(n,q,r){var s=e.fromTag("div"),h=e.fromTag("iframe");c.setAll(s,{display:"none"});var l=b.bind(h,"load",function(){d.write(h,n);var b=h.dom().contentWindow.document;if(void 0===b)throw"sandbox iframe load event did not fire correctly";
var c=e.fromDom(b),b=b.body;if(void 0===b)throw"sandbox iframe does not have a body";b=e.fromDom(b);c=q(c,b);l.unbind();g.remove(s);k(a.curry(r,c),0)});f.append(s,h);f.append(m,s)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Html",["ephox.sugar.api.Element","ephox.sugar.api.Insert"],function(a,d){var c=function(a){return a.dom().innerHTML};return{get:c,set:function(a,c){a.dom().innerHTML=c},getOuter:function(b){var e=a.fromTag("div");
b=a.fromDom(b.dom().cloneNode(!0));d.append(e,b);return c(e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.html.HtmlHandler","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.html.ImageReference ephox.cement.html.TordPostprocess ephox.cement.smartpaste.PasteResponse ephox.peanut.Fun ephox.photon.Sandbox ephox.sugar.api.Element ephox.sugar.api.Elements ephox.sugar.api.Html global!document".split(" "),function(a,
d,c,b,e,f,g,k,m,n,q){var r=function(a){var b=1;return a.replace(/(<img[^>]*)src=".*?"/g,function(a,c,d){return c+'data-textbox-image="'+b++ +'"'})},s=function(a,c){var d=g(k.fromDom(q.body));return function(e,g){d.play(e,function(d,e){b.process(d,e,a,"data-textbox-image",{mergeInline:f.constant(c)});return n.get(e)},g)}},h=function(b,f,g){return a.sync(function(k){var n=c.extract(b);s(n,f)(g,function(b){b=m.fromHtml(b);a.call(k,{response:e.paste(b,[]),bundle:d.nu({})})})})},l=function(a){var b=a.indexOf("</html>");
return-1<b?a.substr(0,b+7):a};return{handle:function(b,c,d){b=l(b);var f=r(b);return d.cleanDocument(f,c).fold(function(){return a.pure({response:e.error("errors.paste.word.notready"),bundle:{}})},function(b){return void 0===b||null===b||0===b.length?a.pure(e.paste([],[]),{}):h(f,c,b)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.images.ImageHandler","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.smartpaste.PasteResponse ephox.compass.Arr ephox.hermes.api.ImageAsset ephox.hermes.api.ImageExtract ephox.sugar.api.Attr ephox.sugar.api.Element global!console".split(" "),
function(a,d,c,b,e,f,g,k,m){var n=function(a){return b.bind(a,function(a){return e.cata(a,function(a,b,c,d){a=k.fromTag("img");g.set(a,"src",c);return[a]},function(a,b,c){m.log("Internal error: Paste operation produced an image URL instead of a Data URI: ",b);return[]})})};return{handle:function(e){e=b.filter(e,function(a){return"file"===a.kind&&/image/.test(a.type)});var g=b.map(e,function(a){return a.getAsFile()});return a.sync(function(b){f.toAssets(g,function(e){var f=n(e);a.call(b,{response:c.paste(f,
e),bundle:d.nu({})})})})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.api.HtmlPatterns",[],function(){return{validStyles:function(){return/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/},specialInline:function(){return/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.violin.StringMatch",[],function(){var a=function(a){return{fold:a,matches:function(c){return a(function(a){return 0===c.toLowerCase().indexOf(a.toLowerCase())},function(a){return a.test(c.toLowerCase())},function(a){return 0<=c.toLowerCase().indexOf(a.toLowerCase())},function(a){return c.toLowerCase()===a.toLowerCase()},function(){return!0},function(a){return!a.matches(c)})}}};return{starts:function(d){return a(function(a,
b,e,f,g,p){return a(d)})},pattern:function(d){return a(function(a,b,e,f,g,p){return b(d)})},contains:function(d){return a(function(a,b,e,f,g,p){return e(d)})},exact:function(d){return a(function(a,b,e,f,g,p){return f(d)})},all:function(){return a(function(a,c,b,e,f,g){return f()})},not:function(d){return a(function(a,b,e,f,g,p){return p(d)})},cata:function(a,c,b,e,f,g,p){return a.fold(c,b,e,f,g,p)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.api.RuleMatch",
["ephox.peanut.Fun","ephox.sugar.api.Node","ephox.violin.StringMatch"],function(a,d,c){return{keyval:function(b,d,f,g){var k=g.name,m=void 0!==g.condition?g.condition:a.constant(!0);g=void 0!==g.value?g.value:c.all();return k.matches(f)&&g.matches(d)&&m(b)},name:function(b,c){var f=d.name(b),g=c.name,k=void 0!==c.condition?c.condition:a.constant(!0);return g.matches(f)&&k(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.cleanup.AttributeAccess",
["ephox.compass.Arr","ephox.compass.Obj","ephox.peanut.Fun","ephox.sugar.api.Attr"],function(a,d,c,b){var e=function(c,e,k){a.each(e,function(a){b.remove(c,a)});d.each(k,function(a,d){b.set(c,d,a)})};return{filter:function(b,c){var d={};a.each(b.dom().attributes,function(a){c(a.value,a.name)||(d[a.name]=a.value)});return d},clobber:function(b,c,k){k=a.map(b.dom().attributes,function(a){return a.name});d.size(c)!==k.length&&e(b,k,c)},scan:c.constant({})}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.cleanup.StyleAccess",["ephox.compass.Arr","ephox.compass.Obj","ephox.sugar.api.Attr","ephox.sugar.api.Css","ephox.violin.Strings"],function(a,d,c,b,e){var f=function(b){var c={};b=void 0!==b&&null!==b?b.split(";"):[];a.each(b,function(a){a=a.split(":");2===a.length&&(c[e.trim(a[0])]=e.trim(a[1]))});return c},g=function(b){var c=d.keys(b);return a.map(c,function(a){return a+": "+b[a]}).join("; ")};return{filter:function(b,c){var d={};a.each(b.dom().style,
function(a){var e;e=b.dom().style.getPropertyValue(a);c(e,a)||(d[a]=e)});return d},clobber:function(a,e,f){c.set(a,"style","");var p=d.size(e),r=d.size(f);0===p&&0===r?c.remove(a,"style"):0===p?c.set(a,"style",g(f)):(d.each(e,function(c,d){b.set(a,d,c)}),e=c.get(a,"style"),f=0<r?g(f)+"; ":"",c.set(a,"style",f+e))},scan:function(b,c,d){b=b.dom().getAttribute("style");var e=f(b),g={};a.each(c,function(a){var b=e[a];void 0===b||d(b,a)||(g[a]=b)});return g}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.cleanup.Cleaners",["ephox.pastiche.cleanup.AttributeAccess","ephox.pastiche.cleanup.StyleAccess","ephox.peanut.Fun","ephox.sugar.api.Element"],function(a,d,c,b){var e=["mso-list"],f=function(a,b){var c=d.scan(a,e,b),f=d.filter(a,b);d.clobber(a,f,c)},g=function(b,c){var d=a.filter(b,c);a.clobber(b,d,{})};return{style:f,attribute:g,styleDom:function(a,c){f(b.fromDom(a),c)},attributeDom:function(a,c){g(b.fromDom(a),c)},validateStyles:function(a){var b=
d.filter(a,c.constant(!1));d.clobber(a,b,{})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Classes",["ephox.compass.Arr","ephox.sugar.api.Class","global!Array"],function(a,d,c){return{add:function(b,c){a.each(c,function(a){d.add(b,a)})},remove:function(b,c){a.each(c,function(a){d.remove(b,a)})},toggle:function(b,c){a.each(c,function(a){d.toggle(b,a)})},hasAll:function(b,c){return a.forall(c,function(a){return d.has(b,a)})},hasAny:function(b,
c){return a.exists(c,function(a){return d.has(b,a)})},get:function(a){a=a.dom().classList;for(var d=new c(a.length),f=0;f<a.length;f++)d[f]=a.item(f);return d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.Pipeless","ephox.compass.Arr ephox.highway.Merger ephox.pastiche.api.RuleMatch ephox.pastiche.cleanup.Cleaners ephox.peanut.Fun ephox.sugar.api.Attr ephox.sugar.api.Class ephox.sugar.api.Classes ephox.sugar.api.Remove ephox.sugar.api.SelectorFilter".split(" "),
function(a,d,c,b,e,f,g,k,m,n){var q=function(b,d,e){b(e,function(b,f){return a.exists(d,function(a){return c.keyval(e,b,f,a)})})};return{remover:function(r,h){var s=d.merge({styles:[],attributes:[],classes:[],tags:[]},h),l=n.descendants(r,"*");a.each(l,function(c){q(b.style,s.styles,c);q(b.attribute,s.attributes,c);a.each(s.classes,function(b){var d=f.has(c,"class")?k.get(c):[];a.each(d,function(a){b.name.matches(a)&&g.remove(c,a)})})});l=n.descendants(r,"*");a.each(l,function(b){a.exists(s.tags,
e.curry(c.name,b))&&m.remove(b)})},unwrapper:function(b,f){var g=d.merge({tags:[]},f),k=n.descendants(b,"*");a.each(k,function(b){a.exists(g.tags,e.curry(c.name,b))&&m.unwrap(b)})},transformer:function(b,f){var g=d.merge({tags:[]},f),k=n.descendants(b,"*");a.each(k,function(b){var d=a.find(g.tags,e.curry(c.name,b));void 0!==d&&null!==d&&d.mutate(b)})},validator:function(c){c=n.descendants(c,"*");a.each(c,function(a){b.validateStyles(a)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.engine.Token",["ephox.compass.Obj","ephox.sugar.api.Css","ephox.sugar.api.Element"],function(a,d,c){var b=function(a,b,e){var p,n,q,r=c.fromDom(a);switch(a.nodeType){case 1:b?p="endElement":(p="startElement",d.setAll(r,e||{}));n="HTML"!==a.scopeName&&a.scopeName&&a.tagName&&0>=a.tagName.indexOf(":")?(a.scopeName+":"+a.tagName).toUpperCase():a.tagName;break;case 3:p="text";q=a.nodeValue;break;case 8:p="comment";q=a.nodeValue;break;default:console.log("WARNING: Unsupported node type encountered: "+
a.nodeType)}return{getNode:function(){return a},tag:function(){return n},type:function(){return p},text:function(){return q}}},e=function(a,c){return b(c.createElement(a),!0)};return{START_ELEMENT_TYPE:"startElement",END_ELEMENT_TYPE:"endElement",TEXT_TYPE:"text",COMMENT_TYPE:"comment",FINISHED:e("HTML",window.document),token:b,createStartElement:function(c,d,e,m){var n=m.createElement(c);a.each(d,function(a,b){n.setAttribute(b,a)});return b(n,!1,e)},createEndElement:e,createComment:function(a,c){return b(c.createComment(a),
!1)},createText:function(a,c){return b(c.createTextNode(a))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.Serialiser",["ephox.pastiche.engine.Token"],function(a){return{create:function(d){var c=d.createDocumentFragment(),b=c;return{dom:b,receive:function(e){var f=function(a){a=a.getNode().cloneNode(!1);c.appendChild(a);c=a},g=function(a,b){var e=d.createTextNode(a.text());c.appendChild(e)};switch(e.type()){case a.START_ELEMENT_TYPE:f(e);
break;case a.TEXT_TYPE:g(e);break;case a.END_ELEMENT_TYPE:c=c.parentNode;null===c&&(c=b);break;case a.COMMENT_TYPE:break;default:throw{message:"Unsupported token type: "+e.type()};}},label:"SERIALISER"}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.Tokeniser",["ephox.pastiche.engine.Token"],function(a){return{tokenise:function(d,c){var b;c=c||window.document;b=c.createElement("div");c.body.appendChild(b);b.style.position=
"absolute";b.style.left="-10000px";b.innerHTML=d;nextNode=b.firstChild||a.FINISHED;var e=[];endNode=!1;return{hasNext:function(){return void 0!==nextNode},next:function(){var d=nextNode,g=endNode;!endNode&&nextNode.firstChild?(e.push(nextNode),nextNode=nextNode.firstChild):endNode||1!==nextNode.nodeType?nextNode.nextSibling?(nextNode=nextNode.nextSibling,endNode=!1):(nextNode=e.pop(),endNode=!0):endNode=!0;d===a.FINISHED||nextNode||(c.body.removeChild(b),nextNode=a.FINISHED);d=d===a.FINISHED?d:d?
a.token(d,g):void 0;return d}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.Pipeline",["ephox.pastiche.engine.Serialiser","ephox.pastiche.engine.Tokeniser"],function(a,d){var c=function(a,c,d){var g=d;for(d=c.length-1;0<=d;d--)g=c[d](g,{},a);return g};return{build:c,run:function(b,e,f){var g=a.create(b);e=d.tokenise(e,b);for(b=c(b,f,g);e.hasNext();)f=e.next(),b.receive(f);return g.dom}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.api.HybridAction","ephox.compass.Arr ephox.pastiche.engine.Pipeless ephox.pastiche.engine.Pipeline ephox.sugar.api.Element ephox.sugar.api.Html ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g){return{removal:function(a){return function(b){d.remover(b,a)}},unwrapper:function(a){return function(b){d.unwrapper(b,a)}},transformer:function(a){return function(b){d.transformer(b,a)}},validate:function(){return function(a){d.validator(a)}},
pipeline:function(a){return function(b){var d=e.get(b),p=g.owner(b),d=c.run(p.dom(),d,a);f.empty(b);b.dom().appendChild(d)}},isWordContent:function(a){return 0<=a.indexOf("<o:p>")||0<=a.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=a.indexOf("MsoListParagraphCxSpFirst")||0<=a.indexOf("<w:WordDocument>")},go:function(c,d,f){var g=b.fromTag("div",c.dom());g.dom().innerHTML=d;a.each(f,function(a){a(g)});return e.get(g)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.sugar.api.PredicateExists",["ephox.sugar.api.PredicateFind"],function(a){return{any:function(d){return a.first(d).isSome()},ancestor:function(d,c,b){return a.ancestor(d,c,b).isSome()},closest:function(d,c,b){return a.closest(d,c,b).isSome()},sibling:function(d,c){return a.sibling(d,c).isSome()},child:function(d,c){return a.child(d,c).isSome()},descendant:function(d,c){return a.descendant(d,c).isSome()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.api.RuleConditions",["ephox.compass.Arr","ephox.sugar.api.Attr","ephox.sugar.api.Html","ephox.sugar.api.Node","ephox.sugar.api.PredicateExists"],function(a,d,c,b,e){var f=function(a){var c=a.dom().attributes,c=void 0!==c&&null!==c&&0<c.length;return"span"===b.name(a)?c:!0},g=function(a){return void 0===a.dom().attributes||null===a.dom().attributes?!0:0===a.dom().attributes.length||1===a.dom().attributes.length&&"style"===a.dom().attributes[0].name};return{isNotImage:function(a){return"img"!==
b.name(a)},hasContent:function(c){return g(c)?f(c)&&e.descendant(c,function(c){var d=!g(c),e=!a.contains("font em strong samp acronym cite code dfn kbd tt b i u s sub sup ins del var span".split(" "),b.name(c));return b.isText(c)||d||e}):!0},isList:function(a){return"ol"===b.name(a)||"ul"===b.name(a)},isLocal:function(a){a=d.get(a,"src");return/^file:/.test(a)},hasNoAttributes:g,isEmpty:function(a){return 0===c.get(a).length}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.api.RuleMutations","ephox.compass.Arr ephox.compass.Obj ephox.sugar.api.Attr ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Html ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Node ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g,k,m,n,q){var r=function(b,c){var d=e.fromTag(b);g.before(c,d);var f=c.dom().attributes;a.each(f,function(a){d.dom().setAttribute(a.name,a.value)});f=q.children(c);k.append(d,
f);n.remove(c);return d};return{changeTag:r,addBrTag:function(a){0===f.get(a).length&&g.append(a,e.fromTag("br"))},properlyNest:function(c){q.parent(c).each(function(d){d=m.name(d);a.contains(["ol","ul"],d)&&(d=e.fromTag("li"),b.set(d,"list-style-type","none"),g.wrap(c,d))})},fontToSpan:function(a){var e=r("span",a),f={"font-size":{1:"8pt",2:"10pt",3:"12pt",4:"14pt",5:"18pt",6:"24pt",7:"36pt"}};d.each({face:"font-family",size:"font-size",color:"font-color"},function(a,d){if(c.has(e,d)){var g=c.get(e,
d);b.set(e,a,void 0!==f[a]&&void 0!==f[a][g]?f[a][g]:g);c.remove(e,d)}})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.Filter",["ephox.compass.Arr","ephox.pastiche.engine.Token"],function(a,d){return{createFilter:function(c,b,e){return function(f,g,k,m){var n,q,r,h=!1,s=function(){b&&b(z);h=!1;q=[];r=[]},l=function(b){a.each(b,function(a){f.receive(a)})},v=function(a){h?r.push(a):f.receive(a)},y=function(){w();l(r);s()},
w=function(){a.each(n||[],function(a){v(a)});x()},x=function(){n=[]},z={document:k||window.document,settings:g||{},emit:v,receive:function(a){b&&q.push(a);c(z,a);a===d.FINISHED&&y()},startTransaction:function(){h=!0},rollback:function(){l(q);s()},commit:y,defer:function(a){n=n||[];n.push(a)},hasDeferred:function(){return n&&0<n.length},emitDeferred:w,dropDeferred:x,label:e};s();return z}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.engine.TokenUtil",
"ephox.pastiche.cleanup.StyleAccess ephox.pastiche.engine.Token ephox.peanut.Fun ephox.sugar.api.Attr ephox.sugar.api.Css ephox.sugar.api.Element".split(" "),function(a,d,c,b,e,f){return{getAttribute:function(a,c){var d=f.fromDom(a.getNode());return b.get(d,c)},getStyle:function(a,b){var c=f.fromDom(a.getNode());return e.get(c,b)},isWhitespace:function(a){return a.type()===d.TEXT_TYPE&&/^[\s\u00A0]*$/.test(a.text())},getMsoList:function(b){b=f.fromDom(b.getNode());return a.scan(b,["mso-list"],c.constant(!1))["mso-list"]}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.detect.ListSymbols",["ephox.compass.Arr","ephox.highway.Merger"],function(a,d){var c=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"OL",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"OL",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:"OL",type:"lower-roman"}},
{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:"OL"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"OL",variant:"outline"}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"OL",type:"upper-alpha"}}],b={"\u2022":{tag:"UL",type:"disc"},"\u00b7":{tag:"UL",type:"disc"},"\u00a7":{tag:"UL",type:"square"}},e={o:{tag:"UL",type:"circle"},"-":{tag:"UL",type:"disc"},"\u25cf":{tag:"UL",type:"disc"},"\ufffd":{tag:"UL",type:"circle"}},f=function(a,b){return void 0!==a.variant?
a.variant:"("===b.charAt(0)?"()":")"===b.charAt(b.length-1)?")":"."},g=function(a){a=parseInt(a,10);return isNaN(a)?{}:{start:a}};return{match:function(k,m){var n=e[k]?[e[k]]:[],q=m&&b[k]?[b[k]]:m?[{tag:"UL",variant:k}]:[],r=a.bind(c,function(a){return a.regex.test(k)?[d.merge(a.type,g(k),{variant:f(a.type,k)})]:[]}),n=n.concat(q).concat(r);return a.map(n,function(a){return void 0!==a.variant?a:d.merge(a,{variant:k})})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.list.detect.ListGuess",["ephox.compass.Arr","ephox.pastiche.list.detect.ListSymbols","ephox.perhaps.Option","ephox.violin.Strings"],function(a,d,c,b){var e=function(a,b,c){return a===b||a&&b&&a.tag===b.tag&&a.type===b.type&&(c||a.variant===b.variant)};return{guess:function(f,g){var k=f?b.trim(f.text):"",k=d.match(k,f?!!f.symbolFont:!1),m=a.find(k,function(a){return"UL"===a.tag||g&&e(a,g,!0)});return void 0!==m?c.some(m):0<k.length?c.some(k[0]):c.none()},eqListType:e}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.detect.ListTypes",["ephox.compass.Arr","ephox.pastiche.engine.Token","ephox.pastiche.engine.TokenUtil","ephox.pastiche.list.detect.ListGuess","ephox.peanut.Fun"],function(a,d,c,b,e){var f=["P"];return{guess:function(d,e,m){return b.guess(d,e).fold(function(){return null},function(b){var d;if(d="OL"===b.tag)if(d=m)d=!a.contains(f,m.tag())||/^MsoHeading/.test(c.getAttribute(m,"class"));if(d)listType=null;else return b})},
eqListType:b.eqListType,checkFont:function(a,b){a.type()==d.START_ELEMENT_TYPE&&((font=c.getStyle(a,"font-family"))?b="Wingdings"===font||"Symbol"===font:/^(P|H[1-6]|DIV)$/.test(a.tag())&&(b=!1));return b}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Microsoft",["ephox.pastiche.engine.Token","ephox.pastiche.engine.TokenUtil"],function(a,d){return{isList:function(a,b){var e=d.getMsoList(b);return e&&"skip"!==e},isIgnore:function(c,
b){return b.type()==a.START_ELEMENT_TYPE&&"Ignore"===d.getMsoList(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Tags",["ephox.compass.Arr","ephox.pastiche.engine.Token","ephox.violin.Strings"],function(a,d,c){var b=function(a,b){return b.type()===d.START_ELEMENT_TYPE},e=function(a,b){return b.type()===d.END_ELEMENT_TYPE},f=function(a){return function(b,c){return c.tag()===a}};return{isStart:b,isEnd:e,isTag:f,isStartOf:function(a){return function(c,
d){return b(c,d)&&d.tag()===a}},isEndOf:function(a){return function(b,c){return e(b,c)&&c.tag()===a}},isStartAny:function(c){return function(d,e){return b(d,e)&&a.contains(c,e.tag())}},isEndAny:function(b){return function(b,c,d){return e(b,c)&&a.contains(d,c.tag())}},isWhitespace:function(a){return function(b,d){return f(a)(b,d)&&""===c.trim(d.getNode().textContent)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Paragraphs",
["ephox.pastiche.inspect.Microsoft","ephox.pastiche.inspect.Tags"],function(a,d){return{isNormal:function(c,b){return!c.skippedPara.get()&&d.isStart(c,b,"P")&&!a.isList(c,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Texts",["ephox.pastiche.engine.Token","ephox.pastiche.engine.TokenUtil","ephox.violin.Strings"],function(a,d,c){var b=function(b,c){return c.type()===a.TEXT_TYPE};return{isWhitespace:function(a,c){return b(a,
c)&&d.isWhitespace(c)},is:b,isBlank:function(a,d){return b(a,d)&&""===c.trim(d.text())},eq:function(a){return function(c,d){return b(c,d)&&d.text()===a}},matches:function(a){return function(c,d){return b(c,d)&&a.test(d.text())}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.Handler",["ephox.peanut.Fun"],function(a){return function(d,c,b){return{pred:d,action:c,label:a.constant(b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.Handlers",["ephox.compass.Arr","ephox.peanut.Fun","ephox.perhaps.Option"],function(a,d,c){var b=function(a,b){return function(a,c,d){return b(a,c,d)}};return function(e,f,g){var k=b(e+" :: FALLBACK --- ",g);g=function(g,n,q){c.from(a.find(f,function(a){return a.pred(n,q)})).fold(d.constant(k),function(a){var c=a.label();return void 0===c?a.action:b(e+" :: "+c,a.action)})(g,n,q)};g.toString=function(){return"Handlers for "+e};
return g}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.state.Transitions",[],function(){var a=function(a,b){if(void 0===a||void 0===b)throw console.trace(),"brick";a.nextFilter.set(b)},d=function(a,b,d){b.nextFilter.get()(a,b,d)};return{next:a,go:d,jump:function(c){return function(b,e,f){a(e,c);d(b,e,f)}},isNext:function(a,b){return a.nextFilter.get()===b},setNext:function(c){return function(b,d,f){a(d,c)}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.AfterListState",["ephox.pastiche.inspect.Paragraphs","ephox.pastiche.inspect.Texts","ephox.pastiche.list.stage.Handler","ephox.pastiche.list.stage.Handlers","ephox.pastiche.list.state.Transitions"],function(a,d,c,b,e){return{run:function(f,g){return b("AfterListState",[c(d.isBlank,function(a,b,c){a.defer(c)},"blank text"),c(a.isNormal,function(a,b,c){b.openedTag.set(c);a.defer(c);e.next(b,f)},"normal paragraph")],
function(a,b,c){g(a,b,c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.States",["ephox.pastiche.engine.Token"],function(a){return{isCloser:function(d,c){return c.type()===a.END_ELEMENT_TYPE&&d.originalToken.get()&&c.tag()===d.originalToken.get().tag()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.AfterNoBulletListState",["ephox.pastiche.inspect.States",
"ephox.pastiche.list.stage.Handler","ephox.pastiche.list.stage.Handlers","ephox.pastiche.list.state.Transitions"],function(a,d,c,b){return{run:function(e){return c("AfterNoBullet",[d(a.isCloser,function(a,c,d){b.next(c,e);c.styleLevelAdjust.set(-1);a.emit(d)}," closing open tag")],function(a,b,c){a.emit(c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Images",["ephox.pastiche.inspect.Tags"],function(a){var d=a.isEndOf("IMG");
return{isStart:a.isStartOf("IMG"),isEnd:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Markers",["ephox.pastiche.engine.Token"],function(a){var d=function(a,b){return"A"===b.tag()||"SPAN"===b.tag()||"STRONG"===b.tag()};return{isStart:function(c,b){return b.type()===a.START_ELEMENT_TYPE&&d(c,b)},isEnd:function(c,b){return b.type()===a.END_ELEMENT_TYPE&&d(c,b)},is:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.state.Spans",["ephox.pastiche.list.state.Transitions"],function(a){var d=function(a,c,d){c.spanCount.get().push(d)},c=function(a,c,d){c.spanCount.get().pop()};return{deferAndPush:function(a,c,f){a.defer(f);d(a,c,f)},deferAndPop:function(a,d,f){a.defer(f);c(a,d,f)},push:d,pop:c,pushThen:function(b){return function(c,f,g){d(c,f,g);a.next(f,b)}},popThen:function(b){return function(d,f,g){c(d,f,g);a.next(f,b)}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.BeforeSpacerState","ephox.pastiche.inspect.Images ephox.pastiche.inspect.Markers ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.peanut.Fun".split(" "),function(a,d,c,b,e,f){return{run:function(g,k,m){return b("BeforeSpacer",[c(d.isStart,e.pushThen(g),"start marker"),c(d.isEnd,e.popThen(k),"end marker"),c(a.isEnd,f.noop,"end image")],function(a,
b,c){m(a,c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Comments",["ephox.pastiche.engine.Token"],function(a){var d=function(c,b){return b.type()===a.COMMENT_TYPE};return{is:d,isNotEndIf:function(a,b){return d(a,b)&&"[endif]"!==b.text()},isEndIf:function(a,b){return d(a,b)&&"[endif]"===b.text()},isListSupport:function(a,b){return d(a,b)&&"[if !supportLists]"===b.text()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Logic",["ephox.compass.Arr"],function(a){return{any:function(d){return function(c,b){return a.exists(d,function(a){return a(c,b)})}},all:function(d){return function(c,b){return a.forall(d,function(a){return a(c,b)})}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.CloseSpansState","ephox.pastiche.inspect.Comments ephox.pastiche.inspect.Logic ephox.pastiche.inspect.Markers ephox.pastiche.inspect.Tags ephox.pastiche.inspect.Texts ephox.pastiche.list.detect.ListTypes ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions ephox.peanut.Fun ephox.perhaps.Option ephox.perhaps.Result".split(" "),
function(a,d,c,b,e,f,g,k,m,n,q,r,h){return{run:function(l,s){var v=function(a){var b=a.emitter.getCurrentListType(),b=a.emitter.getCurrentLevel()==a.itemLevel.get()?b:null;return r.from(f.guess(a.bulletInfo.get(),b,a.originalToken.get()))},y=function(a,b,c){b.emitter.openItem(b.itemLevel.get(),b.originalToken.get(),b.listType.get(),b.skippedPara.get());for(a.emitDeferred();0<b.spanCount.get().length;)a.emit(b.spanCount.get().shift())},w=function(a,b){n.next(a,l);if(a.commentMode.get()){var c=a.indentGuesser.guessIndentLevel(b,
a.originalToken.get(),a.styles,a.bulletInfo.get());a.itemLevel.set(c)}},x=function(a,b,c){return v(b).fold(function(){b.listType.set(null);return h.error("Unknown list type: "+b.bulletInfo.get().text+" Symbol font? "+b.bulletInfo.get().symbolFont)},function(a){b.listType.set(a);return h.value(y)})},z=function(a,b,c){w(b,c);x(a,b,c).fold(function(b){console.log(b);a.rollback()},function(d){d(a,b,c);a.emit(c)})},z=[g(d.any([e.is,b.isStart]),z,"text or start tag"),g(a.isNotEndIf,z,"non-endif comment"),
g(a.isEndIf,function(a,b,c){w(b,c);x(a,b,c).fold(function(b){console.log(b);a.rollback()},function(d){d(a,b,c)})},"endif comment"),g(c.isEnd,m.pop,"end marker"),g(b.isEnd,q.noop,"end tag")];return k("CloseSpans",z,function(a,b,c){s(a,c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.FindListTypeState","ephox.pastiche.inspect.Images ephox.pastiche.inspect.Markers ephox.pastiche.inspect.Texts ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions ephox.peanut.Fun".split(" "),
function(a,d,c,b,e,f,g,k){return{run:function(m,n){var q=function(a){return function(b,c,d){g.next(c,m);c.bulletInfo.set(a(c,d))}},r=q(function(a,b){return{text:b.text(),symbolFont:a.symbolFont.get()}}),q=q(function(a,b){return{text:"\u2202",symbolFont:!0}});return e("FindListType",[b(c.isWhitespace,k.noop,"text is whitespace"),b(c.is,r,"text"),b(d.isStart,f.push,"start marker"),b(d.isEnd,f.pop,"end marker"),b(a.isStart,q,"start image")],function(a,b,c){n(a,c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.ItemContentState",["ephox.pastiche.inspect.States","ephox.pastiche.list.stage.Handler","ephox.pastiche.list.stage.Handlers","ephox.pastiche.list.state.Transitions"],function(a,d,c,b){return{run:function(e){var f=[d(a.isCloser,function(a,c,d){b.next(c,e);c.skippedPara.set(!1)},"Closing open tag")];return c("ItemContentState",f,function(a,b,c){a.emit(c)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.list.state.CommentOff",["ephox.pastiche.inspect.Comments","ephox.pastiche.inspect.Texts"],function(a,d){return{isText:function(a,b){return!a.commentMode.get()&&d.is(a,b)},isComment:function(c,b){return!c.commentMode.get()&&a.is(c,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.state.CommentOn",["ephox.pastiche.engine.TokenUtil","ephox.pastiche.inspect.Comments","ephox.pastiche.inspect.Texts"],
function(a,d,c){return{isText:function(a,d){return a.commentMode.get()&&c.is(a,d)},isComment:function(a,c){return a.commentMode.get()&&d.is(a,c)},isUnstyled:function(b,c){var d=a.getAttribute(c,"style");return b.commentMode.get()&&""===d||null===d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.ListStartState","ephox.compass.Arr ephox.pastiche.inspect.Logic ephox.pastiche.inspect.Microsoft ephox.pastiche.inspect.Tags ephox.pastiche.inspect.Texts ephox.pastiche.list.detect.ListSymbols ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.CommentOff ephox.pastiche.list.state.CommentOn ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions ephox.peanut.Fun".split(" "),
function(a,d,c,b,e,f,g,k,m,n,q,r,h){return{run:function(l,s,v){var y=function(b,c,d){var e=c.originalToken.get(),f=c.spanCount.get();c.emitter.closeAllLists();b.emit(e);a.each(f,b.emit);b.emit(d);b.commit();c.originalToken.set(e);r.next(c,s)},w=function(a,b){return e.is(a,b)&&0<f.match(b.text(),a.symbolFont.get()).length},x=function(a,f,p){c.isIgnore(f,p)&&r.next(f,l);return k("ListStartState",[g(d.all([b.isStartOf("SPAN"),n.isUnstyled]),q.pushThen(l),"unstyled span"),g(b.isStartOf("SPAN"),q.push,
"starting span"),g(b.isStartOf("A"),q.push,"starting a"),g(b.isEndOf("A"),q.pop,"ending a"),g(n.isText,r.jump(l),"commentOn -> text"),g(w,r.jump(l),"mogran :: text is [1-9]."),g(e.is,y,"text"),g(m.isComment,h.noop,"commentOff -> comment"),g(b.isStartOf("IMG"),r.jump(l),"mogran :: start image tag")],function(a,b,c){v(a,c)})(a,f,p)};x.toString=function(){return"Handlers for ListStartState"};return x}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!navigator",
[],function(){return navigator});(function(a,h,l){a("ephox.pastiche.inspect.Browser",["ephox.pastiche.engine.Token","ephox.pastiche.inspect.Microsoft","global!document","global!navigator"],function(a,d,c,b){return{supportsCustomStyles:function(){if(0<b.userAgent.indexOf("Gecko")&&0>b.userAgent.indexOf("WebKit"))return!1;var e=c.createElement("div");try{e.innerHTML='<p style="mso-list: Ignore;">&nbsp;</p>'}catch(f){return!1}e=a.token(e.firstChild);return d.isIgnore({},e)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.detect.ImageList",[],function(){return{is:function(a,d,c){a=void 0!==d&&null!==d&&void 0!==d.getAttribute&&null!==d.getAttribute?d.getAttribute("alt"):"";return!!d&&"IMG"===d.tagName&&"*"===a}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.detect.TextList",["ephox.pastiche.list.detect.ListTypes","ephox.violin.Strings"],function(a,d){return{is:function(c,
b,e){var f=b.nodeValue;d.trim(f)||(f=(b=b.parentNode.nextSibling)?b.nodeValue:"");return b&&d.trim(b.parentNode.textContent)==f?(listType=a.guess({text:f,symbolFont:e},null,c.originalToken.get()))?!!b.nextSibling&&"SPAN"===b.nextSibling.tagName&&/^[\u00A0\s]/.test(b.nextSibling.firstChild.nodeValue)&&("P"===c.openedTag.get().tag()||"UL"===listType.tag):!1:!1}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.detect.ListDetect",
["ephox.highway.Merger","ephox.pastiche.inspect.Tags","ephox.pastiche.list.detect.ImageList","ephox.pastiche.list.detect.TextList"],function(a,d,c,b){var e=function(b){var c=b.node.style.fontFamily;return c?a.merge(b,{symbol:"Wingdings"===c||"Symbol"===c}):b},f=function(a){return!!a.firstChild&&("SPAN"===a.firstChild.tagName||"A"===a.firstChild.tagName)};return{isUnofficialList:function(a,p){var m;if(!d.isStartOf("SPAN")(a,p)||!a.openedTag.get())return!1;m=a.openedTag.get().getNode();for(var n=e({node:m}),
n=1<m.childNodes.length&&"A"===n.node.firstChild.tagName&&""===n.node.firstChild.textContent?{node:n.node.childNodes[1],symbol:n.symbol}:n;f(n.node);)n=e({node:n.node.firstChild,symbol:n.symbol});m=n.node.firstChild;return(m&&3===m.nodeType?b:c).is(a,m,n.symbol)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.inspect.Lists","ephox.pastiche.engine.TokenUtil ephox.pastiche.inspect.Browser ephox.pastiche.inspect.Comments ephox.pastiche.inspect.Microsoft ephox.pastiche.inspect.Tags ephox.pastiche.list.detect.ListDetect ephox.pastiche.list.detect.ListTypes ephox.perhaps.Option".split(" "),
function(a,d,c,b,e,f,g,k){var m=function(b){b=a.getMsoList(b);return(b=/ level([0-9]+)/.exec(b))&&b[1]?k.some(parseInt(b[1],10)):k.none()},n=function(a,c){return e.isStart(a,c)&&b.isList(a,c)&&"LI"!==c.tag()};return{getLevel:m,isStart:n,isValidStart:function(a,b){return n(a,b)&&m(b).isSome()},isInvalidStart:function(a,b){return n(a,b)&&m(b).isNone()},isSpecial:function(a,b){return!d.supportsCustomStyles()&&c.isListSupport(a,b)||f.isUnofficialList(a,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.NoListState","ephox.pastiche.inspect.Lists ephox.pastiche.inspect.Markers ephox.pastiche.inspect.Tags ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions".split(" "),function(a,d,c,b,e,f,g){return{run:function(k){var m=function(a,b,c){b.emitter.closeAllLists();a.emitDeferred();b.openedTag.set(null);a.emit(c);g.next(b,n)},n=e("NoListState",[b(a.isValidStart,
function(b,c,d){a.getLevel(d).each(function(a){c.itemLevel.set(a+c.styleLevelAdjust.get());(g.isNext(c,n)?b.emitDeferred:b.dropDeferred)();g.next(c,k());b.startTransaction();c.originalToken.set(d);c.commentMode.set(!1)})},"valid list so start it"),b(a.isInvalidStart,m,"invalid list so close lists"),b(a.isSpecial,function(a,b,d){c.isStartOf("SPAN")(b,d)&&f.push(a,b,d);g.next(b,k());a.startTransaction();b.originalToken.set(b.openedTag.get());b.commentMode.set(!0);b.openedTag.set(null);a.dropDeferred()},
"special list"),b(d.isEnd,f.deferAndPop,"closing marker"),b(d.isStart,f.deferAndPush,"starting marker"),b(c.isStart,function(a,b,c){b.openedTag.get()&&(b.emitter.closeAllLists(),a.emitDeferred());b.openedTag.set(c);a.defer(c)},"starting tag")],m);return n}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.SkipEmptyParaState","ephox.pastiche.inspect.Browser ephox.pastiche.inspect.Logic ephox.pastiche.inspect.Microsoft ephox.pastiche.inspect.Tags ephox.pastiche.inspect.Texts ephox.pastiche.list.detect.ListDetect ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions".split(" "),
function(a,d,c,b,e,f,g,k,m,n){return{run:function(q,r){return k("SkipEmptyPara",[g(d.all([function(a,c){return b.isStartOf("SPAN")(a,c)&&0===a.spanCount.get().length},function(b,d){return(a.supportsCustomStyles()||!f.isUnofficialList(b,d))&&!c.isList(b,d)}]),m.deferAndPush,"first marker or not list"),g(b.isEndOf("SPAN"),m.deferAndPop,"end span"),g(b.isEndOf("P"),function(a,b,c){a.defer(c);b.skippedPara.set(!0);b.openedTag.set(null);n.next(b,r())},"end p"),g(b.isEnd,n.jump(q),"end tag"),g(e.isWhitespace,
function(a,b,c){a.defer(c)},"whitespace")],n.jump(q))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.stage.SpacerState","ephox.pastiche.inspect.Markers ephox.pastiche.inspect.Tags ephox.pastiche.list.stage.Handler ephox.pastiche.list.stage.Handlers ephox.pastiche.list.state.Spans ephox.pastiche.list.state.Transitions ephox.peanut.Fun".split(" "),function(a,d,c,b,e,f,g){return{run:function(k){return b("Spacer",[c(a.isEnd,e.popThen(k),
"end marker"),c(d.isEnd,f.setNext(k),"end tag")],g.noop)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.Emission",["ephox.scullion.Struct"],function(a){var d=a.immutable("state","result"),c=a.immutable("state","value");return{state:a.immutable("level","type","types","items"),value:c,result:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.ItemStack",
["ephox.pastiche.list.emit.Emission","ephox.perhaps.Option"],function(a,d){return{start:function(c,b){var e=c.items().slice(0),f=void 0!==b&&"P"!==b?d.some(b):d.none();f.fold(function(){e.push("P")},function(a){e.push(a)});var g=a.state(c.level(),c.type(),c.types(),e);return a.value(g,f)},finish:function(c){var b=c.items().slice(0);if(0<b.length&&"P"!==b[b.length-1]){var e=b[b.length-1];b[b.length-1]="P";c=a.state(c.level(),c.type(),c.types(),b);return a.value(c,d.some(e))}return a.value(c,d.none())}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.ListLevels",["ephox.pastiche.list.emit.Emission"],function(a){var d=function(c,b,d){for(var f=[];b(c);){var g=d(c);c=g.state();f=f.concat(g.result())}return a.result(c,f)};return{moveRight:function(a,b,e){return d(a,function(a){return a.level()<b},e)},moveLeft:function(a,b,e){return d(a,function(a){return a.level()>b},e)},moveUntil:d}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.pastiche.list.emit.ListItemStyles",["ephox.pastiche.engine.TokenUtil"],function(a){return{from:function(d){var c={"list-style-type":"none"};d?(d=a.getStyle(d,"margin-left"),d=void 0!==d&&"0px"!==d?{"margin-left":d}:{}):d=c;return d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.SkippedTokens",["ephox.pastiche.engine.Token","ephox.peanut.Fun"],function(a,d){return{para:function(c){return[d.curry(a.createStartElement,
"P",{},{}),d.curry(a.createText,"\u00a0"),d.curry(a.createEndElement,"P")]}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.ListTokens","ephox.pastiche.cleanup.Cleaners ephox.pastiche.engine.Token ephox.pastiche.list.detect.ListTypes ephox.pastiche.list.emit.Emission ephox.pastiche.list.emit.ItemStack ephox.pastiche.list.emit.ListItemStyles ephox.pastiche.list.emit.SkippedTokens ephox.peanut.Fun".split(" "),function(a,
d,c,b,e,f,g,k){var m=function(a,c,e){var f=c.start&&1<c.start?{start:c.start}:{},g=a.level()+1,p=a.types().concat([c]);e=[k.curry(d.createStartElement,c.tag,f,e)];a=b.state(g,c,p,a.items());return b.result(a,e)},n=function(a){var c=a.types().slice(0),e=[k.curry(d.createEndElement,c.pop().tag)],f=a.level()-1;a=b.state(f,c[c.length-1],c,a.items());return b.result(a,e)},q=function(a,c,d){a=n(a);d=d?g.para():[];c=m(a.state(),c,c.type?{"list-style-type":c.type}:{});return b.result(c.state(),a.result().concat(d).concat(c.result()))};
return{open:m,openItem:function(g,m,n,h){var l=f.from(m);g=g.type()&&!c.eqListType(g.type(),n)?q(g,n,h):b.result(g,[]);l=[k.curry(d.createStartElement,"LI",{},l)];n=e.start(g.state(),m&&m.tag());h=n.value().map(function(b){a.styleDom(m.getNode(),k.constant(!0));return[k.constant(m)]}).getOr([]);return b.result(n.state(),g.result().concat(l).concat(h))},close:n,closeItem:function(a){var c=k.curry(d.createEndElement,"LI");a=e.finish(a);var f=a.value().fold(function(){return[c]},function(a){return[k.curry(d.createEndElement,
a),c]});return b.result(a.state(),f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.ListModel","ephox.compass.Arr ephox.pastiche.engine.Token ephox.pastiche.list.emit.Emission ephox.pastiche.list.emit.ItemStack ephox.pastiche.list.emit.ListLevels ephox.pastiche.list.emit.ListTokens ephox.peanut.Fun ephox.perhaps.Option".split(" "),function(a,d,c,b,e,f,g,k){var m=function(b){if(0===b.length)throw"Compose must have at least one element in the list";
var d=b[b.length-1];b=a.bind(b,function(a){return a.result()});return c.result(d.state(),b)},n=function(a){a=f.closeItem(a);var b=f.close(a.state());return m([a,b])},q=function(a,b,c,d){return e.moveRight(a,c,function(a){var e=a.level()===c-1&&b.type?{"list-style-type":b.type}:{};a=f.open(a,b,e);e=f.openItem(a.state(),a.state().level()==c?d:void 0,b);return m([a,e])})},h=function(a,b){return e.moveLeft(a,b,n)},l=function(a,e,f,p){var m=1<f?b.finish(a):c.value(a,k.none());a=m.value().map(function(a){return[g.curry(d.createEndElement,
a)]}).getOr([]);m.state().level();e=q(m.state(),e,f,p);return c.result(e.state(),a.concat(e.result()))};return{openItem:function(a,b,d,e,g){a=a.level()>b?h(a,b):c.result(a,[]);a.state().level()===b?(b=a.state(),b=0<b.level()?f.closeItem(b):c.result(b,[]),d=f.openItem(b.state(),d,e,g),d=m([b,d])):d=l(a.state(),e,b,d);return m([a,d])},closeAllLists:h}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.emit.Emitter",["ephox.compass.Arr",
"ephox.pastiche.list.emit.Emission","ephox.pastiche.list.emit.ListModel"],function(a,d,c){var b=["disc","circle","square"];return function(e,f){var g=d.state(0,void 0,[],[]),k=function(b){a.each(b.result(),function(a){a=a(f);e.emit(a)})};return{closeAllLists:function(){var a=c.closeAllLists(g,0);g=a.state();k(a);e.commit()},openItem:function(a,d,e,f){e&&("UL"===e.tag&&b[a-1]===e.type&&(e={tag:"UL"}),a=c.openItem(g,a,d,e,f),g=a.state(),k(a))},getCurrentListType:function(){return g.type()},getCurrentLevel:function(){return g.level()}}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.indent.ListIndent",["ephox.compass.Arr","ephox.pastiche.engine.TokenUtil","ephox.violin.Strings","global!Math"],function(a,d,c,b){var e=function(a){return a.ownerDocument.defaultView?a.ownerDocument.defaultView.getComputedStyle(a,null):a.currentStyle||{}},f=function(a){var b={};return function(c,d){var e,f=c+","+d;if(b.hasOwnProperty(f))return b[f];e=a.call(null,c,d);return b[f]=e}}(function(b,d){var f,n=/([^{]+){([^}]+)}/g,
q;for(n.lastIndex=0;null!==(f=n.exec(b))&&!q;)a.each(f[1].split(","),function(a){var b=a.indexOf(".");if(0<=b&&c.trim(a.substring(b+1))===d)return q=f[2],!1});return q?(n=document.createElement("p"),n.setAttribute("style",q),(n=e(n))?""+n.marginLeft:!1):!1});return{indentGuesser:function(){var a,c;return{guessIndentLevel:function(e,p,q,h){var l=1;if(h&&/^([0-9]+\.)+[0-9]+\.?$/.test(h.text))return h.text.replace(/([0-9]+|\.$)/g,"").length+1;q=c||parseInt(f(q,d.getAttribute(p,"class")));e=e.getNode();
p=p.getNode();h=0;for(e=e.parentNode;null!==e&&e!==p.parentNode;)h+=e.offsetLeft,e=e.offsetParent;p=h;q?a?p+=a:0===p&&(a=q,p+=q):q=48;c=q=b.min(p,q);return l=b.max(1,b.floor(p/q))||1}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.state.ListStyles",["ephox.pastiche.engine.Token"],function(a){return function(){var d=!1,c="";return{check:function(b){return d&&b.type()===a.TEXT_TYPE?(c+=b.text(),!0):b.type()===a.START_ELEMENT_TYPE&&
"STYLE"===b.tag()?d=!0:b.type()===a.END_ELEMENT_TYPE&&"STYLE"===b.tag()?(d=!1,!0):!1}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.list.state.ListState",["ephox.pastiche.list.emit.Emitter","ephox.pastiche.list.indent.ListIndent","ephox.pastiche.list.state.ListStyles","ephox.peanut.Fun","ephox.scullion.Cell"],function(a,d,c,b,e){var f=d.indentGuesser(),g=c(),k={getCurrentListType:function(){return m().getCurrentListType()},getCurrentLevel:function(){return m().getCurrentLevel()},
closeAllLists:function(){return m().closeAllLists.apply(void 0,arguments)},openItem:function(){return m().openItem.apply(void 0,arguments)}},m=function(){return{getCurrentListType:b.constant({}),getCurrentLevel:b.constant(1),closeAllLists:b.identity,openItem:b.identity}};return function(c){var d=e(c),h=e(0),l=e(null),s=e(!1),u=e(null),v=e(!1),y=e(null),w=e([]),x=e(!1),z=e(0),B=e(void 0),E=e([]);return{reset:function(e){d.set(c);h.set(0);l.set(null);s.set(!1);u.set(null);v.set(!1);y.set(null);w.set([]);
x.set(!1);z.set(0);B.set(void 0);E.set([]);_emitter=a(e,e.document);m=b.constant(_emitter)},nextFilter:d,itemLevel:h,originalToken:l,commentMode:s,openedTag:u,symbolFont:v,listType:y,spanCount:w,skippedPara:x,styleLevelAdjust:z,bulletInfo:B,logger:E,emitter:k,styles:g,indentGuesser:f}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.pastiche.filter.Lists","ephox.pastiche.engine.Filter ephox.pastiche.list.detect.ListTypes ephox.pastiche.list.stage.AfterListState ephox.pastiche.list.stage.AfterNoBulletListState ephox.pastiche.list.stage.BeforeSpacerState ephox.pastiche.list.stage.CloseSpansState ephox.pastiche.list.stage.FindListTypeState ephox.pastiche.list.stage.ItemContentState ephox.pastiche.list.stage.ListStartState ephox.pastiche.list.stage.NoListState ephox.pastiche.list.stage.SkipEmptyParaState ephox.pastiche.list.stage.SpacerState ephox.pastiche.list.state.ListState ephox.pastiche.list.state.Transitions".split(" "),
function(a,d,c,b,e,f,g,k,m,n,h,l,s,t){var u=function(a,b){var c="Type: "+b.type()+", Tag: "+b.tag()+" Text: "+b.text();console.log("Unexpected token in list conversion: "+c,w.nextFilter.get());a.rollback()};n=n.run(function(){return y});h=h.run(n,function(){return v});var v=c.run(h,n);c=k.run(v);f=f.run(c,u);l=l.run(f);e=e.run(l,f,u);g=g.run(e,u);b=b.run(v);var y=m.run(g,b,u),w=s(n);return a.createFilter(function(a,b){w.styles&&w.styles.check(b)||(w.symbolFont.set(d.checkFont(b,w.symbolFont.get())),
t.go(a,w,b))},w.reset,"lists")})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.process.Strategies","ephox.pastiche.api.HtmlPatterns ephox.pastiche.api.HybridAction ephox.pastiche.api.RuleConditions ephox.pastiche.api.RuleMutations ephox.pastiche.filter.Lists ephox.peanut.Fun ephox.sugar.api.Class ephox.sugar.api.Css ephox.violin.StringMatch".split(" "),function(a,d,c,b,e,f,g,k,m){var n=d.unwrapper({tags:[{name:m.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i)}]});
e=d.pipeline([e]);var h=d.removal({attributes:[{name:m.pattern(/^v:/)},{name:m.exact("href"),value:m.contains("#_toc")},{name:m.exact("href"),value:m.contains("#_mso")},{name:m.pattern(/^xmlns(:|$)/)},{name:m.exact("type"),condition:c.isList}]}),l=d.removal({tags:[{name:m.exact("script")},{name:m.exact("meta")},{name:m.exact("link")},{name:m.exact("style"),condition:c.isEmpty}],attributes:[{name:m.starts("on")},{name:m.exact('"')},{name:m.exact("id")},{name:m.exact("name")},{name:m.exact("lang")},
{name:m.exact("language")}],styles:[{name:m.all(),value:m.pattern(/OLE_LINK/i)}]}),s=d.removal({styles:[{name:m.not(m.pattern(/width|height|list-style-type/)),condition:function(a){return!g.has(a,"ephox-limbo-transform")}},{name:m.pattern(/width|height/),condition:c.isNotImage}]}),t=d.removal({classes:[{name:m.not(m.exact("rtf-data-image"))}]}),u=d.removal({styles:[{name:m.pattern(a.validStyles())}]}),v=d.removal({classes:[{name:m.pattern(/mso/i)}]}),y=d.unwrapper({tags:[{name:m.exact("img"),condition:c.isLocal},
{name:m.exact("a"),condition:c.hasNoAttributes}]}),w=d.unwrapper({tags:[{name:m.exact("a"),condition:c.hasNoAttributes}]}),x=d.removal({attributes:[{name:m.exact("style"),value:m.exact(""),debug:!0}]}),z=d.removal({attributes:[{name:m.exact("class"),value:m.exact(""),debug:!0}]});a=d.unwrapper({tags:[{name:m.pattern(a.specialInline()),condition:f.not(c.hasContent)}]});c=d.transformer({tags:[{name:m.exact("p"),mutate:b.addBrTag}]});var B=d.transformer({tags:[{name:m.pattern(/ol|ul/),mutate:b.properlyNest}]}),
E=d.transformer({tags:[{name:m.exact("b"),mutate:f.curry(b.changeTag,"strong")},{name:m.exact("i"),mutate:f.curry(b.changeTag,"em")},{name:m.exact("u"),mutate:function(a){a=b.changeTag("span",a);g.add(a,"ephox-limbo-transform");k.set(a,"text-decoration","underline")}},{name:m.exact("s"),mutate:f.curry(b.changeTag,"strike")},{name:m.exact("font"),mutate:b.fontToSpan,debug:!0}]}),H=d.removal({classes:[{name:m.exact("ephox-limbo-transform")}]});d=d.removal({attributes:[{name:m.exact("href"),value:m.starts("file:///"),
debug:!0}]});return{unwrapWordTags:n,removeWordAttributes:h,parseLists:e,removeExcess:l,cleanStyles:s,cleanClasses:t,mergeStyles:u,mergeClasses:v,removeLocalImages:y,removeVacantLinks:w,removeEmptyStyle:x,removeEmptyClass:z,pruneInlineTags:a,addPlaceholders:c,nestedListFixes:B,inlineTagFixes:E,cleanupFlags:H,removeLocalLinks:d,none:f.noop}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.process.PasteFilters","ephox.compass.Arr ephox.limbo.api.RtfImage ephox.limbo.process.Strategies ephox.pastiche.api.HybridAction ephox.pastiche.engine.Filter ephox.pastiche.engine.Token ephox.sugar.api.Element".split(" "),
function(a,d,c,b,e,f,g){var k=function(a){return a.browser.isIE()&&11<=a.browser.version.major},m=function(a){return e.createFilter(function(b,c){var d=a(g.fromDom(c.getNode())).fold(function(){return c},function(a){a=a.dom();return f.token(a,c.type()===f.END_ELEMENT_TYPE,{})});b.emit(d)})},n=function(a,b,d){a=[c.mergeStyles,c.mergeClasses];d=[c.cleanStyles,c.cleanClasses];return b?a:d},h=function(a,b,d){if(!a)return c.none;a=[c.unwrapWordTags];d=k(d)?[]:c.parseLists;return a.concat(d).concat([c.removeWordAttributes])};
return{derive:function(e,f,g){var l,s;s=g.browser.isFirefox()?d.local:d.vshape;l=k(g)?c.none:b.pipeline([m(s)]);l=[e?l:c.none];s=[s===d.local?c.none:c.removeLocalImages];return a.flatten([l,[c.inlineTagFixes],h(e,f,g),[c.nestedListFixes],[c.removeExcess],s,n(e,f,g),[c.removeLocalLinks,c.removeVacantLinks],[c.removeEmptyStyle],[c.removeEmptyClass],[c.pruneInlineTags],[c.addPlaceholders],[c.cleanupFlags]])}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,
h,l){a("ephox.boss.common.TagBoundaries",[],function(){return"body p div article aside figcaption figure footer header nav section ol ul li table thead tbody tfoot caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" ")})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Text",["ephox.sugar.api.Node","ephox.sugar.impl.NodeValue"],function(a,d){var c=d(a.isText,"text");return{get:function(a){return c.get(a)},getOption:function(a){return c.getOption(a)},
set:function(a,d){c.set(a,d)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.boss.api.DomUniverse","ephox.boss.common.TagBoundaries ephox.compass.Arr ephox.peanut.Fun ephox.sugar.api.Attr ephox.sugar.api.Compare ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Node ephox.sugar.api.PredicateFilter ephox.sugar.api.PredicateFind ephox.sugar.api.Remove ephox.sugar.api.SelectorFilter ephox.sugar.api.SelectorFind ephox.sugar.api.Text ephox.sugar.api.Traverse".split(" "),
function(a,d,c,b,e,f,g,k,m,n,h,l,s,t,u,v,y){return function(){return{up:c.constant({selector:u.ancestor,closest:u.closest,predicate:l.ancestor,all:y.parents}),down:c.constant({selector:t.descendants,predicate:h.descendants}),styles:c.constant({get:f.get,set:f.set,remove:f.remove}),attrs:c.constant({get:b.get,set:b.set,remove:b.remove,copyTo:function(a,c){var d=b.clone(a);b.setAll(c,d)}}),insert:c.constant({before:k.before,after:k.after,afterAll:m.after,append:k.append,appendAll:m.append,prepend:k.prepend,
wrap:k.wrap}),remove:c.constant({unwrap:s.unwrap,remove:s.remove}),create:c.constant({nu:g.fromTag,clone:function(a){return g.fromDom(a.dom().cloneNode(!1))},text:g.fromText}),query:c.constant({comparePosition:function(a,b){return a.dom().compareDocumentPosition(b.dom())},prevSibling:y.prevSibling,nextSibling:y.nextSibling}),property:c.constant({children:y.children,name:n.name,parent:y.parent,isText:n.isText,isElement:n.isElement,getText:v.get,setText:v.set,isBoundary:function(b){return n.isElement(b)?
"body"===n.name(b)?!0:d.contains(a,n.name(b)):!1},isEmptyTag:function(a){return n.isElement(a)?d.contains(["br","img","hr"],n.name(a)):!1}}),eq:e.eq,is:e.is}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.data.NamedPattern",["ephox.scullion.Struct"],function(a){return a.immutable("word","pattern")})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.data.Spot",
["ephox.scullion.Struct"],function(a){var d=a.immutable("element","offset"),c=a.immutable("element","deltaOffset"),b=a.immutable("element","start","finish"),e=a.immutable("begin","end");a=a.immutable("element","text");return{point:d,delta:c,range:b,points:e,text:a}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.extract.TypedItem",["ephox.peanut.Fun","ephox.perhaps.Option"],function(a,d){var c=a.constant(!1),b=a.constant(!0),e=function(e){return{isBoundary:function(){return e(b,
c,c)},fold:e,toText:function(){return e(d.none,d.none,function(a,b){return d.some(a)})},is:function(a){return e(c,c,function(b,c){return c.eq(b,a)})},len:function(){return e(a.constant(0),a.constant(1),function(a,b){return b.property().getText(a).length})}}};return{text:function(a,b){return e(function(c,d,e){return e(a,b)})},boundary:function(a,b){return e(function(c,d,e){return c(a,b)})},empty:function(a,b){return e(function(c,d,e){return d(a,b)})},cata:function(a,b,c,d){return a.fold(b,c,d)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.array.Boundaries",["ephox.compass.Arr","ephox.peanut.Fun"],function(a,d){return{boundAt:function(c,b,e,f){b=a.findIndex(c,d.curry(f,b));b=-1<b?b:0;e=a.findIndex(c,d.curry(f,e));return c.slice(b,-1<e?e+1:c.length)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.array.Slice",["ephox.compass.Arr"],function(a){return{sliceby:function(d,c){var b=a.findIndex(d,
c);return d.slice(0,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.Splitting",["ephox.scullion.ADT"],function(a){a=a.generate([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}]);return{include:a.include,excludeWith:a.excludeWith,excludeWithout:a.excludeWithout,cata:function(a,c,b,e){return a.fold(c,b,e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.array.Split",
["ephox.compass.Arr","ephox.polaris.api.Splitting"],function(a,d){var c=function(b,c){var f=[],g=[];a.each(b,function(a){var b=c(a);d.cata(b,function(){g.push(a)},function(){0<g.length&&f.push(g);f.push([a]);g=[]},function(){0<g.length&&f.push(g);g=[]})});0<g.length&&f.push(g);return f};return{splitby:function(a,e){return c(a,function(a){return e(a)?d.excludeWithout(a):d.include(a)})},splitbyAdv:c}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.Arrays",
["ephox.polaris.array.Boundaries","ephox.polaris.array.Slice","ephox.polaris.array.Split"],function(a,d,c){return{splitby:function(a,d){return c.splitby(a,d)},splitbyAdv:function(a,d){return c.splitbyAdv(a,d)},sliceby:function(a,c){return d.sliceby(a,c)},boundAt:function(b,c,d,g){return a.boundAt(b,c,d,g)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.extract.TypedList",["ephox.compass.Arr","ephox.peanut.Fun","ephox.perhaps.Option",
"ephox.phoenix.api.data.Spot","ephox.polaris.api.Arrays"],function(a,d,c,b,e){return{count:function(b){return a.foldr(b,function(a,b){return b.len()+a},0)},dropUntil:function(a,b){return e.sliceby(a,function(a){return a.is(b)})},gen:function(a,d){return a.fold(c.none,function(a){return c.some(b.range(a,d,d+1))},function(e){return c.some(b.range(e,d,d+a.len()))})},justText:function(b){return a.bind(b,function(a){return a.fold(d.constant([]),d.constant([]),d.identity)})}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.extract.Extract",["ephox.compass.Arr","ephox.phoenix.api.data.Spot","ephox.phoenix.extract.TypedItem","ephox.phoenix.extract.TypedList"],function(a,d,c,b){var e=function(b,d,f){if(b.property().isText(d))return[c.text(d,b)];if(b.property().isEmptyTag(d))return[c.empty(d,b)];if(b.property().isElement(d)){var n=b.property().children(d),h=b.property().isBoundary(d)?[c.boundary(d,b)]:[];d=void 0!==f&&f(d)?[]:a.bind(n,
function(a){return e(b,a,f)});return h.concat(d).concat(h)}return[]},f=function(a,c,f,p,h){a=e(a,p,h);c=b.dropUntil(a,c);c=b.count(c);return d.point(p,c+f)};return{typed:e,items:function(b,c,d){b=e(b,c,d);var f=function(a,b){return a};return a.map(b,function(a){return a.fold(f,f,f)})},extractTo:function(a,b,c,e,p){return a.up().predicate(b,e).fold(function(){return d.point(b,c)},function(d){return f(a,b,c,d,p)})},extract:function(a,b,c,e){return a.property().parent(b).fold(function(){return d.point(b,
c)},function(d){return f(a,b,c,d,e)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.extract.ExtractText",["ephox.compass.Arr","ephox.peanut.Fun","ephox.phoenix.extract.Extract"],function(a,d,c){var b=function(a,b){return"img"===b.property().name(a)?" ":"\n"};return{from:function(e,f,g){f=c.typed(e,f,g);return a.map(f,function(a){return a.fold(d.constant("\n"),b,e.property().getText)}).join("")}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.parray.Generator",["ephox.compass.Arr","ephox.peanut.Fun"],function(a,d){return{make:function(c,b,e){return a.foldl(c,function(a,c){return b(c,a.len).fold(d.constant(a),function(b){return{len:b.finish(),list:a.list.concat([b])}})},{len:void 0!==e?e:0,list:[]}).list}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.parray.Query",["ephox.compass.Arr","ephox.perhaps.Option"],
function(a,d){var c=function(a,b){return b>=a.start()&&b<=a.finish()},b=function(b,c){return a.findIndex(b,function(a){return a.start()===c})};return{get:function(b,f){var g=a.find(b,function(a){return c(a,f)});return d.from(g)},find:function(b,c){return d.from(a.find(b,c))},inUnit:c,sublist:function(a,c,d){c=b(a,c);var p=b(a,d);d=-1<p?p:a[a.length-1]&&a[a.length-1].finish()===d?a.length+1:-1;return-1<c&&-1<d?a.slice(c,d):[]}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.polaris.parray.Translate",["ephox.compass.Arr","ephox.highway.Merger","ephox.peanut.Fun"],function(a,d,c){return{translate:function(b,e){return a.map(b,function(a){return d.merge(a,{start:c.constant(a.start()+e),finish:c.constant(a.finish()+e)})})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.parray.Split",["ephox.compass.Arr","ephox.polaris.parray.Query","ephox.polaris.parray.Translate"],function(a,d,
c){var b=function(a,b,d){b=d(a,b);return c.translate(b,a.start())};return{splits:function(c,f,g){return 0===f.length?c:a.bind(c,function(c){var e=a.bind(f,function(a){return d.inUnit(c,a)?[a-c.start()]:[]});return 0<e.length?b(c,e,g):[c]})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.PositionArray",["ephox.polaris.parray.Generator","ephox.polaris.parray.Query","ephox.polaris.parray.Split","ephox.polaris.parray.Translate"],
function(a,d,c,b){return{generate:function(b,c,d){return a.make(b,c,d)},get:function(a,b){return d.get(a,b)},find:function(a,b){return d.find(a,b)},splits:function(a,b,d){return c.splits(a,b,d)},translate:function(a,c){return b.translate(a,c)},sublist:function(a,b,c){return d.sublist(a,b,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.extract.Find",["ephox.phoenix.api.data.Spot","ephox.phoenix.extract.Extract","ephox.phoenix.extract.TypedList",
"ephox.polaris.api.PositionArray"],function(a,d,c,b){return{find:function(e,f,g,k){e=d.typed(e,f,k);e=b.generate(e,c.gen);return b.get(e,g).map(function(b){return a.point(b.element(),g-b.start())})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.general.Extract",["ephox.phoenix.extract.Extract","ephox.phoenix.extract.ExtractText","ephox.phoenix.extract.Find"],function(a,d,c){return{extract:function(b,c,d,g){return a.extract(b,
c,d,g)},extractTo:function(b,c,d,g,k){return a.extractTo(b,c,d,g,k)},all:function(b,c,d){return a.items(b,c,d)},from:function(b,c,d){return a.typed(b,c,d)},find:function(a,d,f,g){return c.find(a,d,f,g)},toText:function(a,c,f){return d.from(a,c,f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.family.Group",["ephox.compass.Arr","ephox.phoenix.api.general.Extract","ephox.phoenix.extract.TypedItem","ephox.polaris.api.Arrays","ephox.polaris.api.Splitting"],
function(a,d,c,b,e){return{group:function(f,g,k){g=a.bind(g,function(a){return d.from(f,a,k)});g=b.splitbyAdv(g,function(a){return c.cata(a,function(){return e.excludeWithout(a)},function(){return e.excludeWith(a)},function(){return e.include(a)})});return a.filter(g,function(a){return 0<a.length})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.family.Parents",["ephox.compass.Arr","ephox.perhaps.Option"],function(a,d){return{common:function(c,
b,e){b=[b].concat(c.up().all(b));var f=[e].concat(c.up().all(e));e=a.find(b,function(b){return a.exists(f,function(a){return c.eq(a,b)})});return d.from(e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.wrap.OrphanText",["ephox.compass.Arr"],function(a){var d="table tbody thead tfoot tr ul ol".split(" ");return function(c){var b=c.property(),e=function(c,d){return b.parent(c).map(b.name).map(function(b){return!a.contains(d,b)}).getOr(!1)};
return{validateText:function(a){return b.isText(a)&&e(a,d)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.family.Range",["ephox.compass.Arr","ephox.peanut.Fun","ephox.phoenix.api.general.Extract","ephox.phoenix.family.Parents","ephox.phoenix.wrap.OrphanText"],function(a,d,c,b,e){return{range:function(f,g,k,m,n){return f.eq(g,m)?[g]:b.common(f,g,m).fold(function(){return[]},function(b){b=[b].concat(c.all(f,b,d.constant(!1)));var h=
a.findIndex(b,d.curry(f.eq,g)),l=a.findIndex(b,d.curry(f.eq,m));b=-1<h&&-1<l?h<l?b.slice(h+k,l+n):b.slice(l+n,h+k):[];h=e(f);return a.filter(b,h.validateText)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.general.Family",["ephox.phoenix.family.Group","ephox.phoenix.family.Range"],function(a,d){return{range:function(a,b,e,f,g){return d.range(a,b,e,f,g)},group:function(c,b,d){return a.group(c,b,d)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.string.Sanitise",[],function(){return{css:function(a){var d=/^[a-zA-Z]/.test(a)?"":"e";a=a.replace(/[^\w]/gi,"-");return d+a}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.string.Split",["ephox.compass.Arr"],function(a){return{splits:function(d,c){if(0===c.length)return[d];var b=a.foldl(c,function(a,b){if(0===b)return a;var c=d.substring(a.prev,
b);return{prev:b,values:a.values.concat([c])}},{prev:0,values:[]}),e=c[c.length-1];return e<d.length?b.values.concat(d.substring(e)):b.values}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.Strings",["ephox.polaris.string.Sanitise","ephox.polaris.string.Split"],function(a,d){return{cssSanitise:function(c){return a.css(c)},splits:function(a,b){return d.splits(a,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.phoenix.search.Splitter",["ephox.compass.Arr","ephox.perhaps.Option","ephox.phoenix.api.data.Spot","ephox.polaris.api.PositionArray","ephox.polaris.api.Strings"],function(a,d,c,b,e){return{subdivide:function(f,g,k){var m=f.property().getText(g);k=a.filter(e.splits(m,k),function(a){return 0<a.length});if(1>=k.length)return[c.range(g,0,m.length)];f.property().setText(g,k[0]);var m=b.generate(k.slice(1),function(a,b){var e=f.create().text(a),e=c.range(e,b,b+a.length);return d.some(e)},
k[0].length),n=a.map(m,function(a){return a.element()});f.insert().afterAll(g,n);return[c.range(g,0,k[0].length)].concat(m)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.search.MatchSplitter",["ephox.compass.Arr","ephox.peanut.Fun","ephox.phoenix.search.Splitter","ephox.polaris.api.PositionArray"],function(a,d,c,b){return{separate:function(e,f,g){var k=a.bind(g,function(a){return[a.start(),a.finish()]}),m=b.splits(f,k,function(a,
b){return c.subdivide(e,a.element(),b)});return a.map(g,function(c){var f=b.sublist(m,c.start(),c.finish()),f=a.map(f,function(a){return a.element()}),g=a.map(f,e.property().getText).join("");return{elements:d.constant(f),word:c.word,exact:d.constant(g)}})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.bud.Unicode",[],function(){return{zeroWidth:function(){return"\u200b"},trimNative:function(a){return a.replace(/\u200B/,"").trim()},trimWithRegex:function(a){return a.replace(/^\s+|\s+$/g,
"").replace(/\u200B/,"")}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.pattern.Chars",["ephox.bud.Unicode","ephox.peanut.Fun"],function(a,d){var c="\\w'\\-\\u00C0-\\u00FF"+a.zeroWidth()+"\\u2018\\u2019",b="[^"+c+"]",e="["+c+"]";return{chars:d.constant(c),wordbreak:d.constant(b),wordchar:d.constant(e)}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.pattern.Custom",
["global!RegExp"],function(a){return function(d,c,b,e){return{term:function(){return new a(d,e.getOr("g"))},prefix:c,suffix:b}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.pattern.Unsafe",["ephox.peanut.Fun","ephox.perhaps.Option","ephox.polaris.pattern.Chars","ephox.polaris.pattern.Custom"],function(a,d,c,b){return{token:function(c){return b(c,a.constant(0),a.constant(0),d.none())},word:function(a){a="((?:^'?)|(?:"+c.wordbreak()+
"+'?))"+a+"((?:'?$)|(?:'?"+c.wordbreak()+"+))";return b(a,function(a){return 1<a.length?a[1].length:0},function(a){return 2<a.length?a[2].length:0},d.none())}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.pattern.Safe",["ephox.polaris.pattern.Unsafe"],function(a){var d=function(a){return a.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")};return{sanitise:d,word:function(c){c=d(c);return a.word(c)},token:function(c){c=d(c);return a.token(c)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.Pattern",["ephox.polaris.pattern.Chars","ephox.polaris.pattern.Custom","ephox.polaris.pattern.Safe","ephox.polaris.pattern.Unsafe"],function(a,d,c,b){return{safeword:function(a){return c.word(a)},safetoken:function(a){return c.token(a)},custom:function(a,b,c,k){return d(a,b,c,k)},unsafeword:function(a){return b.word(a)},unsafetoken:function(a){return b.token(a)},sanitise:function(a){return c.sanitise(a)},chars:function(){return a.chars()},
wordbreak:function(){return a.wordbreak()},wordchar:function(){return a.wordchar()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.search.Find",["ephox.peanut.Fun"],function(a){return{all:function(d,c){for(var b=c.term(),e=[],f=b.exec(d);f;){var g=f.index+c.prefix(f),f=f[0].length-c.prefix(f)-c.suffix(f);e.push({start:a.constant(g),finish:a.constant(g+f)});b.lastIndex=g+f;f=b.exec(d)}return e}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.search.Sleuth",["ephox.compass.Arr","ephox.highway.Merger","ephox.polaris.search.Find","global!Array"],function(a,d,c,b){var e=function(a){a=b.prototype.slice.call(a,0);a.sort(function(a,b){return a.start()<b.start()?-1:b.start()<a.start()?1:0});return a};return{search:function(b,g){var k=a.bind(g,function(e){var g=c.all(b,e.pattern());return a.map(g,function(a){return d.merge(e,{start:a.start,finish:a.finish})})});return e(k)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.polaris.api.Search",["ephox.polaris.search.Find","ephox.polaris.search.Sleuth"],function(a,d){return{findall:function(c,b){return a.all(c,b)},findmany:function(a,b){return d.search(a,b)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.search.Searcher","ephox.compass.Arr ephox.perhaps.Option ephox.phoenix.api.data.NamedPattern ephox.phoenix.api.data.Spot ephox.phoenix.api.general.Family ephox.phoenix.extract.TypedList ephox.phoenix.search.MatchSplitter ephox.polaris.api.Pattern ephox.polaris.api.PositionArray ephox.polaris.api.Search".split(" "),
function(a,d,c,b,e,f,g,k,m,n){var h=function(a,c){return m.generate(c,function(c,e){var f=e+a.property().getText(c).length;return d.from(b.range(c,e,f))})},l=function(b,c,d,k){c=e.group(b,c,k);return a.bind(c,function(c){c=f.justText(c);var e=a.map(c,b.property().getText).join(""),e=n.findmany(e,d);c=h(b,c);return g.separate(b,c,e)})};return{safeWords:function(b,d,e,f){e=a.map(e,function(a){var b=k.safeword(a);return c(a,b)});return l(b,d,e,f)},safeToken:function(a,b,d,e){d=c(d,k.safetoken(d));return l(a,
b,[d],e)},run:l}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.general.Search",["ephox.phoenix.search.Searcher"],function(a){return{safeWords:function(d,c,b,e){return a.safeWords(d,c,b,e)},safeToken:function(d,c,b,e){return a.safeToken(d,c,b,e)},run:function(d,c,b,e){return a.run(d,c,b,e)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.phoenix.api.dom.DomSearch",["ephox.boss.api.DomUniverse",
"ephox.phoenix.api.general.Search"],function(a,d){var c=a();return{safeWords:function(a,e,f){return d.safeWords(c,a,e,f)},safeToken:function(a,e,f){return d.safeToken(c,a,e,f)},run:function(a,e,f){return d.run(c,a,e,f)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.SelectorExists",["ephox.sugar.api.SelectorFind"],function(a){return{any:function(d){return a.first(d).isSome()},ancestor:function(d,c,b){return a.ancestor(d,c,b).isSome()},
sibling:function(d,c){return a.sibling(d,c).isSome()},child:function(d,c){return a.child(d,c).isSome()},descendant:function(d,c){return a.descendant(d,c).isSome()},closest:function(d,c,b){return a.closest(d,c,b).isSome()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.process.Preprocessor","ephox.compass.Arr ephox.perhaps.Option ephox.phoenix.api.dom.DomSearch ephox.polaris.api.Pattern ephox.scullion.Struct ephox.sugar.api.Attr ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Html ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Node ephox.sugar.api.SelectorExists".split(" "),
function(a,d,c,b,e,f,g,k,m,n,h,l,s){var t=function(a){var d=e.immutable("word","pattern"),f=b.unsafetoken("((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)(:[0-9]+)?((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)"),d=d("__INTERNAL__",f);return c.run(a,[d])},u=function(a){return!s.closest(a,"a")},v=function(a){return d.from(a[0]).filter(u).map(function(b){var c=k.fromTag("a");n.before(b,
c);h.append(c,a);f.set(c,"href",m.get(c));return c})};return{links:function(b){b=t(b);a.each(b,function(a){0>a.exact().indexOf("@")&&v(a.elements())})},position:function(b){a.each(b,function(a){l.isElement(a)&&g.remove(a,"position")})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.api.RunPaste","ephox.compass.Arr ephox.limbo.process.PasteFilters ephox.limbo.process.Preprocessor ephox.pastiche.api.HybridAction ephox.sugar.api.Html ephox.sugar.api.Traverse".split(" "),
function(a,d,c,b,e,f){var g=function(b){var d=f.children(b);a.each([c.links,c.position],function(a){a(d)})};return{go:function(a,c,f,p,h){g(f);f=e.get(f);c=d.derive(h,p,c);return b.go(a,f,c)},preprocess:g}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.pastiche.PasteTransfer","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.smartpaste.PasteResponse ephox.fred.PlatformDetection ephox.limbo.api.RunPaste ephox.perhaps.Result ephox.sugar.api.Elements global!console".split(" "),
function(a,d,c,b,e,f,g,k){var m=b.detect(),n=function(a,b,c,d){try{var p=e.go(a,m,b,c,d),n=void 0!==p&&null!==p&&0<p.length?g.fromHtml(p):[];return f.value(n)}catch(h){return k.error(h),f.error("errors.paste.process.failure")}};return{transfer:function(b,e,f,g,k){return n(b,e,g,f).fold(function(b){return a.error(b)},function(b){return a.sync(function(e){k.get(function(f){a.call(e,{response:c.paste(b,f),bundle:d.nu({})})})})})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.cement.pastiche.OffscreenHandler","ephox.cement.pastiche.PasteTransfer ephox.compass.Arr ephox.knoch.future.Future ephox.perhaps.Option ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f){return{internal:function(g,k,m){k=(void 0!==k?k.findClipboardTags(f.children(m)):b.none()).getOr([]);d.each(k,e.remove);k=c.nu(function(a){a([])});return a.transfer(g,m,!1,!0,k)},external:function(b,c,d,e,f){return a.transfer(b,c,e,d,f)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.TextContent",[],function(){return{get:function(a){return a.dom().textContent},set:function(a,d){a.dom().textContent=d}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.alien.TextToHtml",["ephox.compass.Arr","ephox.sugar.api.Element","ephox.sugar.api.Html","ephox.sugar.api.TextContent"],function(a,d,c,b){return{encode:function(a){var f=d.fromTag("div");
b.set(f,a);return c.get(f)},convert:function(b){b=b.trim().split(/\n{2,}|(?:\r\n){2,}/);b=a.map(b,function(a){return a.split(/\n|\r\n/).join("<br />")});return 1===b.length?b[0]:a.map(b,function(a){return"<p>"+a+"</p>"}).join("")}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.plain.TextHandler","ephox.cement.alien.FutureStep ephox.cement.alien.TextToHtml ephox.cement.api.Bundle ephox.cement.smartpaste.Inspection ephox.cement.smartpaste.PasteResponse ephox.perhaps.Option ephox.perhaps.Options ephox.sugar.api.Elements global!window".split(" "),
function(a,d,c,b,e,f,g,k,m){var n=function(a){return 0<a.length},h=function(a){return b.isValidData(a)?g.findMap(a.types,function(b){return"text/plain"===b?f.some(a.getData(b)):f.none()}):f.none()},l=function(){var a=m.clipboardData;return void 0!==a?f.some(a.getData("text")):f.none()},s=function(a){a=d.encode(a);a=d.convert(a);a=k.fromHtml(a);return e.paste(a,[])};return{handle:function(d){return a.sync(function(f){var g=(b.isValidData(d)?h:l)(d).filter(n).fold(e.cancel,s);a.call(f,{response:g,bundle:c.nu({})})})}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.step.PasteSteps","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.api.Bundles ephox.cement.html.HtmlHandler ephox.cement.images.ImageHandler ephox.cement.pastiche.OffscreenHandler ephox.cement.plain.TextHandler ephox.cement.smartpaste.PasteResponse ephox.fred.PlatformDetection ephox.limbo.api.RunPaste ephox.peanut.Fun ephox.sugar.api.Element ephox.sugar.api.InsertAll ephox.sugar.api.Traverse global!console".split(" "),
function(a,d,c,b,e,f,g,k,m,n,h,l,s,t,u){var v=m.detect();return{plain:function(a,b,c){return g.handle(a)},autolink:function(b,c){var d=function(b,d){var e=l.fromTag("div");s.append(e,b);n.preprocess(e);e=t.children(e);return a.pure({response:k.paste(e,d),bundle:c.bundle()})},e=h.curry(a.pass,c);return k.cata(c.response(),e,d,e,d)},noImages:function(b,c){return a.error("errors.local.images.disallowed")},images:function(b,c){return v.browser.isSafari()?a.error("safari.imagepaste"):e.handle(b)},internal:function(a,
b){return function(d,e){var g=e.bundle();return c.proxyBin(g).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(c){var d=t.owner(a);return f.internal(d,b,c)})}},external:function(a,b){return function(d,e){var g=e.bundle();return c.proxyBin(g).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(d){var e=c.merging(g),k=c.isWord(g),m=c.isInternal(g),n=c.backgroundAssets(g),h=t.owner(a);return m?f.internal(h,b,d):f.external(h,d,e,k,n)})}},
gwt:function(a){return function(d,e){var f=c.mergeOffice(e.bundle());return b.handle(d,f,a)}},setBundle:function(b){return function(c,e){var f=d.merge(e.bundle(),d.nu(b));return a.pure({response:e.response(),bundle:f})}},none:function(b,c){return a.cancel()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.CementConstants",["ephox.cement.style.Styles","ephox.peanut.Fun"],function(a,d){var c=a.resolve("smartpaste-eph-bin");return{binStyle:d.constant(c)}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.limbo.api.Sources",["ephox.pastiche.api.HybridAction","ephox.sugar.api.Attr","ephox.sugar.api.Html","ephox.sugar.api.PredicateExists"],function(a,d,c,b){var e=function(a){return b.descendant(a,function(a){return d.has(a,"style")?-1<d.get(a,"style").indexOf("mso-"):!1})},f=function(b){b=c.get(b);return a.isWordContent(b)};return{isWord:function(a,b){var c=a.browser;return(c.isIE()&&11<=c.version.major?e:f)(b)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.step.ProxyStep","ephox.cement.alien.FutureStep ephox.cement.api.Bundle ephox.cement.api.CementConstants ephox.fred.PlatformDetection ephox.limbo.api.Sources ephox.sugar.api.Class ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g){var k=b.detect();return function(b,n,h,l,s){return function(t,u){var v=h(),y=u.response();return a.sync(function(h){var q=b(l);q.events.after.bind(function(b){b=b.container();n(b);
f.add(b,c.binStyle());var m=e.isWord(k,b),l=g.children(b),l=s.findClipboardTags(l,m).isSome();a.call(h,{response:y,bundle:d.nu({isWord:m,isInternal:l,proxyBin:b,backgroundAssets:v})})});v.convert(t);q.run()})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.PasteFlavors","ephox.cement.api.PasteProcesses ephox.cement.pastiche.BackgroundAssets ephox.cement.smartpaste.Inspection ephox.cement.step.FlashStep ephox.cement.step.MergeStep ephox.cement.step.PasteSteps ephox.cement.step.ProxyStep ephox.fred.PlatformDetection ephox.peanut.Fun ephox.perhaps.Option ephox.violin.Strings global!window".split(" "),
function(a,d,c,b,e,f,g,k,m,n,h,l){var s=k.detect(),t=["image","file"],u=function(a){var b=a.clipboardData;return c.isValidData(b)?c.getFlavor(b.types,"html").bind(function(a){a=b.getData(a.type);return h.contains(a,"<html")&&(h.contains(a,'xmlns:o="urn:schemas-microsoft-com:office:office"')||h.contains(a,'xmlns:x="urn:schemas-microsoft-com:office:excel"'))?n.some(a):n.none()}):n.none()},v=function(a){if(s.browser.isIE()||s.browser.isFirefox())return n.none();if(c.isValidData(a.clipboardData)){var b=
a.clipboardData;return c.getPreferredFlavor(t,b.types).map(function(a){return b.items})}return n.none()},y=function(a,b){var d=c.isValidData(b.clipboardData)?b.clipboardData.types:[];return c.getFlavor(d,a.clipboardType()).map(function(a){return b})},w=function(a){return s.browser.isIE()?n.some(l.clipboardData):c.isValidData(a.clipboardData)?n.some(a.clipboardData):n.none()},x=function(a,b,c,d){return{label:m.constant(a),getAvailable:b,steps:m.constant(c),capture:m.constant(d)}};return{internal:function(b,
c,k,h){var n=m.curry(y,h);return x("Within Textbox.io (tables) pasting",n,[a.normal(g(c,b,d.ignore,k,h)),a.normal(e.fixed(!0,!0)),a.normal(f.internal(k,h))],!1)},pastiche:function(c,k,h,m,l,q,r){return x("Outside of Textbox.io pasting (could be internal but another browser)",n.some,[a.normal(g(m,h,d.background,l,r)),a.normal(e.fromConfigIfExternal(c,k)),a.normal(f.external(l,r)),a.blocking(b(q,k))],!1)},gwt:function(c,d,g,k){return x("GWT pasting",u,[a.normal(f.setBundle({isWord:!0})),a.normal(e.fromConfig(d,
g)),a.normal(f.gwt(c)),a.blocking(b(k,g))],!0)},image:function(b){return x("Image pasting",v,[a.normal(!1===b.allowLocalImages?f.noImages:f.images)],!0)},text:function(){return x("Plain text pasting",w,[a.normal(f.plain),a.normal(f.autolink)],!0)},none:function(){return x("There is no valid way to paste",n.some,[a.normal(f.none)],!1)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.flash.HelpCopy","ephox.cement.style.Styles ephox.fred.PlatformDetection ephox.sugar.api.Attr ephox.sugar.api.Class ephox.sugar.api.Element ephox.sugar.api.Html ephox.sugar.api.InsertAll".split(" "),
function(a,d,c,b,e,f,g){var k=function(a){return e.fromHtml("<p>"+a("cement.dialog.flash.press-escape")+"</p>")};return{paste:function(c){var f=e.fromTag("div");b.add(f,a.resolve("flashbin-helpcopy"));var h;h=d.detect().os.isOSX()?["\u2318"]:["Ctrl"];var l=e.fromHtml("<p>"+c("cement.dialog.flash.trigger-paste")+"</p>");h=e.fromHtml('<div><span class="ephox-polish-help-kbd">'+h+'</span> + <span class="ephox-polish-help-kbd">V</span></div>');b.add(h,a.resolve("flashbin-helpcopy-kbd"));g.append(f,[l,
h,k(c)]);return f},noflash:function(c){var d=e.fromTag("div");b.add(d,a.resolve("flashbin-helpcopy"));var f=e.fromHtml("<p>"+c("cement.dialog.flash.missing")+"</p>");g.append(d,[f,k(c)]);return d},indicator:function(d){var k=e.fromTag("div");b.add(k,a.resolve("flashbin-loading"));var h=e.fromTag("div");b.add(h,a.resolve("flashbin-loading-spinner"));var l=e.fromTag("p");d=d("loading.wait");f.set(l,d);c.set(l,"aria-label",d);g.append(k,[h,l]);return k}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.flash.FlashInfo","ephox.cement.flash.HelpCopy ephox.cement.style.Styles ephox.fred.PlatformDetection ephox.peanut.Fun ephox.sugar.api.Class ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.InsertAll global!navigator".split(" "),function(a,d,c,b,e,f,g,k,h,n){var l=c.detect(),r=function(c,d,e,f){d=a.noflash(f);k.append(c,d);return{reset:b.noop}},s=function(b,c,d,e){var g=a.paste(e),k=a.indicator(e);h.append(b,
[k,g,c.element()]);b=function(){f.set(g,"display","block");f.set(k,"display","none");d()};c.events.spin.bind(function(){f.set(g,"display","none");f.set(k,"display","block");f.remove(k,"height");f.remove(k,"padding");d()});c.events.reset.bind(b);c.events.hide.bind(function(){f.setAll(k,{height:"0",padding:"0"})});return{reset:b}};return function(a,c,f){var k=g.fromTag("div"),h="flashbin-wrapper-"+(l.os.isOSX()?"cmd":"ctrl");e.add(k,d.resolve(h));var m;try{m=void 0!==(l.browser.isIE()?new ActiveXObject("ShockwaveFlash.ShockwaveFlash"):
n.plugins["Shockwave Flash"])}catch(p){m=!1}a=(m?s:r)(k,a,c,f.translations);return{element:b.constant(k),reset:a.reset}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!clearInterval",[],function(){return clearInterval});a.bolt.module.api.define("global!setInterval",[],function(){return setInterval});(function(a,h,l){a("ephox.cement.alien.CrashMonitor","ephox.perhaps.Option ephox.porkbun.Event ephox.porkbun.Events ephox.scullion.Cell global!clearInterval global!setInterval".split(" "),
function(a,d,c,b,e,f){return{responsive:function(){var g=b(a.none()),k=c.create({crashed:d([]),timeout:d([])});return{start:function(b,c,d){var h=c,l=f(function(){0>=h?(k.trigger.timeout(),e(l)):d()&&(e(l),k.trigger.crashed());h--},b);g.set(a.some(l))},stop:function(){g.get().each(function(a){e(a)})},events:k.registry}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.alien.WaitForFlash",["ephox.classify.Type","ephox.compass.Arr","global!clearInterval",
"global!setInterval"],function(a,d,c,b){return function(e,f,g){var k=function(b){return d.forall(f,function(c){return a.isFunction(b[c])})},h=!0,n=b(function(){var b=e.dom();a.isFunction(b.PercentLoaded)&&100===b.PercentLoaded()&&k(b)&&(l(),g())},500),l=function(){h&&(c(n),h=!1)};return{stop:l}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.epithet.Namespace",["ephox.epithet.Global"],function(a){return{namespace:function(d,c){for(var b=
c||a,e=d.split("."),f=0;f<e.length;++f){var g=e[f];if(void 0===b[g]||null===b[g])b[g]={};b=b[g]}return b}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.oilspill.callback.Globaliser",["ephox.epithet.Namespace"],function(a){return{install:function(d){var c=a.namespace(d);c.callbacks={};var b=0,e=function(){var a="callback_"+b;b++;return a},f=function(a,b){var f=e();c.callbacks[f]=function(){b||g(f);a.apply(null,arguments)};return d+".callbacks."+
f},g=function(a){a=a.substring(a.lastIndexOf(".")+1);void 0!==c.callbacks[a]&&delete c.callbacks[a]};c.ephemeral=function(a){return f(a,!1)};c.permanent=function(a){return f(a,!0)};c.unregister=g;return c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Focus","ephox.peanut.Fun ephox.perhaps.Option ephox.sugar.api.Compare ephox.sugar.api.Element ephox.sugar.api.PredicateExists ephox.sugar.api.Traverse global!document".split(" "),
function(a,d,c,b,e,f,g){var k=function(a){a.dom().focus()},h=function(a){a=void 0!==a?a.dom():g;return d.from(a.activeElement).map(b.fromDom)};return{hasFocus:function(a){var b=f.owner(a).dom();return a.dom()===b.activeElement},focus:k,blur:function(a){a.dom().blur()},active:h,search:function(a){return h(f.owner(a)).filter(function(b){return a.dom().contains(b.dom())})},focusInside:function(b){var d=f.owner(b);h(d).filter(function(d){return e.closest(d,a.curry(c.eq,b))}).fold(function(){k(b)},a.noop)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);a.bolt.module.api.define("global!clearTimeout",[],function(){return clearTimeout});a.bolt.module.api.define("global!unescape",[],function(){return unescape});(function(a,h,l){a("ephox.cement.flash.Flashbin","ephox.cement.alien.CrashMonitor ephox.cement.alien.WaitForFlash ephox.cement.style.Styles ephox.compass.Arr ephox.compass.Obj ephox.epithet.Id ephox.fred.PlatformDetection ephox.oilspill.callback.Globaliser ephox.perhaps.Option ephox.porkbun.Event ephox.porkbun.Events ephox.sugar.api.Class ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Focus ephox.sugar.api.Insert global!clearInterval global!clearTimeout global!console global!setInterval global!setTimeout global!unescape global!window".split(" "),
function(a,d,c,b,e,f,g,k,h,n,l,r,s,t,u,v,y,w,x,z,B,E,H){var D=k.install("ephox.flash"),A=g.detect(),P=h.none();return function(g){var k=l.create({response:n(["rtf"]),spin:n([]),cancel:n([]),error:n(["message"]),reset:n([]),hide:n([]),failed:n(["message"])}),h=!1,m=t.fromTag("div");r.add(m,c.resolve("flashbin-target"));var y=a.responsive();y.events.crashed.bind(function(){k.trigger.failed("flash.crashed")});y.events.timeout.bind(function(){k.trigger.failed("flash.crashed")});var z=function(){L.stop();
if(!h){h=!0;try{var a=F.dom();e.each(J,function(b,c){var d=a[c];if(void 0===d)throw'Flash object does not have the method "'+c+'"';d.call(a,b)});k.trigger.reset();w(M);r.remove(m,c.resolve("flash-activate"));N();K()}catch(b){x.log("Flash dialog - Error during load: ",b)}}},C=D.permanent(z),J={setSpinCallback:D.permanent(function(){y.start(1E3,10,function(){return!F.dom().setVariable});k.trigger.spin()}),setPasteCallback:D.permanent(function(a){B(function(){k.trigger.response(E(a))},0)}),setEscapeCallback:D.permanent(k.trigger.cancel),
setErrorCallback:D.permanent(k.trigger.error),setStartPasteCallback:D.permanent(function(){y.stop()})},F=function(){var a=g.replace(/^https?:\/\//,"//"),b='    <param name="allowscriptaccess" value="always">    <param name="wmode" value="opaque">    <param name="FlashVars" value="onLoad='+C+'">';if(A.browser.isIE()&&10===A.browser.version.major){var c=f.generate("flash-bin");return t.fromHtml('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="'+c+'"><param name="movie" value="'+a+'">'+
b+"</object>")}return t.fromHtml('<object type="application/x-shockwave-flash" data="'+a+'">'+b+"</object>")}(),N=function(){s.setAll(F,{width:"2px",height:"2px"})};N();var L=d(F,e.keys(J),z);v.append(m,F);var K=function(){A.browser.isFirefox()&&H.getSelection().removeAllRanges();u.focus(F)},M=null,I=function(){r.add(m,c.resolve("flash-activate"));s.remove(F,"height");s.remove(F,"width");k.trigger.hide()},O=function(){s.set(m,"display","none");P.each(function(a){b.each(a,function(a){a.unbind()})})};
return{focus:K,element:function(){return m},activate:function(){M=B(I,3E3);k.trigger.spin();s.set(m,"display","block");K()},deactivate:O,destroy:function(){O();b.each(e.values(J),function(a){D.unregister(a)});D.unregister(C);L.stop()},events:k.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.flash.FlashDialog","ephox.cement.flash.FlashInfo ephox.cement.flash.Flashbin ephox.porkbun.Event ephox.porkbun.Events ephox.sugar.api.DomEvent ephox.sugar.api.Element global!window".split(" "),
function(a,d,c,b,e,f,g){return function(k,h){var n=h.translations,l=b.create({response:c(["rtf","hide"]),cancel:c([]),error:c(["message"]),failed:c(["message"])});return{open:function(){var b=d(h.swf);b.deactivate();var c=f.fromDom(g),s=e.bind(c,"mouseup",b.focus),u=function(){w()},c=function(){w();l.trigger.cancel()};b.events.cancel.bind(c);b.events.response.bind(function(a){l.trigger.response(a.rtf(),u)});b.events.error.bind(function(a){w();l.trigger.error(a.message())});b.events.failed.bind(function(a){w();
l.trigger.failed(a.message())});var v=k();v.setTitle(n("cement.dialog.flash.title"));var y=a(b,v.reflow,h);y.reset();v.setContent(y.element());v.events.close.bind(c);v.show();b.activate();var w=function(){s.unbind();v.destroy();b.destroy()}},events:l.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.api.Situ",[],function(){var a=function(a){return{fold:a}};return{on:function(d,c){return a(function(a,e,f){return e(d,c)})},before:function(d){return a(function(a,
b,e){return a(d)})},after:function(d){return a(function(a,b,e){return e(d)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.api.SelectionRange",["ephox.fussy.api.Situ","ephox.scullion.Struct","ephox.sugar.api.Element"],function(a,d,c){var b=d.immutable("start","soffset","finish","foffset"),e=d.immutable("start","soffset","finish","foffset"),f=d.immutable("start","finish");return{read:b,general:e,write:f,writeFromNative:function(b){var d=
c.fromDom(b.startContainer),e=c.fromDom(b.endContainer);return f(a.on(d,b.startOffset),a.on(e,b.endOffset))}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.api.Supported",[],function(){return{run:function(a,d){if(a.getSelection)return d(a,a.getSelection());throw"No selection model supported.";}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.DocumentPosition",["ephox.sugar.api.Compare",
"ephox.sugar.api.Traverse"],function(a,d){return{after:function(c,b,e,f){var g=d.owner(c).dom().createRange();g.setStart(c.dom(),b);g.setEnd(e.dom(),f);c=a.eq(c,e)&&b===f;return g.collapsed&&!c}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.wwwc.Directions",["ephox.fussy.api.SelectionRange","ephox.sugar.api.DocumentPosition","ephox.sugar.api.Element","ephox.sugar.api.Traverse"],function(a,d,c,b){var e=function(a){return d.after(c.fromDom(a.anchorNode),
a.anchorOffset,c.fromDom(a.focusNode),a.focusOffset)},f=function(b,d){var f=c.fromDom(d.startContainer),g=c.fromDom(d.endContainer);return e(b)?a.read(g,d.endOffset,f,d.startOffset):a.read(f,d.startOffset,g,d.endOffset)},g=function(a){return e(a)},k=function(a,c,d,e){return function(f){if(f.extend)f.collapse(a.dom(),c),f.extend(d.dom(),e);else{var g=b.owner(a).dom().createRange();g.setStart(d.dom(),e);g.setEnd(a.dom(),c);f.removeAllRanges();f.addRange(g)}}},h=function(a,b,c,e){return d.after(a,b,
c,e)};return{read:function(){return{flip:f,isRtl:g}},write:function(){return{flip:k,isRtl:h}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.wwwc.DomRange",["ephox.fussy.api.SelectionRange","ephox.fussy.wwwc.Directions","ephox.perhaps.Option","ephox.sugar.api.DocumentPosition","ephox.sugar.api.Element"],function(a,d,c,b,e){var f=function(b,d){if(!0===g(b,d.start(),d.finish()).collapsed){var f=g(b,d.finish(),d.start());return!0===f.collapsed?
c.none():c.some(a.general(e.fromDom(f.endContainer),f.endOffset,e.fromDom(f.startContainer),f.startOffset))}return c.none()},g=function(a,b,c){var d=l(a);b.fold(function(a){d.setStartBefore(a.dom())},function(a,b){d.setStart(a.dom(),b)},function(a){d.setStartAfter(a.dom())});c.fold(function(a){d.setEndBefore(a.dom())},function(a,b){d.setEnd(a.dom(),b)},function(a){d.setEndAfter(a.dom())});return d},k=function(a,b){return g(a,b.start(),b.finish())},h=function(a,b){var c=k(a,b);return function(a){a.addRange(c)}},
l=function(a){return a.document.createRange()};return{create:l,build:function(a,b){return f(a,b).fold(function(){return h(a,b)},function(a){return d.write().flip(a.start(),a.soffset(),a.finish(),a.foffset())})},toNative:k,forceRange:function(a,b){var c=g(a,b.start(),b.finish());return!0===c.collapsed?g(a,b.finish(),b.start()):c},toExactNative:function(a,c,d,e,f){var g=b.after(c,d,e,f);a=a.document.createRange();g?(a.setStart(e.dom(),f),a.setEnd(c.dom(),d)):(a.setStart(c.dom(),d),a.setEnd(e.dom(),
f));return a}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.search.Within","ephox.compass.Arr ephox.fussy.wwwc.DomRange ephox.sugar.api.Element ephox.sugar.api.Node ephox.sugar.api.SelectorFilter ephox.sugar.api.Selectors".split(" "),function(a,d,c,b,e,f){var g=function(b,c,d,g){var h=b.document.createRange();b=(f.is(c,g)?[c]:[]).concat(e.descendants(c,g));return a.filter(b,function(a){h.selectNodeContents(a.dom());return 1>h.compareBoundaryPoints(d.END_TO_START,
d)&&-1<h.compareBoundaryPoints(d.START_TO_END,d)})};return{find:function(a,e,f){e=d.forceRange(a,e);var h=c.fromDom(e.commonAncestorContainer);return b.isElement(h)?g(a,h,e,f):[]}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.wwwc.Prefilter",["ephox.compass.Arr","ephox.fussy.api.SelectionRange","ephox.fussy.api.Situ","ephox.sugar.api.Node"],function(a,d,c,b){var e=function(d,e){return a.contains(["br","img"],b.name(d))?0===e?c.before(d):
c.after(d):c.on(d,e)};return{beforeSpecial:e,preprocess:function(a){var b=a.start().fold(c.before,e,c.after);a=a.finish().fold(c.before,e,c.after);return d.write(b,a)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sugar.api.Fragment",["ephox.compass.Arr","ephox.sugar.api.Element","global!document"],function(a,d,c){return{fromElements:function(b,e){var f=(e||c).createDocumentFragment();a.each(b,function(a){f.appendChild(a.dom())});return d.fromDom(f)}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.wwwc.WwwcModel","ephox.fussy.api.SelectionRange ephox.fussy.wwwc.Directions ephox.fussy.wwwc.DomRange ephox.fussy.wwwc.Prefilter ephox.perhaps.Option ephox.sugar.api.Element ephox.sugar.api.Fragment".split(" "),function(a,d,c,b,e,f,g){var h=function(a,b){var c=b.getRangeAt(0),d=b.getRangeAt(b.rangeCount-1),e=a.document.createRange();e.setStart(c.startContainer,c.startOffset);e.setEnd(d.endContainer,d.endOffset);return e},
l=function(a,b){return void 0!==b&&null!==b&&0<b.rangeCount?e.from(h(a,b)):e.none()};return{get:function(b,c){return l(b,c).map(function(b){var e=f.fromDom(b.startContainer),g=f.fromDom(b.endContainer);return d.read().isRtl(c)?d.read().flip(c,b):a.read(e,b.startOffset,g,b.endOffset)})},set:function(a){return function(d,e){var f=b.preprocess(a),f=c.build(d,f);void 0!==e&&null!==e&&(e.removeAllRanges(),f(e))}},selectElementContents:function(a){return function(b,d){var e=c.create(b);e.selectNodeContents(a.dom());
d.removeAllRanges();d.addRange(e)}},replace:function(a){return function(b,c){l(b,c).each(function(c){var d=g.fromElements(a,b.document);c.deleteContents();c.insertNode(d.dom())})}},replaceRange:function(a,d){return function(e,f){var h=b.preprocess(a),h=c.toNative(e,h),k=g.fromElements(d,e.document);h.deleteContents();h.insertNode(k.dom())}},deleteRange:function(a,b,d,e){return function(f,g){c.toExactNative(f,a,b,d,e).deleteContents()}},cloneFragment:function(a,b,d,e){return function(g,h){var k=c.toExactNative(g,
a,b,d,e).cloneContents();return f.fromDom(k)}},rectangleAt:function(a,b,d,f){return function(g,h){var k=c.toExactNative(g,a,b,d,f),l=k.getClientRects(),k=0<l.length?l[0]:k.getBoundingClientRect();return 0<k.width||0<k.height?e.some(k):e.none()}},bounds:function(a){return function(b,d){var f=c.create(b);f.selectNode(a.dom());f=f.getBoundingClientRect();return 0<f.width||0<f.height?e.some(f):e.none()}},clearSelection:function(a,b){a.getSelection().removeAllRanges()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,
a.bolt.module.api.demand);(function(a,h,l){a("ephox.fussy.api.WindowSelection","ephox.fussy.api.SelectionRange ephox.fussy.api.Situ ephox.fussy.api.Supported ephox.fussy.search.Within ephox.fussy.wwwc.DomRange ephox.fussy.wwwc.WwwcModel ephox.sugar.api.Compare ephox.sugar.api.Element".split(" "),function(a,d,c,b,e,f,g,h){var l=function(a,b){c.run(a,f.set(b))},n=function(a,c,d){return b.find(a,c,d)};return{get:function(a){return c.run(a,f.get)},set:l,setExact:function(b,c,e,f,g){c=a.write(d.on(c,e),
d.on(f,g));l(b,c)},selectElementContents:function(a,b){c.run(a,f.selectElementContents(b))},replace:function(a,b){c.run(a,f.replace(b))},replaceRange:function(a,b,d){c.run(a,f.replaceRange(b,d))},deleteRange:function(a,b,d,e,g){c.run(a,f.deleteRange(b,d,e,g))},isCollapsed:function(a,b,c,d){return g.eq(a,c)&&b===d},cloneFragment:function(a,b,d,e,g){return c.run(a,f.cloneFragment(b,d,e,g))},rectangleAt:function(a,b,d,e,g){return c.run(a,f.rectangleAt(b,d,e,g))},bounds:function(a,b){return c.run(a,f.bounds(b))},
findWithin:n,findWithinExact:function(b,c,e,f,g,h){c=a.write(d.on(c,e),d.on(f,g));return n(b,c,h)},deriveExact:function(b,c){var d=e.forceRange(b,c);return a.general(h.fromDom(d.startContainer),d.startOffset,h.fromDom(d.endContainer),d.endOffset)},clearAll:function(a){c.run(a,f.clearSelection)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.data.Range",["ephox.peanut.Fun","ephox.sugar.api.Compare"],function(a,d){return function(c,
b,e,f){var g=d.eq(c,e)&&b===f;return{startContainer:a.constant(c),startOffset:a.constant(b),endContainer:a.constant(e),endOffset:a.constant(f),collapsed:a.constant(g)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.api.BodySwitch",["ephox.sloth.data.Range","ephox.sugar.api.Element","ephox.sugar.api.Insert","ephox.sugar.api.Remove","ephox.sugar.api.Traverse"],function(a,d,c,b,e){return function(f){var g=d.fromTag("br");return{cleanup:function(){b.remove(g)},
toOn:function(a,b){a.dom().focus()},toOff:function(b,d){var h;h=e.owner(d).dom().defaultView;h.focus();c.append(d,g);f.set(h,a(g,0,g,0))}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.api.DivSwitch",["ephox.peanut.Fun"],function(a){return function(){return{toOn:function(a,c){a.dom().focus()},toOff:function(a,c){c.dom().focus()},cleanup:a.identity}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.sloth.engine.Consolidator","ephox.compass.Arr ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.InsertAll ephox.sugar.api.Remove ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f){var g=function(g,h){var l=f.children(g);a.each(l,function(a){if(h(a)){var g=f.children(a),k=d.fromTag("div",f.owner(a).dom());b.append(k,g);c.before(a,k);e.remove(a)}})};return{consolidate:function(a,c){f.nextSibling(a).filter(c).each(function(c){var d=f.children(c);b.append(a,
d);e.remove(c)});g(a,c)}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.engine.Offscreen","ephox.epithet.Id ephox.scullion.Struct ephox.sloth.engine.Consolidator ephox.sugar.api.Attr ephox.sugar.api.Class ephox.sugar.api.Css ephox.sugar.api.Element ephox.sugar.api.Html ephox.sugar.api.Insert ephox.sugar.api.Remove ephox.sugar.api.SelectorFind ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g,h,l,n,q,r){var s=a.generate("ephox-sloth-bin");
return function(a){var p=g.fromTag("div");b.set(p,"contenteditable","true");e.add(p,s);f.setAll(p,{position:"absolute",left:"0px",top:"0px",width:"0px",height:"0px",overflow:"hidden"});var v=function(a){return e.has(a,s)};return{attach:function(a){n.empty(p);l.append(a,p)},focus:function(){q.ancestor(p,"body").each(function(b){a.toOff(b,p)})},contents:function(){c.consolidate(p,v);var a=d.immutable("elements","html","container"),b=r.children(p),e=h.get(p);return a(b,e,p)},container:function(){return p},
detach:function(){n.remove(p)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.sloth.api.ProxyPaste","ephox.peanut.Fun ephox.plumber.tap.function.BlockTap ephox.porkbun.Event ephox.porkbun.Events ephox.sloth.api.Paste ephox.sloth.engine.Offscreen ephox.sugar.api.Traverse".split(" "),function(a,d,c,b,e,f,g){return function(h,l){var n=f(h),q=function(){h.cleanup();var a=n.contents();n.detach();s.trigger.after(a.elements(),a.html(),n.container())},
r=d.tap(function(){s.trigger.before();n.attach(l);n.focus();e.run(g.owner(l),r,q)}),s=b.create({before:c([]),after:c(["elements","html","container"])}),t=a.noop;return{instance:a.constant(function(){r.instance()}),destroy:t,events:s.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.pastiche.Proxy","ephox.fred.PlatformDetection ephox.fussy.api.WindowSelection ephox.porkbun.Event ephox.porkbun.Events ephox.sloth.api.BodySwitch ephox.sloth.api.DivSwitch ephox.sloth.api.ProxyPaste ephox.sugar.api.Node".split(" "),
function(a,d,c,b,e,f,g,h){var l=a.detect(),n={set:function(a,b){d.setExact(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())}},q=function(a){return(l.browser.isIE()&&"body"!==h.name(a)?f:e)(n)};return function(a){var d=b.create({after:c(["container"])}),e=q(a),f=g(e,a);f.events.after.bind(function(b){e.toOn(a,b.container());d.trigger.after(b.container())});return{run:function(){f.instance()()},events:d.registry}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);
(function(a,h,l){a("ephox.sugar.api.Ready",["ephox.sugar.api.DomEvent","ephox.sugar.api.Element","global!document"],function(a,d,c){return{execute:function(b){if("complete"===c.readyState||"interactive"===c.readyState)b();else var e=a.bind(d.fromDom(c),"DOMContentLoaded",function(){b();e.unbind()})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.keurig.loader.GWTLoader","ephox.fred.PlatformDetection ephox.oilspill.callback.Globaliser ephox.peanut.Fun ephox.peanut.Thunk ephox.perhaps.Option ephox.photon.Writer ephox.sugar.api.Body ephox.sugar.api.Css ephox.sugar.api.DomEvent ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.Ready ephox.sugar.api.Remove".split(" "),
function(a,d,c,b,e,f,g,h,l,n,q,r,s){var t=d.install("ephox.keurig.init"),u=e.none();return{load:a.detect().browser.isIE()?c.noop:b.cached(function(b){var c=n.fromTag("div");if(void 0===b)throw"baseUrl was undefined";var d=n.fromTag("iframe");h.setAll(c,{display:"none"});var x=l.bind(d,"load",function(){var g=t.ephemeral(function(b){u=e.some(b);a.detect().browser.isSafari()||s.remove(c)});f.write(d,'<script type="text/javascript" src="'+(b+"/wordimport.js")+'">\x3c/script><script type="text/javascript">function gwtInited () {parent.window.'+
g+"(com.ephox.keurig.WordCleaner.cleanDocument);};\x3c/script>");x.unbind()});r.execute(function(){q.append(g.body(),c);q.append(c,d)})}),cleanDocument:function(a,b){return u.map(function(c){return c(a,b)})},ready:function(){return u.isSome()}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.keurig.api.WordCleaner",["ephox.keurig.loader.GWTLoader"],function(a){return function(d){a.ready()||a.load(d);return{cleanDocument:a.cleanDocument}}})})(a.bolt.module.api.define,
a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.cement.api.Cement","ephox.cement.api.PasteBroker ephox.cement.api.PasteFlavors ephox.cement.flash.FlashDialog ephox.cement.pastiche.Proxy ephox.compass.Arr ephox.epithet.Id ephox.keurig.api.WordCleaner ephox.peanut.Fun ephox.perhaps.Option".split(" "),function(a,d,c,b,e,f,g,h,l){return function(n,q,r,s){var t=g(s.baseUrl),u=h.curry(c,q),v=void 0!==s.intraFlag?s.intraFlag:{clipboardType:f.generate("clipboard-type"),findClipboardTags:l.none},
t=e.flatten([void 0!==s.intraFlag?d.internal(r,b,n,v):[],[d.gwt(t,q,s,u)],[d.image(s)]]);n=d.pastiche(q,s,r,b,n,u,v);return a(t,n)}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.settings.Defaults",[],function(){return{officeStyles:"prompt",htmlStyles:"clean"}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.styles.Styles","ephox.sugar.api.Attr ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.Remove ephox.sugar.api.SelectorExists ephox.sugar.api.SelectorFind global!document".split(" "),
function(a,d,c,b,e,f,g){return{injectStyles:function(b){if(!e.any("#powerpaste-styles")){b=d.fromHtml("<style>.ephox-cement-flashbin-helpcopy-kbd {font-size: 3em !important; text-align: center !important; vertical-align: middle !important; margin: .5em 0} .ephox-cement-flashbin-helpcopy-kbd .ephox-polish-help-kbd {font-size: 3em !important; vertical-align: middle !important;} .ephox-cement-flashbin-helpcopy a {text-decoration: underline} .ephox-cement-flashbin-loading-spinner {background-image: url("+
b+") !important; width: 96px !important; height:96px !important; display: block; margin-left: auto !important; margin-right: auto !important; margin-top: 2em !important; margin-bottom: 2em !important;} .ephox-cement-flashbin-loading p {text-align: center !important; margin: 2em 0 !important} .ephox-cement-flashbin-target {height: 1px !important;} .ephox-cement-flashbin-target.ephox-cement-flash-activate {height: 150px !important; width: 100% !important;} .ephox-cement-flashbin-target object {height: 1px !important;} .ephox-cement-flashbin-target.ephox-cement-flash-activate object {height: 150px !important; width: 100% !important;} </style>");
a.set(b,"type","text/css");a.set(b,"id","powerpaste-styles");var g=f.first("head").getOrDie("Head element could not be found.");c.append(g,b)}},removeStyles:function(){if(e.any("#powerpaste-styles")){var a=f.first("head").getOrDie("Head element could not be found."),a=f.descendant(a,"#powerpaste-styles").getOrDie("The style element could not be removed");b.remove(a)}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.ModernTinyDialog",
"ephox.porkbun.Event ephox.porkbun.Events ephox.powerpaste.util.NodeUtil ephox.sugar.api.Attr ephox.sugar.api.Element ephox.sugar.api.Insert ephox.sugar.api.Remove ephox.sugar.api.SelectorFind".split(" "),function(a,d,c,b,e,f,g,h){return function(l){return{createDialog:function(){var n,q="",r="",s=[],t=null,u=d.create({close:a([])}),v=function(a){u.trigger.close()},y=function(){n.off("close",v);n.close("close")};return{events:u.registry,setTitle:function(a){q=a},setContent:function(a){r=[{type:"container",
html:c.nodeToString(a.dom())}];t=a},setButtons:function(a){var b=[];a.forEach(function(a,c,d){b.push({text:a.text,onclick:a.click})});s=b},show:function(){0===s.length&&(s=[{text:"Close",onclick:function(){n.close()}}]);n=l.windowManager.open({title:q,spacing:10,padding:10,items:r,buttons:s});var a=e.fromDom(n.getEl()),a=h.descendant(a,"."+b.get(t,"class")).getOrDie("We must find this element or we cannot continue");f.before(a,t);g.remove(a);n.on("close",v)},hide:function(){y()},destroy:function(){y()},
reflow:function(){}}}}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.ModernPowerPaste","ephox.cement.api.Cement ephox.compass.Arr ephox.peanut.Fun ephox.powerpaste.i18n.I18n ephox.powerpaste.settings.Defaults ephox.powerpaste.styles.Styles ephox.powerpaste.tinymce.ErrorDialog ephox.powerpaste.tinymce.ModernTinyDialog ephox.powerpaste.util.NodeUtil ephox.sugar.api.DomEvent ephox.sugar.api.Element global!setTimeout global!tinymce".split(" "),
function(a,d,c,b,e,f,g,h,l,n,q,r,s){return function(t,u,v,y){var w,x,z,B,A;A=(v?v.swfUrl:u)+"/js";x=(v?v.swfUrl:u)+"/flash/textboxpaste.swf";z=(v?v.imgUrl:u)+"/img/spinner_96.gif";B=(v?v.cssUrl:u)+"/css/editorcss.css";t.on("init",function(s){f.injectStyles(z);t.dom.loadCSS(B);s={baseUrl:A,swf:x,officeStyles:t.settings.powerpaste_word_import||e.officeStyles,htmlStyles:t.settings.powerpaste_html_import||e.htmlStyles,translations:b.translate,allowLocalImages:t.settings.powerpaste_allow_local_images};
var u=h(t),v=q.fromDom(t.getBody()),C=a(v,u.createDialog,c.noop,s);C.events.cancel.bind(function(){w=null});C.events.error.bind(function(a){w=null;t.notificationManager?t.notificationManager.open({text:b.translate(a.message()),type:"error"}):g.showDialog(t,b.translate(a.message()))});C.events.insert.bind(function(a){var b=d.map(a.elements(),function(a){return l.nodeToString(a.dom())}).join("");if(t.hasEventListeners("PastePostProcess")){var c=t.dom.add(t.getBody(),"div",{style:"display:none"},b),
b=t.fire("PastePostProcess",{node:c}).node.innerHTML;t.dom.remove(c)}t.focus();r(function(){t.selection.moveToBookmark(w);w=null;t.undoManager.transact(function(){t.insertContent(b,{merge:!1!==t.settings.paste_merge_formats});y.prepareImages(a.assets())});y.uploadImages(a.assets())},1)});n.bind(v,"paste",function(a){w||(w=t.selection.getBookmark());C.paste(a.raw());r(function(){t.windowManager.windows[0]&&t.windowManager.windows[0].getEl()&&t.windowManager.windows[0].getEl().focus()},1)})});t.on("remove",
function(a){1===s.editors.length&&f.removeStyles()})}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.tinymce.TinyPowerPaste",["ephox.powerpaste.imageupload.UploaderFactory","ephox.powerpaste.tinymce.LegacyPowerPaste","ephox.powerpaste.tinymce.ModernPowerDrop","ephox.powerpaste.tinymce.ModernPowerPaste","global!tinymce"],function(a,d,c,b,e){return function(f){return function(g,h){var l=function(){var d=a(g);b(g,h,f,d);g.settings.powerpaste_block_drop||
c(g,h,f,d)};e.Env.ie&&10>e.Env.ie?d(g,f):l();var n=function(a){g.dom.bind(a,"drop dragstart dragend dragover dragenter dragleave dragdrop draggesture",function(a){return e.dom.Event.cancel(a)})};if(g.settings.powerpaste_block_drop)g.on("init",function(a){n(g.getBody());n(g.getDoc())});if(g.settings.paste_postprocess)g.on("PastePostProcess",function(a){g.settings.paste_postprocess.call(this,this,a)})}}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);(function(a,h,l){a("ephox.powerpaste.PowerPastePlugin",
["ephox.powerpaste.tinymce.TinyPowerPaste","global!tinymce"],function(a,d){return function(c){d.PluginManager.requireLangPack("powerpaste","ar,ca,cs,da,de,el,es,fa,fi,fr_FR,he_IL,hr,hu_HU,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW");d.PluginManager.add("powerpaste",a(c))}})})(a.bolt.module.api.define,a.bolt.module.api.require,a.bolt.module.api.demand);C("ephox.powerpaste.PowerPastePlugin")();this.ephox&&this.ephox.bolt&&(this.ephox.bolt=I)})();
