<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title></title>
  <link href="../Css/frame.css" rel="stylesheet" type="text/css" />
  <link href="../Css/jquery-ui-latest.custom.css" rel="stylesheet" type="text/css" />
  <link href="../Css/jquery-ui-enhanced.css" rel="stylesheet" type="text/css" />
  <link href="../Css/ts.ui.css" rel="stylesheet" type="text/css" />
  <!--[if IE 7]><link href="vcr/1_7_9/Css/ts.ui.ie7.css" rel="stylesheet" type="text/css" /><![endif]--><!--[if IE 8]><link href="vcr/1_7_9/Css/ts.ui.ie8.css" rel="stylesheet" type="text/css" /><![endif]-->

  <style type="text/css">
    .utils-content { border:none; padding: 2em 2em;}
  </style>

  <script src="../Js/jquery-latest.min.js" type="text/javascript"></script>
  <script src="../Js/jquery-ui-latest.custom.min.js" type="text/javascript"></script>

  <script language="javascript" type="text/javascript">

    $(document).ready(function () {
      $('button').button();
      $('.ts-loading').hide().next().show();
      $('#btnCleanUpOrphanTicketStatus').click(function (e) {
        e.preventDefault();
        parent.Ts.Services.Organizations.CleanUpOrphanTicketStatuses(function (result) { alert(result); });
      });
      $('#btnRefresh').click(function (e) {
        e.preventDefault();
        window.location = window.location;
      });

      $('#btnSearch').click(function (e) {
        e.preventDefault();
        $('#divSearch').empty();
        parent.Ts.Services.Tickets.SearchTicketsTest($('#textSearch').val(), function (result) {
          $('<div>').html(result.length + ' tickets found.').appendTo('#divSearch');
          for (var i = 0; i < result.length; i++) {
            $('<div>').html(result[i]).appendTo('#divSearch');
          }
          $('#divSearch h1').click(function (e) {
            $(this).toggle();
          });
        });
      });

      $('#btnGenKeys').click(function (e) {
        e.preventDefault();
        parent.Ts.Services.System.GenerateKeys(function (result) {
          $('.keys').html('');
          for (var i = 0; i < result.length; i++) {
            $('.keys').append('<p>' + result[i] + '</p>');

          }

        });
      });

      $('#btnDefaultUsers').click(function (e) {
        e.preventDefault();
        parent.Ts.Services.Users.CreateDefaultUsers();
      });

      $('#btnTest').click(function (e) {
        e.preventDefault();
        parent.Ts.Services.System.UtilTest(function (result) {
          $('.test-results').html(result);
        });
      });

      $('#btnDummyCreate').click(function (e) {
        e.preventDefault();
        $('.dummyCreate').html('...');
        parent.Ts.Services.Tickets.CreateDummyTickets(function (result) {
          var output = $('.dummyCreate').html('');
          for (var i = 0; i < result.length; i++) {
            output.append('<p>' + result[i] + '</p>');

          }

        });
      });
      $('#btnDummyRead').click(function (e) {
        e.preventDefault();
        $('.dummyRead').html('...');
        parent.Ts.Services.Tickets.ReadDummyTickets(function (result) {
          var output = $('.dummyRead').html('');
          for (var i = 0; i < result.length; i++) {
            output.append('<p>' + result[i] + '</p>');

          }

        });
      });

      $('#btnActionToText').click(function (e) {
        e.preventDefault();

        parent.Ts.Services.Tickets.ActionToText($('#textActionToText').val(), function (result) {
          $('.action-text').text(result[0]);
          $('.action-html').text(result[1]);
        });



      });


      var execGetTicket = null;
      function getTickets(request, response) {
        if (execGetTicket) { execGetTicket._executor.abort(); }
        execGetTicket = parent.Ts.Services.Tickets.SearchTickets(request.term, null, function (result) { response(result); });
      }

      $('#textQuick').autocomplete({
        minLength: 2,
        source: getTickets,
        select: function (event, ui) {
          $(this).data('itemID', ui.item.id);
        }

      });


      $('#btnHealthOff').click(function (e) { 
        parent.Ts.Services.System.ChangeHealthCheck(false);
      });
      $('#btnHealthOn').click(function (e) {
        parent.Ts.Services.System.ChangeHealthCheck(true);
      });

    });  
  </script>


</head>
<body>
  <div class="ts-loading"></div>
  <div style="height:100%; overflow:auto;">
  <div class="utils-content ui-widget ui-widget-content">
    <button id="btnRefresh">Refresh</button>&nbsp
    <button id="btnGenKeys">Generate Machine Keys</button>&nbsp
    <button id="btnDefaultUsers">Create Default Users</button>&nbsp
    <button id="btnHealthOff">Turn Off Service Health Check</button>&nbsp
    <button id="btnHealthOn">Turn On Service Health Check</button>&nbsp
    <button id="btnTest">Test</button>&nbsp
  </div>
  <div class="utils-content ui-widget ui-widget-content">
    
    <div class="keys"></div>
    <div class="dummyCreate"></div>
    <div class="dummyRead"></div>
  </div>
  <div class="utils-content ui-widget ui-widget-content">
    <input class="text ui-corner-all ui-widget-content" type="text" id="textSearch" style="width:300px;"/> <button id="btnSearch">Search</button>
    <div id="divSearch"></div>
  </div>
  <div class="utils-content ui-widget ui-widget-content">
    <input class="text ui-corner-all ui-widget-content" type="text" id="textQuick" style="width: 250px;" />
  </div>

  <div class="utils-content ui-widget ui-widget-content">
    <input class="text ui-corner-all ui-widget-content" type="text" id="textActionToText" style="width:300px;"/> <button id="btnActionToText">Action To Text</button>
    <h1>TEXT</h1>
    <div class="action-text"></div>
    <h1>HTML</h1>
    <div class="action-html"></div>
  </div>

  <div class="test-results">
  
  </div>


  
  </div>
</body>
</html>
