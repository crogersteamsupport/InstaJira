<!DOCTYPE html>
<html lang="en">
<head>
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../Css/bootstrap3.css" rel="stylesheet" type="text/css" />
  <link href="../Css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="../Css/tsbs.css" rel="stylesheet" type="text/css" />
  <!--[if IE]><link href="../Css/tsbs-ie.css" rel="stylesheet" type="text/css" /><![endif]-->
  <link href="AgentCustomerChat.css" rel="stylesheet" type="text/css" />

  <script src="../Js/Ts/ts.pendo.js" type="text/javascript"></script>
    <script src="../Js/jquery-1.11.0.min.js" type="text/javascript"></script>
  <script src="../Js/bootstrap3.min.js" type="text/javascript"></script>
  <script src="../Js/moment.min.js" type="text/javascript"></script>
    <script src="../Js/browser.js" type="text/javascript"></script>
  <script src="https://js.pusher.com/3.1/pusher.min.js"></script>
  <script src="AgentCustomerChatPusher.js" type="text/javascript"></script>
  <script src="AgentCustomerChatTOK.js" type="text/javascript"></script>
  <script src="AgentCustomerChat.js" type="text/javascript"></script>
  <script src="//static.opentok.com/v2/js/opentok.min.js"></script>
  <script src="../Js/moment.min.js" type="text/javascript"></script>
  <script src="../Js/jquery-ui-latest.custom.min.js" type="text/javascript"></script>
    <script src="../Js/jquery.fileupload.js" type="text/javascript"></script>

</head>
<body>
    <input id="hiddenAttachmentInput" type="file" name="somename" size="chars" style="display:none;">
    <div class="ts-loading page-loading"></div>
    <div class="frame-container" style="display:none;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-4 col-md-3 col-lg-3">
                    <div class="row chats-row">
                        <div id="chats-requests" class="col-md-12"></div>
                        <div id="chats-accepted" class="col-md-12"></div>
                    </div>
                </div>
                <div class="col-sm-8 col-md-9 col-lg-9 current-chat ">
                    <div class="row chat-toolbar-row">
                        <div class="col-sm-12">
                            <div class="btn-group chat-toolbar" role="group" aria-label="...">
                                <button id="chat-leave" class="btn btn-default" type="button">
                                    <i class="fa fa-remove-sign"></i> Leave Chat
                                </button>
                                <button id="chat-invite" class="btn btn-default" type="button">
                                    <i class="fa fa-plus"></i> Invite Agent
                                </button>
                                <button id="chat-customer" class="btn btn-default" type="button">
                                    <i class="fa fa-user"></i> Customer
                                </button>
                            </div>
                            <div class="btn-group chat-toolbar" role="group" aria-label="...">
                                <button id="chat-suggestions" class="btn btn-default" type="button">
                                    <i class="fa fa-book"></i>
                                </button>
                                <button id="chat-attachment" class="btn btn-default" type="button">
                                    <i class="fa fa-paperclip"></i>
                                </button>
                                <button id="chat-tok-video" class="btn btn-default" type="button">
                                    <i class="fa fa-video-camera"></i>
                                </button>
                                <button id="chat-tok-screen" class="btn btn-default" type="button">
                                    <i class="fa fa-circle"></i>
                                </button>
                            </div>
                            <div class="btn-group ticket-toolbar" role="group" aria-label="...">
                                <button type="button" class="btn btn-default ticket-option dropdown-toggle" data-toggle="dropdown">Ticket&nbsp;<span class="caret"></span></button>
                                <ul class="dropdown-menu ticket-menu-actions" role="menu">
                                    <li><a id="Ticket-Create">Create Ticket</a></li>
                                    <li><a id="Ticket-Open">Open Ticket</a></li>
                                    <li><a id="Ticket-Add">Add to Ticket</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="row current-chat-area">
                        <div class="col-md-12">
                            <div class="chat-intro"></div>
                            <ul class="media-list"></ul>
                            <p id="typing" style="display:none; position:fixed; bottom: 50px;">user is typing...</p>
                        </div>
                    </div>
                    <div class="row current-chat-footer">
                        <div class="panel-footer">
                            <div style="text-align: center; display: none;" id="videoRecordingContainer" class="action-new-toolbar">
                                <div id="statusText"></div>
                                <div id="publisher" style="margin:auto; margin-bottom:6px; display:block; height:450px; width:450px;"></div>
                                <button type="button" id="startVideoRecording" class="btn btn-primary" title="Record" onClick="startVideoRecording()"><i class="fa fa-video-camera"></i></button>
                                <button type="button" id="startScreenStreaming" class="btn btn-primary" title="Stream" onClick="startScreenStreaming()"><i class="fa fa-wifi"></i></button>
                                <button type="button" id="stopVideoRecording" class="btn btn-danger" title="Stop" style="display:none;" onClick="stopVideoRecording()"><i class="fa fa-stop"></i></button>
                                <button type="button" id="muteVideoRecording" class="btn btn-primary" title="Mute Audio" onClick="muteVideoRecording()"><i class="fa fa-microphone"></i></button>
                                <button type="button" id="unmuteVideoRecording" class="btn btn-danger" title="Record Audio" style="display:none;" onClick="unmuteVideoRecording()"><i class="fa fa-microphone-slash"></i></button>
                                <button type="button" id="insertVideoRecording" class="btn btn-success" title="Insert Video" style="display:none;" onClick="insertVideoRecording()"><i class="fa fa-cloud-upload"></i></button>
                                <button type="button" id="cancelVideoRecording" title="Cancel" class="btn btn-danger" onClick="cancelVideoRecording()"><i class="fa fa-eject"></i></button>
                            </div>

                            <div style="text-align: center;display: none;" id="screenRecordingContainer" class="action-new-toolbar">
                                <div id="screenRecordDiv">
                                    <div id="screenOne" style="position: absolute !important; z-index: -9999; display:none;"></div>
                                    <div id="screenTwo" style="position: absolute; left: -9999px;"></div>
                                </div>
                                <div id="screenRecordingStatusText"></div>
                                <div id="tokScreenRecordingCountdown">0:00</div>
                                <button type="button" id="startScreenRecording" class="btn btn-primary" title="Record Screen" onClick="startScreenRecording()"><i class="fa fa-video-camera"></i></button>
                                <button type="button" id="startScreenStreaming" class="btn btn-primary" title="Stream Screen" onClick="startScreenStreaming()"><i class="fa fa-wifi"></i></button>
                                <button type="button" id="muteScreenRecording" class="btn btn-primary" title="Mute Audio" onClick="muteScreenRecording()"><i class="fa fa-microphone"></i></button>
                                <button type="button" id="unmuteScreenRecording" class="btn btn-danger" title="Record Audio" style="display:none;" onClick="unmuteScreenRecording()"><i class="fa fa-microphone-slash"></i></button>
                                <button type="button" id="stopScreenRecording" class="btn btn-danger" title="Stop Screen Recording" style="display:none;" onClick="stopScreenRecording()"><i class="fa fa-stop"></i></button>
                                <button type="button" id="insertScreenRecording" class="btn btn-success" title="Insert Screen Recording" style="display:none;" onClick="insertScreenRecording()"><i class="fa fa-cloud-upload"></i></button>
                                <button type="button" id="cancelScreenRecording" title="Cancel Screen Recording" class="btn btn-danger" onClick="cancelScreenRecording()"><i class="fa fa-eject"></i></button>
                            </div>
                            <form id="message-form" action="">
                                <div class="input-group">
                                    <input id="message" type="text" class="form-control" autocomplete="off">
                                    <span class="input-group-btn">
                                        <button id="new-message" class="btn btn-default" type="submit">Send</button>
                                    </span>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="chat-add-user-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Invite User</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-invite-user">Who do you want to invite?</label>
                        <input class="col-md-10 form-control chat-user-list" id="chat-invite-user" placeholder="Enter partial name then select name from list">
                        <!--<select id="ticket-user-who" class="form-control"></select>-->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="add-user-save" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="chat-transfer-user-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Transfer User</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-transfer-user">Who do you want to invite?</label>
                        <input class="col-md-10 form-control chat-user-list" id="chat-transfer-user" placeholder="Enter partial name then select name from list">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="add-user-save" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="chat-add-ticket-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="userModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="userModalTitle">Add to Ticket</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="chat-add-ticket">What ticket do you want to add this chat to?</label>
                        <input class="col-md-10 form-control chat-tickets-list" id="chat-add-ticket" placeholder="Enter ticket number">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button id="ticket-add-save" type="button" class="btn btn-primary">Save</button>
                </div>
            </div>
        </div>
    </div>
    <div id="SuggestedSolutionsModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="SuggestedSolutionModalTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="SuggestedSolutionsModalTitle">Insert Knowledgebase</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="dialog-select-ticket2" title="Select a Ticket">
                            <p>Search a ticket number or description:</p>
                            <input type="text" class="text ui-corner-all ui-widget-content" style="width:50%;" id="dialog-select-ticket2-input" />
                        </div>
                    </div>
                    <p>Or select a suggested solution:</p>
                    <iframe id="SuggestedSolutionsIFrame" class="afterSearch" src="" style="width:100%; height:350px;"></iframe>
                </div>
                <div class="modal-footer" style="margin-top: -16px">
                    <button id="InsertSuggestedSolutionsLink" type="button" class="btn btn-primary afterSearch">Insert Link</button>
                    <button id="InsertSuggestedSolutions" type="button" class="btn btn-primary afterSearch">Insert Article</button>
                    <button type="button" class="btn btn-default afterSearch" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="ChromeInstallModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Extension Required</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <p>An Extension is required in order for Screen Sharing to function properly. Please select your browswer and install the extension. Once the installation is complete close this dialog and click the Record Screen button again.</p>
                        <p id="chromemodalbutton"><button type="button" class="btn btn-primary" onclick="installChromePlugin();" id="install-button">Add to Chrome</button></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="FireFoxInstallModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Extension Required</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <p>An Extension is required in order for Screen Sharing to function properly. Please install the browser extension. Once the installation is complete you will need to refresh your browser for the installation to complete. Please save your ticket action text if any before proceeding.</p>
                        <p id="firefoxmodalbutton"><a href="../../../ScreenShare/ScreenSharing.xpi" class="btn btn-info" role="button">Add to Firefox</a></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="screenStreamModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div style="text-align: center; display: none;" id="screenStreamingContrainer">
                        <div id="screenStream" style="margin:auto; margin-bottom:6px; display:block; height:450px; width:450px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Templates -->
    <script id="message-template" type="text/x-custom-template">
        <li class="media">
            <div class="media-body">
                <div class="media">
                    <img class="pull-{{MessageDirection}} media-object img-circle user-avatar" src="{{Avatar}}">
                    <div class="media-body">
                        {{Message}}
                        <br>
                        <small class="text-muted">{{UserName}} | {{Date}}</small>
                        <hr>
                    </div>
                </div>
            </div>
        </li>
    </script>
    <script id="tok-template" type="text/x-custom-template">
        <li class="media">
            <div class="media-body">
                <div class="media">
                    <!--<img class="pull-{{MessageDirection}} media-object img-circle user-avatar" src="{{Avatar}}">-->
                    <div class="media-body">
                        {{message}} <a onClick="subscribeToStream()">Do you Accept?</a>
                        <br>
                    </div>
                </div>
            </div>
        </li>
    </script>
</body>
</html>